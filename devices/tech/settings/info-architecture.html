<!doctype html>
<html  lang="en">
  
<!-- Mirrored from source.android.google.cn/devices/tech/settings/info-architecture.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Mar 2019 14:14:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
          
<title>Information Architecture &nbsp;|&nbsp; Android Open Source Project</title>

<meta property="og:title" content="Information Architecture &nbsp;|&nbsp; Android Open Source Project">

  <meta property="og:url" content="info-architecture-2.html">

  <meta property="og:locale" content="en">


    
    
    
  
        <meta property="og:site_name" content="Android Open Source Project">
    <meta property="og:type" content="website">
    
          <meta name="theme-color" content="#78c257">
    
    <meta charset="utf-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="../../../_pwa/androidsource/manifest.json">
    <link rel="preconnect" href="http://www.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.googleapis.com/" crossorigin>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons">
    <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/css/app.css">
    <noscript>
      <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/css/ce_bundle.css">
    </noscript>
    <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/favicon.png">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/touchicon-180.png"><link rel="canonical" href="info-architecture-2.html"></head>
  <body type="article"
        theme="androidsource-theme"
        class=""
        
        layout="docs"
        pending>
    <devsite-progress type="indeterminate" id="app-progress"></devsite-progress>
    <div class="devsite-wrapper"><devsite-header ds-is="header" keep-tabs-visible>
      








<div class="devsite-header--inner">
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu"
          class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Navigation menu button"
          visually-hidden
          aria-label="Close menu">
        </button>
        <div class="devsite-product-name-wrapper">
  <a href="../../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.cn/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
            <span class="devsite-product-name">
            <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item">
                              </li>
  </ul>
          </span>
        
</div>        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
                          <devsite-tabs ds-is="tabs" class="upper-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../../setup.html"
   class="gc-analytics-event"
   title="Set up"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Set up"
   >
  Set up
</a>

        </tab>
                        <tab active>
          <a href="../../../compatibility.html"
   class="gc-analytics-event"
   title="Design"
   aria-label="Design, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Design"
   >
  Design
</a>

        </tab>
                        <tab >
          <a href="../../../security.html"
   class="gc-analytics-event"
   title="Secure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Secure"
   >
  Secure
</a>

        </tab>
                        <tab >
          <a href="../../audio.html"
   class="gc-analytics-event"
   title="Develop"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Develop"
   >
  Develop
</a>

        </tab>
                        <tab >
          <a href="../dalvik.html"
   class="gc-analytics-event"
   title="Configure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Configure"
   >
  Configure
</a>

        </tab>
                        <tab >
          <a href="../../../reference.html"
   class="gc-analytics-event"
   title="Reference"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Reference"
   >
  Reference
</a>

        </tab>
            </div>
</devsite-tabs>

                       </div>
          <devsite-search ds-is="search"
            enable-suggestions
                  project-path="">
  <form class="devsite-search-form" action="https://source.android.google.cn/s/results/" method="GET">
    <div class="devsite-search-container">
      <div id="searchbox" class="devsite-searchbox">
                <input placeholder="Search"
          type="text"
          class="devsite-search-field devsite-search-query"
          name="q"
          value=""
          autocomplete="off"
                    aria-label="Search box">
        <div class="devsite-search-image material-icons"></div>
      </div>
      <button type="button"
              search-open
              class="devsite-search-button devsite-header-icon-button button-flat material-icons"
              aria-label="Open search box"></button>
    </div>
  </form>
  <button type="button"
          search-close
          class="devsite-search-button devsite-header-icon-button button-flat material-icons"
          aria-label="Close search box"></button>
</devsite-search>

        </div>

                <a class="devsite-header-link devsite-top-button button gc-analytics-event"
           href="http://android-review.googlesource.com/"
           data-category="Site-Wide Custom Events"
           data-label="Site header link">
          Go to code
        </a>
                      </div>    </div>  </div>
  <div class="devsite-collapsible-section
    ">
    <div class="devsite-header-background">
                        <div class="devsite-product-id-row">
            <div class="devsite-product-description-row">
                              <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item">
                    <a href="../../../compatibility.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Lower Header"
              data-value="1"
          >
            Design
      
  </a>
        </li>
  </ul>
                                        </div>
                                                                                    </div>
                                      <div class="devsite-doc-set-nav-row">
                              <devsite-tabs ds-is="tabs" class="lower-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../../compatibility.html"
   class="gc-analytics-event"
   title="Overview"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Overview"
   >
  Overview
</a>

        </tab>
                        <tab >
          <a href="../../architecture.html"
   class="gc-analytics-event"
   title="Architecture"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Architecture"
   >
  Architecture
</a>

        </tab>
                        <tab >
          <a href="../../../compatibility/overview-2.html"
   class="gc-analytics-event"
   title="Compatibility"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Compatibility"
   >
  Compatibility
</a>

        </tab>
                        <tab >
          <a href="../display.html"
   class="gc-analytics-event"
   title="Display"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Display"
   >
  Display
</a>

        </tab>
                        <tab active>
          <a href="settings-guidelines.html"
   class="gc-analytics-event"
   title="Settings"
   aria-label="Settings, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Settings"
   >
  Settings
</a>

        </tab>
                        <tab >
          <a href="../../../compatibility/tests.html"
   class="gc-analytics-event"
   title="Tests"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Tests"
   >
  Tests
</a>

        </tab>
            </div>
</devsite-tabs>

        </div>
          </div>  </div></div>
  

  </devsite-header>      <devsite-book-nav ds-is="book-nav" scrollbars >
                  

<nav class="devsite-book-nav devsite-nav nocontent">
  <div class="devsite-mobile-header">
    <button type="button"
            id="devsite-close-nav"
            class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
            data-category="Site-Wide Custom Events"
            data-label="Close navigation"
            aria-label="Close navigation">
    </button>
  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
              <ul class="devsite-nav-list">
                      <li class="devsite-nav-item">
                                <a href="../../../setup.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Set up">
      <span class="devsite-nav-text" >Set up</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../../compatibility.html"
          class="devsite-nav-title gc-analytics-event
            devsite-nav-active"
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Design">
      <span class="devsite-nav-text" >Design</span>
        </a>
  
                                            <ul class="devsite-nav-responsive-tabs">
                                                                                                                      <li class="devsite-nav-item">
    <a href="../../../compatibility.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Overview">
      <span class="devsite-nav-text" >Overview</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../../architecture.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Architecture">
      <span class="devsite-nav-text" >Architecture</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../../../compatibility/overview-2.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Compatibility">
      <span class="devsite-nav-text" >Compatibility</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../display.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Display">
      <span class="devsite-nav-text" >Display</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="settings-guidelines.html"
     id="devsite-nav-forward"     class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Settings">
      <span class="devsite-nav-text" menu="_book">Settings</span>
        <span class="devsite-nav-icon material-icons" data-icon="forward"
          menu="_book">
    </span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../../../compatibility/tests.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Tests">
      <span class="devsite-nav-text" >Tests</span>
        </a>
  </li>

                                  </ul>
                          </li>
                      <li class="devsite-nav-item">
                                <a href="../../../security.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Secure">
      <span class="devsite-nav-text" >Secure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../audio.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Develop">
      <span class="devsite-nav-text" >Develop</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../dalvik.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Configure">
      <span class="devsite-nav-text" >Configure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../../reference.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Reference">
      <span class="devsite-nav-text" >Reference</span>
        </a>
  
                                        </li>
                                <li class="devsite-nav-item">
    <a href="http://android-review.googlesource.com/"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Go to code">
      <span class="devsite-nav-text" >Go to code</span>
        </a>
  </li>

                  </ul>
          </div>
          <div class="devsite-mobile-nav-bottom">
                                      <ul class="devsite-nav-list" menu="_book">
                                    <li class="devsite-nav-item"><a href="settings-guidelines.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Design Guidelines">Design Guidelines</span></a></li>
                          <li class="devsite-nav-item"><a href="patterns-components-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Patterns and Components">Patterns and Components</span></a></li>
                          <li class="devsite-nav-item"><a href="info-architecture-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Information Architecture">Information Architecture</span></a></li>
                          <li class="devsite-nav-item"><a href="personalized-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Personalized Settings">Personalized Settings</span></a></li>
                          <li class="devsite-nav-item"><a href="universal-search-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Universal Search">Universal Search</span></a></li>
                      </ul>
                                                                                                                                                                            </div>
      </div>
</nav>
              </devsite-book-nav>
      <div id="gc-wrapper">
        <div class="devsite-main-content"
            has-book-nav            has-toc>
          <devsite-toc ds-is="toc" class="devsite-nav"
            ></devsite-toc>
          <devsite-content ds-is="content">
                          

<article class="devsite-article">
  <article class="devsite-article-inner">    
    <div class="devsite-article-meta">
      <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item">
                    <a href="../../../index.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="1"
          >
            AOSP
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item">
                <div class="devsite-breadcrumb-guillemet material-icons"></div>
                    <a href="../../../compatibility.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="2"
          >
            Design
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item">
                <div class="devsite-breadcrumb-guillemet material-icons"></div>
                    <a href="settings-guidelines.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="3"
          >
            Settings
      
  </a>
        </li>
  </ul>
               <devsite-page-rating position="header" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
          </div>

              <h1 class="devsite-page-title">Information Architecture</h1>
    
    <devsite-toc ds-is="toc" class="devsite-nav" devsite-toc-embedded
                 ></devsite-toc>

    <div class="devsite-article-body clearfix
      ">

              
  



























  <!--
      Copyright 2017 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->

<p>
Android 8.0 introduced a new information architecture for the Settings app to
simplify the way settings are organized and make it easier for users to
quickly find settings to customize their Android devices.

Android 9 introduced some improvements to provide more
Settings functionality and easier implementation.
</p>

<h2 id="examples-and-source">Examples and source</h2>

<p>
Most pages in Settings are currently implemented using the new framework. A good
example is DisplaySettings:
<code>packages/apps/Settings/src/com/android/settings/DisplaySettings.java</code>
</p>

<p>
Files paths for important components are listed below:
</p>

<ul>
<li><strong>CategoryKey</strong>:
<code>packages/SettingsLib/src/com/android/settingslib/drawer/CategoryKey.java</code></li>
<li><strong>DashboardFragmentRegistry</strong>:
<code>packages/apps/Settings/src/com/android/settings/dashboard/DashboardFragmentRegistry.java</code></li>
<li><strong>DashboardFragment</strong>:
<code>packages/apps/Settings/src/com/android/settings/dashboard/DashboardFragment.java</code></li>
<li><strong>AbstractPreferenceController</strong>:
<code>frameworks/base/packages/SettingsLib/src/com/android/settingslib/core/AbstractPreferenceController.java
</code></li>
<li><strong>BasePreferenceController</strong> (introduced in Android 9):
<code>packages/apps/Settings/src/com/android/settings/core/BasePreferenceController.java</code></li>
</ul>

<h2 id="implementation">Implementation</h2>

<p>
Device manufacturers are encouraged to adapt the existing Settings information
architecture and insert additional settings pages as needed to accommodate
partner-specific features. Moving preferences from legacy page (implemented as
<code>SettingsPreferencePage</code>) to a new page (implemented using
<code>DashboardFragment</code>) can be complicated. The preference from the
legacy page is likely not implemented with a <code>PreferenceController</code>.
</p>

<p>
So when moving a preferences from a legacy page to a new page, you need to create a
<code>PreferenceController</code> and move the code into the controller before
instantiating it in the new <code>DashboardFragment</code>. The APIs that
<code>PreferenceController</code> requires are described in their name and
documented in Javadoc.
</p>

<p>
It is highly recommended to add a unit test for each <code>PreferenceController</code>.
If the change is submitted to AOSP, then a unit test is required.
To get more information about how to write Robolectric based tests, see the
readme file <code>packages/apps/Settings/tests/robotests/README.md</code>.
</p>

<h3 id="plugin">Plugin-style information architecture</h3>

<p>
Each settings item is implemented as a Preference. A Preference can easily be
moved from one page to another.
</p>

<p>
To make it easier for multiple settings to be moved around, Android 8.0 introduced
a plugin-style host fragment that contains settings items. Settings items are
modeled as plugin-style controllers. Hence, a settings page is constructed by a
single host fragment and multiple setting controllers.
</p>

<h3 id="dashboard-fragment">DashboardFragment</h3>

<p>
<code>DashboardFragment</code> is the host of plugin-style preference controllers.
The fragment inherits from <code>PreferenceFragment</code> and has hooks to
expand and update both static preference lists and dynamic preference lists.
</p>

<h3 id="static-preferences">Static preferences</h3>

<p>
A static preference list is defined in XML using the <code>&lt;Preference&gt;</code> tag. A
<code>DashboardFragment</code> implementation uses the
<code>getPreferenceScreenResId()</code> method to define which XML file contains
the static list of preferences to display.
</p>

<h3 id="dynamic-preferences">Dynamic preferences</h3>

<p>
A dynamic item represents a tile with intent, leading to an external or internal
Activity. Usually, the intent leads to a different setting page. For example,
the "Google" setting item in the Settings homepage is a dynamic item. Dynamic
items are defined in <code>AndroidManifest</code> (discussed below) and loaded
through a <code>FeatureProvider</code> (defined as <code>
DashboardFeatureProvider</code>).
</p>

<p>
Dynamic settings are more heavyweight than statically configured
settings, so normally developers should implement the setting as a static one.
However the dynamic setting can be useful when any of the following is true:
</p>

<ul>
<li>The setting is not directly implemented in the Settings app (such as
injecting a setting implemented by OEM/Carrier apps).</li>
<li>The setting should appear on the Settings homepage.</li>
<li>You already have an Activity for the setting and do not want to implement the
extra static config.</li>
</ul>

<p>
To configure an Activity as a dynamic setting, do the following:
</p>

<ul>
<li>Mark the activity as a dynamic setting by adding an intent-filter to the
activity.</li>
<li>Tell the Settings app which category it belongs to. The category is a constant,
defined in <code>CategoryKey</code>.</li>
<li>Optional: Add summary text when the setting is displayed.</li>
</ul>

<p>
Here is an example taken from Settings app for <code>DisplaySettings</code>.
</p>

<pre
class="prettyprint">
&lt;activity android:name="Settings$DisplaySettingsActivity"
                   android:label="@string/display_settings"
                   android:icon="@drawable/ic_settings_display"&gt;
             &lt;!-- Mark the activity as a dynamic setting --&gt;
              &lt;intent-filter&gt;
                     &lt;action android:name="com.android.settings.action.IA_SETTINGS" /&gt;
              &lt;/intent-filter&gt;
             &lt;!-- Tell Settings app which category it belongs to --&gt;
              &lt;meta-data android:name="com.android.settings.category"
                     android:value="com.android.settings.category.ia.homepage" /&gt;
             &lt;!-- Add a summary text when the setting is displayed --&gt;
              &lt;meta-data android:name="com.android.settings.summary"
                     android:resource="@string/display_dashboard_summary"/&gt;
             &lt;/activity&gt;
</pre>

<p>
At render time, the fragment will ask for a list of Preferences from both static
XML and dynamic settings defined in <code>AndroidManifest</code>. Whether the
<code>PreferenceController</code>s are defined in Java code or in XML,
<code>DashboardFragment</code> manages the handling logic of each setting
through <code>PreferenceController</code> (discussed below). Then they are
displayed in the UI as a mixed list.
</p>

<h3 id="preference-controller">PreferenceController</h3>

<p>There are differences between implementing <code>PreferenceController</code>
in Android 9 and Android 8.x, as described in this
section.</p>

<h4>PreferenceController in Android 9 release</h4>

<p>A <code>PreferenceController</code> contains all logic to interact with the
preference, including displaying, updating, search indexing, etc.</p>

<p>The interface of <code>PreferenceController</code> is defined as
<code>BasePreferenceController</code>. For example, see code in
<code>packages/apps/Settings/src/com/android/settings/core/
BasePreferenceController.java</code></p>

<p>There are several subclasses of <code>BasePreferenceController</code>, each
mapping to a specific UI style that the Settings app supports by default. For
example, <code>TogglePreferenceController</code> has an API that directly maps
to how the user should interact with a toggle-based preference UI.</p>

<p><code>BasePreferenceController</code> has APIs like
<code>getAvailabilityStatus()</code>, <code>displayPreference()</code>,
<code>handlePreferenceTreeClicked(),</code> etc. Detailed documentation for each
API is in the interface class.</p>

<p>A restriction on implementing <code>BasePreferenceController</code> (and
its subclasses such as <code>TogglePreferenceController</code>) is that the
constructor signature must match either of the following:</p>

<ul>
<li><code>public MyController(Context context, String key) {}</code></li>
<li><code>public MyController(Context context) {}</code></li>
</ul>

<p>While installing a preference to the fragment, dashboard provides a method to
attach a <code>PreferenceController</code> before display time. At install time,
the controller is wired up to the fragment so all future relevant events are
sent to the controller.</p>

<code>DashboardFragment</code> keeps a list of
<code>PreferenceController</code>s in the screen. At the fragment's
<code>onCreate()</code>, all controllers are invoked for the
<code>getAvailabilityStatus()</code> method, and if it returns true,
<code>displayPreference()</code> is invoked to process display logic.
<code>getAvailabilityStatus()</code> is also important to tell the Settings
framework which items are available during search.</p>

<h4>PreferenceController in Android 8.x releases</h4>

<p>
A <code>PreferenceController</code> contains all logic to interact with the
preference, including displaying, updating, search indexing. etc.
</p>

<p>
Corresponding to the preference interactions, the interface of <code>
PreferenceController</code> has APIs <code>isAvailable()</code>, <code>
displayPreference()</code>, <code>handlePreferenceTreeClicked()</code> etc.
Detailed documentation on each API can be found in the interface class.
</p>

<p>
While installing a preference to the fragment, dashboard provides a method to
attach a <code>PreferenceController</code> before display time. At install time,
the controller is wired up to the fragment so all future relevant events are
sent to the controller.
</p>

<p>
<code>DashboardFragment</code> keeps a list of <code>PreferenceControllers
</code> in the screen. At the fragment's <code>onCreate()</code>, all
controllers are invoked for the <code>isAvailable()</code> method, and if it
returns true, <code>displayPreference()</code> is invoked to process display
logic.
</p>

<h2 id="using-dashboardfragment">Using DashboardFragment</h2>

<h3 id="moving-preference">Moving a preference from page A to B</h3>

<p>
If the preference is statically listed in the original page's preference XML
file, follow the <strong>Static</strong> move procedure for your Android
release below. Otherwise, follow the <strong>Dynamic</strong> move procedure
for your Android release.
</p>

<h4 id="static-move-p">Static move in Android 9</h4>

<ol>
<li>Find the preference XML files for the original page and destination
page. You can find this information from the page's
<code>getPreferenceScreenResId()</code> method.</li>
<li>Remove the preference from the original page's XML.</li>
<li>Add the preference to the destination page's XML.</li>
<li>Remove the <code>PreferenceController</code> for this preference from the
original page's Java implementation. Usually it is in
<code>createPreferenceControllers()</code>. The controller might be declared in
XML directly.
<p><strong>Note</strong>: The preference might not have a
<code>PreferenceController</code>.</p></li>
<li>Instantiate the <code>PreferenceController</code> in the destination page's
<code>createPreferenceControllers()</code>. If the
<code>PreferenceController</code> is defined in XML in the old page, define it
in XML for the new page also.</li>
</ol>

<h4 id="dynamic-move">Dynamic move in Android 9</h4>

<ol>
<li>Find which category the original and destination page hosts. You can
find this information in <code>DashboardFragmentRegistry</code>.</li>
<li>Open the <code>AndroidManifest.xml</code> file that contains the setting you
need to move and find the Activity entry representing this setting.</li>
<li>Set the activity's metadata value for
<code>com.android.settings.category</code> to the new page's category key.</li>
</ol>

<h4 id="static-move-8">Static move in Android 8.x releases</h4>

<ol>
<li>Find the preference XML files for the original page and destination page.</li>
You can find this information from the page's <code>getPreferenceScreenResId()
</code> method.</li>
<li>Remove the preference in the original page's XML.</li>
<li>Add the preference to destination page's XML.</li>
<li>Remove the <code>PreferenceController</code> for this preference in the
original page's Java implementation. Usually it's in
<code>getPreferenceControllers()</code>.</li>
<p><strong>Note</strong>: It is possible the preference does not have a
<code>PreferenceController</code>.</p></li>
<li>Instantiate the <code>PreferenceController</code> in the destination page's
<code>getPreferenceControllers()</code>.</li>
</ol>

<h4 id="dynamic-move">Dynamic move in Android 8.x releases</h4>

<ol>
<li>Find which category the original and destination page hosts. You can find
this information in <code>DashboardFragmentRegistry</code>.</li>
<li>Open the <code>AndroidManifest.xml</code> file that contains the setting you
need to move and find the Activity entry representing this setting.</li>
<li>Change the activity's metadata value for <code>com.android.settings.category</code>,
set the value point to the new page's category key.</li>
</ol>

<h3 id="creating-a-new-preference">Creating a new preference in a page</h3>

<p>
If the preference is statically listed in the original page's preference XML
file, follow the <strong>static</strong> procedure below. Otherwise follow the
<strong>dynamic</strong> procedure.
</p>

<h4 id="static-create">Creating a static preference</h4>

<ol>
<li>Find the preference XML files for the page. You can find this information
from the page's getPreferenceScreenResId() method.</li>
<li>Add a new Preference item in the XML. Make sure it has a unique <code>android:key</code>.</li>
<li>
Define a <code>PreferenceController</code> for this preference in the page's
<code>getPreferenceControllers()</code> method.
<ul>
<li>In Android 8.x and optionally in Android 9,
instantiate a <code>PreferenceController</code> for this preference in the
page’s <code>createPreferenceControllers()</code> method.

<p>If this preference already existed in other places, it’s possible there is
already a <code>PreferenceController</code> for it. You can reuse the
<code>PreferenceController</code> without building a new one.</p>
</li>
<li>
Starting in Android 9, you can choose to declare the
<code>PreferenceController</code> in XML next to the preference. For example:
<pre class="prettyprint">
&lt;Preference
        android:key="reset_dashboard"
        android:title="@string/reset_dashboard_title"
        <b>settings:controller="com.android.settings.system.ResetPreferenceController"/&gt;</b>
</pre>
</li>
</ul>
</li>
</ol>

<h4 id="dynamic-create">Creating a dynamic preference</h4>

<ol>
<li>Find which category the original and destination page hosts. You can find
this information in <code>DashboardFragmentRegistry</code>.</li>
<li>Create a new Activity in <code>AndroidManifest</code></li>
<li>Add necessary metadata to the new Activity to define the setting. Set the
metadata value for <code>com.android.settings.category</code> to the same value
defined in step 1.</li>
</ol>

<h3 id="create-new-page">Create a new page</h3>
<ol>
<li>Create a new fragment, inheriting from <code>DashboardFragment</code>.</li>
<li>Define its category in <code>DashboardFragmentRegistry</code>.
<p class="note"><strong>Note:</strong> This step is optional. If you do not need
any dynamic preferences in this page, you don't need to provide a category key.</p></li>
<li>Follow the steps for adding the settings needed for this page. For more
information, see the <a href="#implementation">Implementation</a> section.</li>
</ol>

<h2 id="validation">Validation</h2>

<ul>
<li>Run the robolectric tests in Settings. All existing and new tests should
pass.
<li>Build and install Settings, then manually open the page being modified.
The page should update immediately.</li>
</ul>

          </div>

    
                   <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
                   
          </article>
</article>

<devsite-content-footer ds-is="content-footer" class="nocontent">
  <p>Content and code samples on this page are subject to the licenses described in the <a href="../../../license.html">Content License</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
</devsite-content-footer>


                      </devsite-content>
        </div>
        <devsite-footer-promos ds-is="footer-promos" class="devsite-footer">
                      
                  </devsite-footer-promos>
        <devsite-footer-linkboxes ds-is="footer-linkboxes" class="devsite-footer">
                      <nav class="devsite-footer-linkboxes nocontent">
  <ul class="devsite-footer-linkboxes-list">
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Build</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.googlesource.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android repository
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../../setup/build/requirements.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Requirements
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../../setup/build/downloading.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Downloading
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/blobs-preview/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Preview binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/images/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Factory images
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/drivers/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Driver binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.github.io/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            GitHub
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Connect</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/Android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            @Android on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/AndroidDev/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            @AndroidDev on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://blog.google/products/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Android Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://security.googleblog.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Google Security Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-platform/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Platform on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-building/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Building on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-porting/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Porting on Google Groups
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Get help</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/pixelphone/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Pixel Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/nexus/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Nexus Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            www.android.com
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/gms/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Google Mobile Services
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://stackoverflow.com/questions/tagged/android-source/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Stack Overflow
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://issuetracker.google.com/issues?q=status:open%20componentid:190923"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Issue Tracker
          </a>
        </li>
              </ul>
    </li>
      </ul>
</nav>
                  </devsite-footer-linkboxes>
        <devsite-footer-utility ds-is="footer-utility" class="devsite-footer">
                      <div class="devsite-footer-utility">
  
  <nav class="devsite-nav">
        <ul class="devsite-footer-utility-list">
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../../source/index.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer About Android link">
          About Android
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../../setup/community.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Community link">
          Community
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../../legal.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Legal link">
          Legal
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../../license.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer License link">
          License
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://policies.google.cn/privacy"
           data-category="Site-Wide Custom Events"
           data-label="Footer Privacy link">
          Privacy
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://issuetracker.google.com/issues/new?component=191476"
           data-category="Site-Wide Custom Events"
           data-label="Footer Site feedback link">
          Site feedback
        </a>
              </li>
          </ul>
    
        <form class="devsite-footer-utility-language">
      <select class="devsite-footer-utility-language-select"
              name="language"
              track-name="click"
              track-type="languageSelector">
                  <option value="en"
                  track-metadata-original-language="en"
                  track-metadata-selected-language="en"
                  track-name="changed"
                  track-type="languageSelector"
                  selected="selected">
            English
          </option>
                  <option value="zh_cn"
                  track-metadata-original-language="en"
                  track-metadata-selected-language="zh_cn"
                  track-name="changed"
                  track-type="languageSelector"
                  >
            简体中文
          </option>
              </select>
    </form>
      </nav>
</div>
                  </devsite-footer-utility>
      </div></div>
    <devsite-sitemask ds-is="site-mask"></devsite-sitemask>
    <devsite-snackbar ds-is="snackbar"                       ></devsite-snackbar>    <devsite-tooltip ds-is="tooltip"
                     blocked-link></devsite-tooltip>
    <devsite-analytics ds-is="analytics">
              <script type="application/json" analytics>[{"metrics": {"ratings_value": "metric1", "ratings_count": "metric2"}, "dimensions": {}, "gaid": "UA-45455297-4"}]</script>
<script type="application/json" gtm>[]</script>
          </devsite-analytics>
    <script>
    (function(d,e,v,E,l,o,p,r,s,_,__){d['GoogleDevelopersObject']=[!0,l,o,p,r,s];
    _=e.createElement(v);_.async=1;_.src=E;__=e.getElementsByTagName(v)[0];
    __.parentNode.insertBefore(_,__);})(window, document, 'script',
      'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/js/app_loader.js',
      'en',
      'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/js/devsite_app.js',
      'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource',
      !1,
      ['/_pwa/androidsource/manifest.json',
       'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/images/video-placeholder.svg',
       'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/favicon.png','https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/lockup.svg','https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons'],
       'https://androidsource-dot-google-developers.gonglchuangl.net/')
   </script>  </body>

<!-- Mirrored from source.android.google.cn/devices/tech/settings/info-architecture.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Mar 2019 14:14:51 GMT -->
</html>