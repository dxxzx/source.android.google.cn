<!doctype html>
<html  lang="en">
  
<!-- Mirrored from source.android.google.cn/devices/automotive/power by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Mar 2019 14:30:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
          
<title>Power Management &nbsp;|&nbsp; Android Open Source Project</title>

<meta property="og:title" content="Power Management &nbsp;|&nbsp; Android Open Source Project">

  <meta property="og:url" content="power.html">

  <meta property="og:locale" content="en">


    
    
    
  
        <meta property="og:site_name" content="Android Open Source Project">
    <meta property="og:type" content="website">
    
          <meta name="theme-color" content="#78c257">
    
    <meta charset="utf-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="../../_pwa/androidsource/manifest.json">
    <link rel="preconnect" href="http://www.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.googleapis.com/" crossorigin>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons">
    <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/css/app.css">
    <noscript>
      <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/css/ce_bundle.css">
    </noscript>
    <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/favicon.png">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/touchicon-180.png"><link rel="canonical" href="power.html"></head>
  <body type="article"
        theme="androidsource-theme"
        class=""
        
        layout="docs"
        pending>
    <devsite-progress type="indeterminate" id="app-progress"></devsite-progress>
    <div class="devsite-wrapper"><devsite-header ds-is="header" keep-tabs-visible>
      








<div class="devsite-header--inner">
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu"
          class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Navigation menu button"
          visually-hidden
          aria-label="Close menu">
        </button>
        <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.cn/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
            <span class="devsite-product-name">
            <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item">
                              </li>
  </ul>
          </span>
        
</div>        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
                          <devsite-tabs ds-is="tabs" class="upper-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../setup.html"
   class="gc-analytics-event"
   title="Set up"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Set up"
   >
  Set up
</a>

        </tab>
                        <tab >
          <a href="../../compatibility.html"
   class="gc-analytics-event"
   title="Design"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Design"
   >
  Design
</a>

        </tab>
                        <tab >
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Secure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Secure"
   >
  Secure
</a>

        </tab>
                        <tab active>
          <a href="../audio.html"
   class="gc-analytics-event"
   title="Develop"
   aria-label="Develop, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Develop"
   >
  Develop
</a>

        </tab>
                        <tab >
          <a href="../tech/dalvik.html"
   class="gc-analytics-event"
   title="Configure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Configure"
   >
  Configure
</a>

        </tab>
                        <tab >
          <a href="../../reference.html"
   class="gc-analytics-event"
   title="Reference"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Reference"
   >
  Reference
</a>

        </tab>
            </div>
</devsite-tabs>

                       </div>
          <devsite-search ds-is="search"
            enable-suggestions
                  project-path="">
  <form class="devsite-search-form" action="https://source.android.google.cn/s/results/" method="GET">
    <div class="devsite-search-container">
      <div id="searchbox" class="devsite-searchbox">
                <input placeholder="Search"
          type="text"
          class="devsite-search-field devsite-search-query"
          name="q"
          value=""
          autocomplete="off"
                    aria-label="Search box">
        <div class="devsite-search-image material-icons"></div>
      </div>
      <button type="button"
              search-open
              class="devsite-search-button devsite-header-icon-button button-flat material-icons"
              aria-label="Open search box"></button>
    </div>
  </form>
  <button type="button"
          search-close
          class="devsite-search-button devsite-header-icon-button button-flat material-icons"
          aria-label="Close search box"></button>
</devsite-search>

        </div>

                <a class="devsite-header-link devsite-top-button button gc-analytics-event"
           href="http://android-review.googlesource.com/"
           data-category="Site-Wide Custom Events"
           data-label="Site header link">
          Go to code
        </a>
                      </div>    </div>  </div>
  <div class="devsite-collapsible-section
    ">
    <div class="devsite-header-background">
                        <div class="devsite-product-id-row">
            <div class="devsite-product-description-row">
                              <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item">
                    <a href="../audio.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Lower Header"
              data-value="1"
          >
            Develop
      
  </a>
        </li>
  </ul>
                                        </div>
                                                                                    </div>
                                      <div class="devsite-doc-set-nav-row">
                              <devsite-tabs ds-is="tabs" class="lower-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../audio.html"
   class="gc-analytics-event"
   title="Audio"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Audio"
   >
  Audio
</a>

        </tab>
                        <tab >
          <a href="../camera.html"
   class="gc-analytics-event"
   title="Camera"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Camera"
   >
  Camera
</a>

        </tab>
                        <tab >
          <a href="../tech/connect.html"
   class="gc-analytics-event"
   title="Connectivity"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Connectivity"
   >
  Connectivity
</a>

        </tab>
                        <tab >
          <a href="../graphics.html"
   class="gc-analytics-event"
   title="Graphics"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Graphics"
   >
  Graphics
</a>

        </tab>
                        <tab active>
          <a href="../input.html"
   class="gc-analytics-event"
   title="Interaction"
   aria-label="Interaction, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Interaction"
   >
  Interaction
</a>

        </tab>
                        <tab >
          <a href="../media.html"
   class="gc-analytics-event"
   title="Media"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Media"
   >
  Media
</a>

        </tab>
                        <tab >
          <a href="../storage.html"
   class="gc-analytics-event"
   title="Storage"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Storage"
   >
  Storage
</a>

        </tab>
            </div>
</devsite-tabs>

        </div>
          </div>  </div></div>
  

  </devsite-header>      <devsite-book-nav ds-is="book-nav" scrollbars >
                  

<nav class="devsite-book-nav devsite-nav nocontent">
  <div class="devsite-mobile-header">
    <button type="button"
            id="devsite-close-nav"
            class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
            data-category="Site-Wide Custom Events"
            data-label="Close navigation"
            aria-label="Close navigation">
    </button>
  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
              <ul class="devsite-nav-list">
                      <li class="devsite-nav-item">
                                <a href="../../setup.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Set up">
      <span class="devsite-nav-text" >Set up</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../compatibility.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Design">
      <span class="devsite-nav-text" >Design</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Secure">
      <span class="devsite-nav-text" >Secure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../audio.html"
          class="devsite-nav-title gc-analytics-event
            devsite-nav-active"
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Develop">
      <span class="devsite-nav-text" >Develop</span>
        </a>
  
                                            <ul class="devsite-nav-responsive-tabs">
                                                                                                                      <li class="devsite-nav-item">
    <a href="../audio.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Audio">
      <span class="devsite-nav-text" >Audio</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../camera.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Camera">
      <span class="devsite-nav-text" >Camera</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../tech/connect.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Connectivity">
      <span class="devsite-nav-text" >Connectivity</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../graphics.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Graphics">
      <span class="devsite-nav-text" >Graphics</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../input.html"
     id="devsite-nav-forward"     class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Interaction">
      <span class="devsite-nav-text" menu="_book">Interaction</span>
        <span class="devsite-nav-icon material-icons" data-icon="forward"
          menu="_book">
    </span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../media.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Media">
      <span class="devsite-nav-text" >Media</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../storage.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Storage">
      <span class="devsite-nav-text" >Storage</span>
        </a>
  </li>

                                  </ul>
                          </li>
                      <li class="devsite-nav-item">
                                <a href="../tech/dalvik.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Configure">
      <span class="devsite-nav-text" >Configure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../reference.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Reference">
      <span class="devsite-nav-text" >Reference</span>
        </a>
  
                                        </li>
                                <li class="devsite-nav-item">
    <a href="http://android-review.googlesource.com/"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Go to code">
      <span class="devsite-nav-text" >Go to code</span>
        </a>
  </li>

                  </ul>
          </div>
          <div class="devsite-mobile-nav-bottom">
                                      <ul class="devsite-nav-list" menu="_book">
                                    <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Input">Input</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../input.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../input/key-layout-files.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Key Layout Files">Key Layout Files</span></a></li><li class="devsite-nav-item"><a href="../input/key-character-map-files.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Key Character Map Files">Key Character Map Files</span></a></li><li class="devsite-nav-item"><a href="../input/input-device-configuration-files.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Input Device Configuration Files">Input Device Configuration Files</span></a></li><li class="devsite-nav-item"><a href="../input/migration-guide.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Migration Guide">Migration Guide</span></a></li><li class="devsite-nav-item"><a href="../input/keyboard-devices.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Keyboard Devices">Keyboard Devices</span></a></li><li class="devsite-nav-item"><a href="../input/touch-devices.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Touch Devices">Touch Devices</span></a></li><li class="devsite-nav-item"><a href="../input/getevent.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Getevent">Getevent</span></a></li><li class="devsite-nav-item"><a href="../input/validate-keymaps.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Validate Keymaps">Validate Keymaps</span></a></li></ul></devsite-expandable-nav></li>
                          <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Automotive">Automotive</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../automotive.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Audio">Audio</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="audio.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="audio/audio-hal.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Audio HAL">Audio HAL</span></a></li><li class="devsite-nav-item"><a href="audio/audio-control.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="AudioControl HAL">AudioControl HAL</span></a></li><li class="devsite-nav-item"><a href="audio/interaction-sequences.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Interaction Sequences">Interaction Sequences</span></a></li><li class="devsite-nav-item"><a href="audio/multi-zone.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Multi-Zone">Multi-Zone</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item"><a href="camera-hal-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Camera HAL">Camera HAL</span></a></li><li class="devsite-nav-item"><a href="ivi_connectivity-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="IVI Connectivity">IVI Connectivity</span></a></li><li class="devsite-nav-item"><a href="properties.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Vehicle Properties">Vehicle Properties</span></a></li><li class="devsite-nav-item"><a href="power.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Power Management">Power Management</span></a></li><li class="devsite-nav-item"><a href="../tech/perf/flash-wear-2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Flash Wear Management">Flash Wear Management</span></a></li></ul></devsite-expandable-nav></li>
                          <li class="devsite-nav-item"><a href="../interaction/neural-networks.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Neural Networks">Neural Networks</span></a></li>
                          <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Peripherals">Peripherals</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../accessories.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Audio Accessories">Audio Accessories</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../accessories/audio.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="3.5 mm Headset">3.5 mm Headset</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../accessories/headset/plug-headset-spec.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Headset Spec">Headset Spec</span></a></li><li class="devsite-nav-item"><a href="../accessories/headset/jack-headset-spec.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Device Spec">Device Spec</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="USB Headset">USB Headset</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../accessories/headset/usb-headset-spec.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Headset Spec">Headset Spec</span></a></li><li class="devsite-nav-item"><a href="../accessories/headset/usb-adapter.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Adapter Spec">Adapter Spec</span></a></li><li class="devsite-nav-item"><a href="../accessories/headset/usb-device.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Device Spec">Device Spec</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item"><a href="../accessories/headset/expected-behavior.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Expected Behavior">Expected Behavior</span></a></li><li class="devsite-nav-item"><a href="../accessories/headset/testing.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Testing">Testing</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Custom Accessories">Custom Accessories</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../accessories/custom.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="AOA">AOA</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../accessories/protocol.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../accessories/aoa2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="AOA 2.0">AOA 2.0</span></a></li><li class="devsite-nav-item"><a href="../accessories/aoa.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="AOA 1.0">AOA 1.0</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item"><a href="../accessories/stylus.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Stylus">Stylus</span></a></li></ul></devsite-expandable-nav></li></ul></devsite-expandable-nav></li>
                          <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Sensors">Sensors</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../sensors.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../sensors/sensor-stack.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Sensor Stack">Sensor Stack</span></a></li><li class="devsite-nav-item"><a href="../sensors/report-modes.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Reporting Modes">Reporting Modes</span></a></li><li class="devsite-nav-item"><a href="../sensors/suspend-mode.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Suspend Mode">Suspend Mode</span></a></li><li class="devsite-nav-item"><a href="../sensors/power-use.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Power Consumption">Power Consumption</span></a></li><li class="devsite-nav-item"><a href="../sensors/interaction.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Interaction">Interaction</span></a></li><li class="devsite-nav-item"><a href="../sensors/hal-interface.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="HAL Interface">HAL Interface</span></a></li><li class="devsite-nav-item"><a href="../sensors/batching.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Batching">Batching</span></a></li><li class="devsite-nav-item"><a href="../sensors/sensor-types.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Sensor Types">Sensor Types</span></a></li><li class="devsite-nav-item"><a href="../sensors/versioning.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Version Deprecation">Version Deprecation</span></a></li></ul></devsite-expandable-nav></li>
                          <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav ds-is="expandable-nav" collapsed>
    <a class="devsite-nav-toggle"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="TV">TV</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../tv.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../tv/hdmi-cec.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="HDMI-CEC Control Service">HDMI-CEC Control Service</span></a></li><li class="devsite-nav-item"><a href="../tv/reference-tv-app.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Reference TV App">Reference TV App</span></a></li><li class="devsite-nav-item"><a href="../tv/customize-tv-app.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Customize the TV App">Customize the TV App</span></a></li></ul></devsite-expandable-nav></li>
                      </ul>
                                                                                                                                                                            </div>
      </div>
</nav>
              </devsite-book-nav>
      <div id="gc-wrapper">
        <div class="devsite-main-content"
            has-book-nav            has-toc>
          <devsite-toc ds-is="toc" class="devsite-nav"
            ></devsite-toc>
          <devsite-content ds-is="content">
                          

<article class="devsite-article">
  <article class="devsite-article-inner">    
    <div class="devsite-article-meta">
      <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item">
                    <a href="../../index.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="1"
          >
            AOSP
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item">
                <div class="devsite-breadcrumb-guillemet material-icons"></div>
                    <a href="../audio.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="2"
          >
            Develop
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item">
                <div class="devsite-breadcrumb-guillemet material-icons"></div>
                    <a href="../input.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="3"
          >
            Interaction
      
  </a>
        </li>
  </ul>
               <devsite-page-rating position="header" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
          </div>

              <h1 class="devsite-page-title">Power Management</h1>
    
    <devsite-toc ds-is="toc" class="devsite-nav" devsite-toc-embedded
                 ></devsite-toc>

    <div class="devsite-article-body clearfix
      ">

              
  <!--
      Copyright 2017 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->

<p>Android introduces a new state into the power management state machine, called
<em>deep sleep</em>. To implement deep sleep, Android provides a
<code>CarPowerManagementService</code> service and a <code>CarPowerManager</code> interface.</p>

<p>State transitions are triggered by the Vehicle Master Control Unit (VMCU). To communicate with
the VMCU, Integrators must implement several components. Integrators are responsible for integrating
with the Vehicle Hardware Abstraction Layer (VHAL) and the kernel implementation. Integrators are
also responsible for disabling wake sources and ensuring that shutdowns are not postponed
indefinitely.</p>

<h2 id="terms">Terminology</h2>

<p>These terms are used throughout this document:</p>

<table>
<thead>
<tr>
<th>Term</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Processor (AP)</td>
<td>Part of the System on a Chip (SoC).</td>
</tr>
<tr>
<td>Board Support Processor (BSP)</td>
<td>All of the chip and hardware specific code necessary for the product to work. Typically provided
by the SoC vendor and hardware manufacturer. This covers items such as device drivers, the PMIC sequencing code, and SoC bringup.</td>
</tr>
<tr>
<td>CarPowerManager (CPM)</td>
<td>Exposes an API for applications to register for power state changes.</td>
</tr>
<tr>
<td>CarPowerManagementService&nbsp;(CPMS)</td>
<td>Implements the car power state machine, interfaces with VHAL, and performs the final calls to <code>suspend()</code> and <code>shutdown()</code>.</td>
</tr>
<tr>
<td>CarServiceHelperService (CSHS)</td>
<td>Provides a hook into SystemServer for OK, provided that is the Car Service.</td>
</tr>
<tr>
<td>General Purpose Input/Output (GPIO)</td>
<td>A digital signal pin for general purpose use.</td>
</tr>
<tr>
<td>Hibernate</td>
<td>Also referred to as <em>Suspend to Disk</em> (S2D/S4). The SoC is placed into S4 power mode
(hibernate) and RAM content is written to non-volatile media (such as flash or disk) and the entire
system is powered off. Android does <em>not</em> currently implement hibernate.</td>
</tr>
<tr>
<td>Media Processor (MP)</td>
<td>See System on a Chip (SoC).</td>
</tr>
<tr>
<td>Power&nbsp;Management&nbsp;Integrated&nbsp;Circuit&nbsp;(PMIC)</td>
<td>Chip used to manage power requirements for the host system.</td>
</tr>
<tr>
<td>System on a Chip (SoC)</td>
<td>Main processor that runs Android, typically supplied by manufacturers such as Intel, MediaTek,
Nvidia, Qualcomm, Renesas, and Texas Instruments.</td>
</tr>
<tr>
<td>Suspend</td>
<td>Also referred to as <em>Suspend to RAM</em> (S2R or STR). The SoC is placed into S3 power mode
and the CPU is powered off while RAM remains powered on.</td>
</tr>
<tr>
<td>Vehicle HAL (VHAL)</td>
<td>The Android API used to interface with the vehicle network. The Tier 1 partner or OEM is
responsible for writing this module. The vehicle network can use any physical layer (such as CAN,
LIN, MOST, and Ethernet). The VHAL abstracts this vehicle network to enable Android to interact with
the vehicle.</td>
</tr>
<tr>
<td>Vehicle Interface Processor (VIP)</td>
<td>See Vehicle MCU.</td>
</tr>
<tr>
<td>Vehicle Master Control Unit (VMCU)</td>
<td>The microcontroller that provides the interface between the vehicle network and the SoC. The SoC
communicates with the VMCU via USB, UART, SPI, and GPIO signals. </td>
</tr>
</tbody>
</table>

<h2 id="design">System design</h2>

<p>This section describes how Android represents the application processor's power state and which
modules implement the power management system. This material also describes how these modules work
together and how state transitions typically occur.</p>

<h3 id="state">Car power state machine</h3>

<p>Android uses a <em>state machine</em> to represent the power state of the AP. The state
machine provides the states illustrated below:

<p><img src="images/automotive_power_states.png" alt="Car power state machine"></p>

<p><b>Figure 1.</b> Car power state machine</p>

<p>The initial state of this state machine is OFF. This state can transition into two states,
ON: DISP OFF and ON: FULL. Both states indicate that the AP is on. The difference lies in the
display's power state. ON: DISP OFF means that the AP is running and displays are turned off.
When the display turns on, the ON: DISP OFF state transitions into ON: FULL (and vice versa).</p>

<p>The AP is turned off in two cases. In both cases, the state machine first changes state to
SHUTDOWN PREPARE and then transitions to OFF or DEEP SLEEP:</p>

<ul>
<li>Power off</li>
<li>Suspended to RAM</li>
</ul>

<p>When the power management state machine enters the DEEP SLEEP state, the AP runs Suspend to
RAM. For example, the AP suspends its state (such as register stored value) in RAM. When the AP
wakes up, all states are restored.</p>

<h3 id="module">Power management modules</h3>

<p>The power management system is comprised of these modules:</p>

<table>
<thead>
<tr>
<th><strong>Module name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>CarPowerManager</td>
<td>Java/C++ API.</td>
</tr>
<tr>
<td>CarPowerManagementService</td>
<td>Coordinates the Sleep/Suspend power state.</td>
</tr>
<tr>
<td>Vehicle HAL</td>
<td>Interface to the VMCU.</td>
</tr>
<tr>
  <td>libsuspend</td>
<td>Native library to place the device into suspend.</td>
</tr>
<tr>
<td>Kernel</td>
<td>Suspend to RAM implementation.</td>
</tr>
</tbody>
</table>

<p>The deep sleep feature (suspending Android to RAM) is implemented in the kernel. This feature is
exposed to the user space as a special file located at <code>/sys/power/state</code>. Android
Auto is suspended by writing <code>mem</code> to this file.</p>

<p><code>libsuspend</code> is a native library that implements <code>forcesuspend()</code>. This
function uses <code>/sys/power/state</code> to suspend Android Auto.
<code>forcesuspend()</code> can be called from system services, including CPMS.</p>


<p>The CPMS coordinates the power state with other services and HALs. The CPMS implements the state
machine described above and sends notifications to every observer when a power state transition
occurs. This service also uses <code>libsuspend</code> and the VHAL to send messages to the
hardware. </p>

<p>Some properties are defined in the VHAL. To communicate with the VMCU, the CPMS reads and writes
these properties. Applications can use the interface defined in the CPM to monitor power state
changes. This interface also enables applications to acquire the boot reason and to send shutdown
requests. This API can be called from Java and C++ and is annotated with @hide / @System API, which
means it is available to privileged applications <em>only</em>. The relationship between these five
modules, applications, and services is illustrated below:</p>

<p><img src="images/automotive_power_reference_diagram.png" alt="Power components reference diagram"></p>

<p><b>Figure 2.</b> Power components reference diagram</p>

<h3 id="message">Message sequence</h3>

<p>The previous section described the modules that comprise the power management system. This
section uses the <em>enter deep sleep</em> and <em>exit deep sleep</em> examples to explain how the
modules and applications communicate:</p>

<h4>Enter deep sleep</h4>

<p>Only the VMCU can initiate deep sleep. Once deep sleep is initiated, the VMCU sends a
notification to the CPMS via the VHAL. The CPMS changes the state to SHUTDOWN PREPARE and
broadcasts this state transition to all observers (the applications and services that monitor
CPMS) by calling the <code>onStateChanged()</code> method with a new state ID provided by the
CPM.</p>

<p>The CPM mediates between the applications/services and the CPMS. The
<code>onStateChanged()</code> method for the applications/services is synchronously invoked in the
CPM's <code>onStateChanged()</code> method. After which, the finished method of the CPMS is invoked
to notify the CPMS that the target application or service is ready to suspend. The CPM's
<code>onStateChanged()</code> method runs asynchronously. Therefore, some delay occurs between the
calling of the <code>onStateChanged()</code> method to all CPM objects and the receiving of the
finished message from all these objects. During this time, the CPMS continues to send shutdown
postpone requests to the VHAL.</p>

<p>Once the CPMS receives the finished message from all CPM objects, the CPMS sends
<code>AP_POWER_STATE_REPORT</code> to the VHAL, which then notifies the VMCU that the AP is ready to
suspend. The CPMS also calls its suspend method, which suspends the kernel with a feature provided
by <code>libsuspend</code>.</p>

<p>The sequence described above is illustrated below:

<p><img src="images/automotive_power_deep_sleep.png" alt="Enter deep sleep"></p>

<p><b>Figure 3.</b> Enter deep sleep</p>

<h4>Exit deep sleep</h4>

<p>The sequence to exit suspend is also initiated by the VMCU. The VMCU turns on the AP and the AP
restores the suspended Android from RAM. The CPMS uses <code>onStateChanged</code>method to send a
<code>SUSPEND_EXIT</code> message to applications and services when it wakes up. </p>

To access the reason, applications and services can call the <code>getBootReason()</code> method
provided by the CPM. This method returns these values, as notified from the VMCU to the VHAL:</p>

<ul>
<li>BOOT_REASON_USER_POWER_ON</li>
<li>BOOT_REASON_DOOR_UNLOCK</li>
<li>BOOT_REASON_TIMER</li>
<li>BOOT_REASON_DOOR_OPEN</li>
<li>BOOT_REASON_REMOTE_START</li>
</ul>

<p><img src="images/automotive_power_deep_sleep_exit.png" alt="Exit deep sleep"></p>

<p><b>Figure 4.</b> Exit deep sleep</p>

<h2 id="cpm">Programming interfaces provided by CPM</h2>

<p>This section describes the Java and C++ API provided by the CPM for system applications and
services. The process to call the CPM in C++ is identical to that used by the Java API. This API
enables the system software to:</p>

<ul>
<li>Monitor power state changes in the AP.</li>
<li>Acquire boot reasons from the CPMS.</li>
<li>Request the VMCU to shut down the AP on the next suspend instruction.</li>
</ul>

<p><code>PowerTestFragment.java</code> in <code>com.google.android.car.kitchensink.power</code>
illustrates how to use these APIs in Java. Use these steps to call the APIs provided by the CPM:</p>

<ol>
<li>To acquire the CPM instance, call the Car API.</li>
<li>Call the appropriate method on the object created in Step 1.</li>
</ol>

<h3 id="object">Creating a CarPowerManager object</h3>

  <p>To create a CPM object, call the Car object's <code>getCarManager()</code> method. This method is
a facade used to create CM objects. Specify <code>android.car.Car.POWER_SERVICE</code> as an
argument to create a CPM object.</p>

<div>
<pre class="prettyprint">
Car car = Car.createCar(this, carCallbacks);
car.connect();
CarPowerManager powerManager =
  (CarPowerManager)car.getCarManager(android.car.Car.POWER_SERVICE);
</pre>
</div>

<h2 id="reg">CarPowerStateListener and registration</h2>

<p>System applications and services can receive power state change notifications by implementing
<code>CarPowerManager.CarPowerStateListener</code>. This interface defines one method
<code>onStateChanged()</code>, which is a callback function invoked when the power state of CPMS
is changed. The following example defines a new anonymous class that implements the interface:</p>

<div>
<pre class="prettyprint">
private final CarPowerManager.CarPowerStateListener listener =
  new CarPowerManager.CarPowerStateListener () {
    @Override
     public void onStateChanged(int state) {
       Log.i(TAG, "onStateChanged() state = " + state);
     }
};
</pre>
</div>

<p>To instruct this listener object to monitor a power state transition, create a new execution
thread and register the listener and this thread to the PM object: </p>

<div>
<pre class="prettyprint">
executer = new ThreadPerTaskExecuter();
powerManager.setListener(powerListener, executer);
</pre>
</div>

<p>When the power state is changed, the <code>onStateChanged()</code> method of the listener object
is invoked with a value to represent the new power state. The association between actual value and
power state is defined in <code>CarPowerManager.CarPowerStateListener</code> and is shown in the
following table:</p>

<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>SHUTDOWN_CANCELED</td>
<td>Shutdown is canceled and power state is returned to the normal state.</td>
</tr>
<tr>
<td>SHUTDOWN_ENTER</td>
<td>Enter the shutdown state. Applications are expected to clean up and be ready to shutdown.</td>
</tr>
<tr>
<td>SUSPEND_ENTER</td>
<td>Enter the suspend state. Applications are expected to clean up and be ready to suspend.</td>
</tr>
<tr>
<td>SUSPEND_EXIT</td>
<td>Wake up from suspend or resume from a cancelled suspend.</td>
</tr>
</tbody>
</table>

<h3 id="dereg">CarPowerStateListener unregistration</h3>

<p>To unregister all listener objects registered to CPM, call the <code>clearListener</code> method:</p>

<p><pre class="prettyprint">
powerManager.clearListener();
</pre>
</div>

<h3 id="boot">Boot reason acquisition</h3>

<p>To acquire the boot reason, call the <code>getBootReason</code> method, which communicates with
the CPMS and returns one of the following five boot reasons:</p>

<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOT_REASON_USER_POWER_ON</td>
<td>A user presses the power key or rotates the ignition switch to boot the device.</td>
</tr>
<tr>
<td>BOOT_REASON_DOOR_UNLOCK</td>
<td>Door unlocks, which causes the device to boot.</td>
</tr>
<tr>
<td>BOOT_REASON_TIMER</td>
<td>Timer expires and vehicle wakes up the AP.</td>
</tr>
<tr>
<td>BOOT_REASON_DOOR_OPEN</td>
<td>Door opens, which causes the device to boot.</td>
</tr>
<tr>
<td>BOOT_REASON_REMOTE_START</td>
<td>User activates remote start.</td>
</tr>
</tbody>
</table>

<p>These boot reasons are defined in the CPM. The following sample code demonstrates boot reason
acquisition:</p>

<div>
<pre class="prettyprint">
try{
  int bootReason = carPowerManager.getBootReason();
  if (bootReason == CarPowerManager.BOOT_REASON_TIMER){
    doSomething;
  }else{
    doSomethingElse();
  }
}catch(CarNotConnectedException e){
   Log.e("Failed to getBootReason()" + e);
}
</pre>
</div>

<p>This method throws a <code>CarNotConnectedException</code> when it fails to communicate with the
CPMS.</p>

<h3 id="shutdown">Shutdown request on next suspend</h3>

<p>The <code>requestShutdownOnNextSuspend()</code>method instructs CPMS to shut down instead of deep
sleep at the next opportunity.</p>

<h2 id="integration">System integration on your Android implementation</h2>

<p>Integrators are responsible for implementing the following items:</p>

<ul>
<li>Kernel interface to suspend Android.</li>
<li>The VHAL to:<ul type="circle">
<li>Propagate the initiation of suspend or shutdown from the car to Android.</li>
<li>Send the shutdown ready message from Android to the car.</li>
<li>Initiate shutdown or suspend of Android via the Linux kernel interface.</li>
<li>Propagate the wake reason from the car to Android upon resume from suspend.</li>
</ul>
<li>Wakesources to be disabled when the device is in suspend.</li>
<li>Applications to shut down quickly enough so as not to indefinitely postpone the shutdown
process.</li>
</ul>

<h3 id="kernel">Kernel interface: /sys/power/state</h3>

<p>First, implement the Linux suspend power state. Android places a device into suspend mode when
an application or service writes <code>mem</code> into a file located at
<code>/sys/power/state.</code> This function may include the sending of a GPIO to the VMCU to notify
the VMCU that the device has shut down completely. The Integrator is also responsible for removing
any race conditions between VHAL sending the final message to the VMCU and the system going into
suspend or shutdown mode.</p>

<h3 id="vhal">VHAL responsibility</h3>

<p>The VHAL provides an interface between the vehicle network and Android. The VHAL:</p>

<ul>
<li>Propagates the initiation of suspend or shutdown from the car to Android.</li>
<li>Sends the shutdown ready message from Android to the car.</li>
<li>Initiates the shutdown or suspend of Android via the Linux kernel interface.</li>
<li>Propagates the wake reason from the car to Android upon resume from suspend.</li>
</ul>

<p>When the CPMS informs the VHAL that it is ready to shut down, the VHAL sends the shutdown ready
message to the VMCU. Typically, on-chip peripherals such as UART, SPI, and USB transmit the
message. Once the message has been sent, the VHAL calls the kernel command to suspend or shutdown
the device. Before doing so, in the case of a shutdown, the VHAL or BSP may toggle a GPIO to
instruct the VMCU that it is safe to remove power from the device.</p>

<p>The VHAL must support the following properties, which control power management via the VHAL:</p>

<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>AP_POWER_STATE_REPORT</td>
<td>Android reports state transitions to the VMCU with this property, using VehicleApPowerStateSet enum values.</td>
</tr>
<tr>
<td>AP_POWER_STATE_REQ</td>
<td>The VMCU uses this property to instruct Android to transition to different power states, using VehicleApPowerStateReq enum values.</td>
</tr>
<tr>
<td>AP_POWER_BOOTUP_REASON</td>
<td>The VMCU reports the wake reason to Android, using the VehicleApPowerBootupReason enum values.</td>
</tr>
</tbody>
</table>

<h4>AP_POWER_STATE_REPORT</h4>

<p>Use this property to report Android's current power management state. This property contains two
integers:</p>

<ul>
<li><code>int32Values[0]</code>: VehicleApPowerStateReport enum of the current state.</li>
<li><code>int32Values[1]</code>: Time in milliseconds to postpone or sleep/shutdown. This value
depends on the first value.</li>
</ul>

<p>The first value can take one of the following values. <code>Types.hal</code> contains more
specific descriptions, which are stored in the
<code>hardware/interfaces/automotive/vehicle/2.0.</code></p>

<table>
<thead>
<tr>
<th><strong>Value name</strong></th>
<th><strong>Description</strong></th>
<th><strong>Second&nbsp;value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOT_COMPLETE</td>
<td>AP has completed boot up and can start shutdown.</td>
<td></td>
</tr>
<tr>
<td>DEEP_SLEEP_ENTRY</td>
<td>AP is entering the deep sleep state.</td>
<td>Must be set</td>
</tr>
<tr>
<td>DEEP_SLEEP_EXIT</td>
<td>AP is exiting the deep sleep state.</td>
<td></td>
</tr>
<tr>
<td>SHUTDOWN_POSTPONE</td>
<td>Android is requesting to postpone shutdown .</td>
<td>Must be set</td>
</tr>
<tr>
<td>SHUTDOWN_START</td>
<td>AP is starting shutdown. The VMCU can turn on AP after the time specified in the second
value.</td>
<td>Must be set</td>
</tr>
<tr>
<td>DISPLAY_OFF</td>
<td>User has requested to turn off the display of the head unit.</td>
<td></td>
</tr>
<tr>
<td>DISPLAY_ON</td>
<td>User has requested to turn on the display of the head unit.</td>
<td></td>
</tr>
</tbody>
</table>

<p>The state can be set asynchronously (in the case of <code>BOOT_COMPLETE</code>) or in response to
a request via the VMCU. When the state is set to <code>SHUTDOWN_START</code>,
<code>DEEP_SLEEP_ENTRY,</code> or <code>SHUTDOWN_POSTPONE</code>, an integer (in milliseconds)
is sent to notify the VMCU for how long the AP must postpone shutdown or sleep.</p>

<h4>AP_POWER_STATE_REQ</h4>

<p>This property is sent by the VMCU to transition Android into a different power state and contains
two integers:</p>

<ul>
<li><code>int32Values[0]</code>: <code>VehicleApPowerStateReq</code> enum value, which represents
the new state into which to transition.</li>
<li><code>int32Values[1]</code>: <code>VehicleApPowerStateShutdownParam</code> enum value. This
value is sent only for a <code>SHUTDOWN_PREPARE</code> message and transmits to Android the
options it contains.</li>
</ul>

<p>The first integer value represents the new state into which Android is to transit. The semantics
are defined in <code>types.hal</code> and provided below:</p>

<table>
<thead>
<tr>
<th><strong>Value name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>OFF</td>
<td>AP is turned off.</td>
</tr>
<tr>
<td>DEEP_SLEEP</td>
<td>AP is in deep sleep.</td>
</tr>
<tr>
<td>ON_DISP_OFF</td>
<td>AP is on, but display is off.</td>
</tr>
<tr>
<td>N_FULL</td>
<td>AP and display are on.</td>
</tr>
<tr>
<td>SHUTDOWN_START</td>
<td>AP is starting shutdown. The VMCU can turn on the AP after the time specified in the second
value.</td>
</tr>
<tr>
<td>SHUTDOWN_PREPARE</td>
<td>The VMCU has requested the AP to shut down. The AP can either enter sleep state or start a full
shutdown.</td>
</tr>
</tbody>
</table>

<p><code>VehicleApPowerStateShutdownParam</code> is also defined in <code>types.hal</code>. This
enum has three elements, as described below:</p>

<table>
<thead>
<tr>
<th><strong>Value name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>SHUTDOWN_IMMEDIATELY</td>
<td>The AP must shut down immediately. Postpone is not allowed.</td>
</tr>
<tr>
<td>CAN_SLEEP</td>
<td>The AP can enter deep sleep instead of shutting down completely.</td>
</tr>
<tr>
<td>SHUTDOWN_ONLY</td>
<td>The AP can only shut down when postponing is allowed.</td>
</tr>
</tbody>
</table>

<h4>AP_POWER_BOOTUP_REASON</h4>

<p>This property is set by the VMCU whenever Android is booted up or resumed from suspend. This
property instructs Android which event triggered the wakeup. This value must remain static until
Android is rebooted or completes a suspend/wake cycle. This property can take a
<code>VehicleApPowerBootupReason</code> value, which is defined in <code>types.hal</code> as
follows:</p>

<table>
<thead>
<tr>
<th><strong>Value name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>USER_POWER_ON</td>
<td>Power on because the user pressed the power key or rotated the ignition switch.</td>
</tr>
<tr>
<td>USER_UNLOCK</td>
<td>Automatic power on triggered by a user unlocking a door (or any other type of automatic user
detection).</td>
</tr>
<tr>
<td>TIMER</td>
<td>Automatic power on triggered by a timer. This occurs only when the AP has requested wakeup after
a specific duration, as specified in <code>VehicleApPowerSetState</code>#SHUTDOWN_START.</td>
</tr>
</tbody>
</table>

<h3 id="wake">Wake sources</h3>

<p>Use Integrator to disable the appropriate wake sources when the device is in suspend mode.
Common wake sources include heartbeats, modem, wifi, and Bluetooth. The only valid wake source must
be an interrupt from the VMCU to wake up the SoC. This assumes that the VMCU can listen to the modem
for remote wakeup events (such as remote engine start). If this functionality is pushed to the AP,
then another wake source to service the modem must be added. In the current design, the Integrator
supplies a file with a list of wake sources to be turned off. The CPMS iterates through this file
and manages the turning off and on of the wake sources at suspend time.</p>

<h3 id="apps">Applications</h3>

<p>OEMs must be careful to write applications so that they can be shut down quickly and not postpone
the process indefinitely. </p>

<h2 id="app">Appendix</h2>

<h3 id="tree">Directories in the source code tree</h3>

<table>
<thead>
<tr>
<th><strong>Content</strong></th>
<th><strong>Directory</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>CarPowerManager-related code.</td>
<td><code>packages/services/Car/car-lib/src/android/car/hardware/power</code></td>
</tr>
<tr>
<td>CarPowerManagementService and so on.</td>
<td><code>packages/services/Car/service/src/com/android/car</code></td>
</tr>
<tr>
<td>Services dealing with the VHAL, such as <code>VehicleHal</code> and <code>HAlClient</code>.</td>
<td><code>packages/services/Car/service/src/com/android/car/hal</code></td>
</tr>
<tr>
<td>VHAL interface and property definitions.</td>
<td><code>hardware/interfaces/automotive/vehicle/2.0</code></td>
</tr>
<tr>
<td>Sample app to provide some idea about the <code>CarPowerManager</code></td>
<td><code>packages/services/Car/tests/EmbeddedKitchenSinkApp/src/com/google/android/car/kitchensink</code></td>
</tr>
<tr>
<td><code>libsuspend</code> resides in this directory.</td>
<td><code>system/core/libsuspend</code></td>
</tr>
</tbody>
</table>

<h3 id="diagram">Class diagram</h3>

<p>This class diagram displays the Java classes and interfaces in the power management system:</p>

<p><img src="images/automotive_power_class_diagram.png" alt="Power class diagram"></p>

<p><b>Figure 5.</b> Power class diagram</p>

<h3 id="rel">Object relationship</h3>

<p>The following graph illustrates which objects have references to other objects. An edge
means that the source object holds a reference to the target object. For example, VehicleHAL has a
reference to a PropertyHalService object.</p>

<p><img src="images/automotive_power_object_state.png" alt="Object reference diagram"></p>

<p><b>Figure 6.</b> Object reference diagram</p>


          </div>

    
                   <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
                   
          </article>
</article>

<devsite-content-footer ds-is="content-footer" class="nocontent">
  <p>Content and code samples on this page are subject to the licenses described in the <a href="../../license.html">Content License</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
</devsite-content-footer>


                      </devsite-content>
        </div>
        <devsite-footer-promos ds-is="footer-promos" class="devsite-footer">
                      
                  </devsite-footer-promos>
        <devsite-footer-linkboxes ds-is="footer-linkboxes" class="devsite-footer">
                      <nav class="devsite-footer-linkboxes nocontent">
  <ul class="devsite-footer-linkboxes-list">
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Build</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.googlesource.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android repository
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/requirements.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Requirements
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/downloading.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Downloading
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/blobs-preview/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Preview binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/images/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Factory images
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/drivers/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Driver binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.github.io/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            GitHub
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Connect</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/Android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            @Android on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/AndroidDev/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            @AndroidDev on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://blog.google/products/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Android Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://security.googleblog.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Google Security Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-platform/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Platform on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-building/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Building on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-porting/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Porting on Google Groups
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Get help</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/pixelphone/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Pixel Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/nexus/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Nexus Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            www.android.com
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/gms/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Google Mobile Services
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://stackoverflow.com/questions/tagged/android-source/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Stack Overflow
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://issuetracker.google.com/issues?q=status:open%20componentid:190923"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Issue Tracker
          </a>
        </li>
              </ul>
    </li>
      </ul>
</nav>
                  </devsite-footer-linkboxes>
        <devsite-footer-utility ds-is="footer-utility" class="devsite-footer">
                      <div class="devsite-footer-utility">
  
  <nav class="devsite-nav">
        <ul class="devsite-footer-utility-list">
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../source/index.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer About Android link">
          About Android
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../setup/community.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Community link">
          Community
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../legal.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Legal link">
          Legal
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../license.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer License link">
          License
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://policies.google.cn/privacy"
           data-category="Site-Wide Custom Events"
           data-label="Footer Privacy link">
          Privacy
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://issuetracker.google.com/issues/new?component=191476"
           data-category="Site-Wide Custom Events"
           data-label="Footer Site feedback link">
          Site feedback
        </a>
              </li>
          </ul>
    
        <form class="devsite-footer-utility-language">
      <select class="devsite-footer-utility-language-select"
              name="language"
              track-name="click"
              track-type="languageSelector">
                  <option value="en"
                  track-metadata-original-language="en"
                  track-metadata-selected-language="en"
                  track-name="changed"
                  track-type="languageSelector"
                  selected="selected">
            English
          </option>
                  <option value="zh_cn"
                  track-metadata-original-language="en"
                  track-metadata-selected-language="zh_cn"
                  track-name="changed"
                  track-type="languageSelector"
                  >
            
          </option>
              </select>
    </form>
      </nav>
</div>
                  </devsite-footer-utility>
      </div></div>
    <devsite-sitemask ds-is="site-mask"></devsite-sitemask>
    <devsite-snackbar ds-is="snackbar"                       ></devsite-snackbar>    <devsite-tooltip ds-is="tooltip"
                     blocked-link></devsite-tooltip>
    <devsite-analytics ds-is="analytics">
              <script type="application/json" analytics>[{"metrics": {"ratings_value": "metric1", "ratings_count": "metric2"}, "dimensions": {}, "gaid": "UA-45455297-4"}]</script>
<script type="application/json" gtm>[]</script>
          </devsite-analytics>
    <script>
    (function(d,e,v,E,l,o,p,r,s,_,__){d['GoogleDevelopersObject']=[!0,l,o,p,r,s];
    _=e.createElement(v);_.async=1;_.src=E;__=e.getElementsByTagName(v)[0];
    __.parentNode.insertBefore(_,__);})(window, document, 'script',
      'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/js/app_loader.js',
      'en',
      'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/js/devsite_app.js',
      'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource',
      !1,
      ['/_pwa/androidsource/manifest.json',
       'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/images/video-placeholder.svg',
       'https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/favicon.png','https://www.gstatic.com/devrel-devsite/v804714fbf31610f6bd494c83c2b0ed270c7475db2947bab1f550f430dad1ed36/androidsource/images/lockup.svg','https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons'],
       'https://androidsource-dot-google-developers.gonglchuangl.net/')
   </script>  </body>

<!-- Mirrored from source.android.google.cn/devices/automotive/power by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Mar 2019 14:30:24 GMT -->
</html>