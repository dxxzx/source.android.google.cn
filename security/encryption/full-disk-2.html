<!doctype html>
<html       lang="en"      dir="ltr">
  
<!-- Mirrored from source.android.google.cn/security/encryption/full-disk.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Sep 2019 15:19:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta property="og:site_name" content="Android Open Source Project">
    <meta property="og:type" content="website">
    
          <meta name="theme-color" content="#78c257">
    
    <meta charset="utf-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="../../_pwa/androidsource/manifest.json"
          crossorigin="use-credentials">
    <link rel="preconnect" href="http://www.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.googleapis.com/" crossorigin>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons">
        <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/css/rebrand-app.css">
    <noscript>
      <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/css/ce_bundle.css">
    </noscript>
    <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/favicon.png">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/touchicon-180.png"><link rel="canonical" href="full-disk.html">      
<title>Full-Disk Encryption &nbsp;|&nbsp; Android Open Source Project</title>

<meta property="og:title" content="Full-Disk Encryption &nbsp;|&nbsp; Android Open Source Project">


  <meta property="og:url" content="full-disk.html">

  <meta property="og:locale" content="en">




    
    
    
  
    </head>
  <body type="article"
        theme="androidsource-theme"
        class=""
        
        layout="docs"
        block-apix        pending>
    <devsite-progress type="indeterminate" id="app-progress"></devsite-progress>
    <div class="devsite-wrapper"><devsite-header keep-tabs-visible>
      









<div class="devsite-header--inner">
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu"
          class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Navigation menu button"
          visually-hidden
          aria-label="Close menu">
        </button>
        <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.cn/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
            <span class="devsite-product-name">
            <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                              </li>
  </ul>
          </span>
        
</div>        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
                          <devsite-tabs class="upper-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../setup.html"
   class="gc-analytics-event"
   title="Set up"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Set up"
   >
  Set up
</a>

        </tab>
                        <tab >
          <a href="../../compatibility.html"
   class="gc-analytics-event"
   title="Design"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Design"
   >
  Design
</a>

        </tab>
                        <tab active>
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Secure"
   aria-label="Secure, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Secure"
   >
  Secure
</a>

        </tab>
                        <tab >
          <a href="../../devices.html"
   class="gc-analytics-event"
   title="Develop"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Develop"
   >
  Develop
</a>

        </tab>
                        <tab >
          <a href="../../devices/tech.html"
   class="gc-analytics-event"
   title="Configure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Configure"
   >
  Configure
</a>

        </tab>
                        <tab >
          <a href="../../reference.html"
   class="gc-analytics-event"
   title="Reference"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Reference"
   >
  Reference
</a>

        </tab>
            </div>
</devsite-tabs>

                       </div>
          <devsite-search
            enable-suggestions
              family-name="Android Open Source Project"    tenant-name="Android Open Source Project"            >
  <form class="devsite-search-form" action="https://source.android.google.cn/s/results" method="GET">
    <div class="devsite-search-container">
      <div class="devsite-searchbox">
                <input placeholder="Search"
          type="text"
          class="devsite-search-field devsite-search-query"
          name="q"
          value=""
          autocomplete="off"
                    aria-label="Search box">
        <div class="devsite-search-image material-icons" aria-hidden="true"></div>
      </div>
      <button type="button"
              search-open
              class="devsite-search-button devsite-header-icon-button button-flat material-icons"
              aria-label="Open search box"></button>
    </div>
  </form>
  <button type="button"
          search-close
          class="devsite-search-button devsite-header-icon-button button-flat material-icons"
          aria-label="Close search box"></button>
</devsite-search>

        </div>

        <devsite-language-selector>
  <devsite-select class="devsite-language-selector-menu">
    <select class="devsite-language-selector-select"
            name="language"
            track-name="click"
            track-type="languageSelector">
                <option>Language</option>
              <option value="en"
              track-metadata-original-language="en"
              track-metadata-selected-language="en"
              track-name="changed"
              track-type="languageSelector"
            >
        English
      </option>
          <option value="zh_cn"
              track-metadata-original-language="en"
              track-metadata-selected-language="zh_cn"
              track-name="changed"
              track-type="languageSelector"
            >
        中文 – 简体
      </option>
        </select>
  </devsite-select>
</devsite-language-selector>


                  <a class="devsite-header-link devsite-top-button button gc-analytics-event"
   href="http://android-review.googlesource.com/"
   data-category="Site-Wide Custom Events"
   data-label="Site header link">
  Go to code
</a>
        
              </div>    </div>  </div>
  <div class="devsite-collapsible-section
    ">
    <div class="devsite-header-background">
                        <div class="devsite-product-id-row">
            <div class="devsite-product-description-row">
                              <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                    <a href="../../security.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Lower Header"
              data-value="1"
          >
            Secure
      
  </a>
        </li>
  </ul>
                                        </div>
                                                                                    </div>
                                      <div class="devsite-doc-set-nav-row">
                              <devsite-tabs class="lower-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Overview"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Overview"
   >
  Overview
</a>

        </tab>
                        <tab >
          <a href="../bulletin.html"
   class="gc-analytics-event"
   title="Bulletins"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Bulletins"
   >
  Bulletins
</a>

        </tab>
                        <tab active>
          <a href="../features.html"
   class="gc-analytics-event"
   title="Features"
   aria-label="Features, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Features"
   >
  Features
</a>

        </tab>
                        <tab >
          <a href="../../devices/tech/debug/fuzz-sanitize.html"
   class="gc-analytics-event"
   title="Testing"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Testing"
   >
  Testing
</a>

        </tab>
                        <tab >
          <a href="../best-practices.html"
   class="gc-analytics-event"
   title="Best Practices"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Best Practices"
   >
  Best Practices
</a>

        </tab>
            </div>
</devsite-tabs>

        </div>
          </div>  </div></div>
  

  </devsite-header>      <devsite-book-nav scrollbars >
                  




<nav class="devsite-book-nav devsite-nav nocontent">
  <div class="devsite-mobile-header">
    <button type="button"
            id="devsite-close-nav"
            class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
            data-category="Site-Wide Custom Events"
            data-label="Close navigation"
            aria-label="Close navigation">
    </button>
    <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
        <span class="devsite-product-name">
        <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                              </li>
  </ul>
      </span>
    
</div>  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
              <ul class="devsite-nav-list">
                      <li class="devsite-nav-item">
                                <a href="../../setup.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Set up">
      <span class="devsite-nav-text" >Set up</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../compatibility.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Design">
      <span class="devsite-nav-text" >Design</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            devsite-nav-active"
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Secure">
      <span class="devsite-nav-text" >Secure</span>
        </a>
  
                                            <ul class="devsite-nav-responsive-tabs">
                                                                                                                      <li class="devsite-nav-item">
    <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Overview">
      <span class="devsite-nav-text" >Overview</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../bulletin.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Bulletins">
      <span class="devsite-nav-text" >Bulletins</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../features.html"
     id="devsite-nav-forward"     class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Features">
      <span class="devsite-nav-text" menu="_book">Features</span>
        <span class="devsite-nav-icon material-icons" data-icon="forward" aria-hidden="true"
          menu="_book">
    </span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../../devices/tech/debug/fuzz-sanitize.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Testing">
      <span class="devsite-nav-text" >Testing</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../best-practices.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Best Practices">
      <span class="devsite-nav-text" >Best Practices</span>
        </a>
  </li>

                                  </ul>
                          </li>
                      <li class="devsite-nav-item">
                                <a href="../../devices.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Develop">
      <span class="devsite-nav-text" >Develop</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../devices/tech.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Configure">
      <span class="devsite-nav-text" >Configure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../reference.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Reference">
      <span class="devsite-nav-text" >Reference</span>
        </a>
  
                                        </li>
                                <li class="devsite-nav-item">
    <a href="http://android-review.googlesource.com/"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Go to code">
      <span class="devsite-nav-text" >Go to code</span>
        </a>
  </li>

                  </ul>
          </div>
          <div class="devsite-mobile-nav-bottom">
                            <ul class="devsite-nav-list" menu="_book">
            <li class="devsite-nav-item"><a href="../features.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li>
  <li class="devsite-nav-item"><a href="../app-sandbox.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Application Sandbox">Application Sandbox</span></a></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Application Signing">Application Signing</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../apksigning.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../apksigning/v2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="APK Signature Scheme v2">APK Signature Scheme v2</span></a></li><li class="devsite-nav-item"><a href="../apksigning/v3.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="APK Signature Scheme v3">APK Signature Scheme v3</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Authentication">Authentication</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../authentication.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../authentication/gatekeeper.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Gatekeeper">Gatekeeper</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Biometrics">Biometrics</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../biometric.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../biometric/measure.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Measuring Biometric Security">Measuring Biometric Security</span></a></li><li class="devsite-nav-item"><a href="../authentication/fingerprint-hal.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Fingerprint HIDL">Fingerprint HIDL</span></a></li><li class="devsite-nav-item"><a href="../biometric/face-authentication.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Face Authentication HIDL">Face Authentication HIDL</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Protected Confirmation">Protected Confirmation</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../protected-confirmation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/implementation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementation">Implementation</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/design.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Design Guidelines">Design Guidelines</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/accessibility.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Accessibility">Accessibility</span></a></li></ul></devsite-expandable-nav></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Encryption">Encryption</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../encryption.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="file-based.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="File-Based Encryption">File-Based Encryption</span></a></li><li class="devsite-nav-item"><a href="full-disk.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Full-Disk Encryption">Full-Disk Encryption</span></a></li><li class="devsite-nav-item"><a href="metadata.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Metadata Encryption">Metadata Encryption</span></a></li><li class="devsite-nav-item"><a href="adiantum.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Enabling Adiantum">Enabling Adiantum</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Keystore">Keystore</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../keystore.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../keystore/features.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Features">Features</span></a></li><li class="devsite-nav-item"><a href="../keystore/attestation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Key Attestation">Key Attestation</span></a></li><li class="devsite-nav-item"><a href="../keystore/version-binding.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Version Binding">Version Binding</span></a></li><li class="devsite-nav-item"><a href="../keystore/tags.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Authorization Tags">Authorization Tags</span></a></li><li class="devsite-nav-item"><a href="../keystore/implementer-ref.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Functions">Functions</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="SELinux">SELinux</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../selinux.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../selinux/concepts.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Concepts">Concepts</span></a></li><li class="devsite-nav-item"><a href="../selinux/implement.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementation">Implementation</span></a></li><li class="devsite-nav-item"><a href="../selinux/customize.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Customization">Customization</span></a></li><li class="devsite-nav-item"><a href="../selinux/build.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Building sepolicy">Building sepolicy</span></a></li><li class="devsite-nav-item"><a href="../selinux/compatibility.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Compatibility">Compatibility</span></a></li><li class="devsite-nav-item"><a href="../selinux/validate.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Validation">Validation</span></a></li><li class="devsite-nav-item"><a href="../selinux/device-policy.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Writing Policy">Writing Policy</span></a></li><li class="devsite-nav-item"><a href="../selinux/vendor-init.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Vendor init">Vendor init</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Trusty TEE">Trusty TEE</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../trusty.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../trusty/download-and-build.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Download and Build">Download and Build</span></a></li><li class="devsite-nav-item"><a href="../trusty/trusty-ref.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Trusty API Reference">Trusty API Reference</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Verified Boot">Verified Boot</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../verifiedboot.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/device-state.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Device State">Device State</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/verified-boot.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Verifying Boot">Verifying Boot</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/boot-flow.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Boot Flow">Boot Flow</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/dm-verity.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementing dm-verity">Implementing dm-verity</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/avb.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Reference Implementation">Reference Implementation</span></a></li></ul></devsite-expandable-nav></li>
          </ul>
                                                                                                                                                                            </div>
      </div>
</nav>
              </devsite-book-nav>
      <div id="gc-wrapper">
        <div class="devsite-main-content"
            has-book-nav            has-toc>
          <devsite-toc class="devsite-nav"
            ></devsite-toc>
          <devsite-content>
                          

<article class="devsite-article">
  <article class="devsite-article-inner">        
    <div class="devsite-article-meta">
      <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                    <a href="../../index.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="1"
          >
            AOSP
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item
             ">
                <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
                    <a href="../../security.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="2"
          >
            Secure
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item
             ">
                <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
                    <a href="../features.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="3"
          >
            Features
      
  </a>
        </li>
  </ul>
               <devsite-page-rating position="header" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
          </div>

              <h1 class="devsite-page-title">Full-Disk Encryption</h1>
    
    <devsite-toc class="devsite-nav" devsite-toc-embedded >
    </devsite-toc>

    <div class="devsite-article-body clearfix
      ">

              
  <!--
      Copyright 2017 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->





























<aside class="note"><b>Note: </b>Devices running Android 7.0–9
support full-disk encryption. New devices running Android
10 and higher must use <a
href="file-based-2.html"> file-based encryption</a>.
</aside>

<p>Full-disk encryption is the process of encoding all user data on an Android device using an
encrypted key. Once a device is encrypted, all user-created data is
automatically encrypted before committing it to disk and all reads
automatically decrypt data before returning it to the calling process.</p>

<p>
Full-disk encryption was introduced to Android in 4.4, but Android 5.0 introduced
these new features:</p>
<ul>
  <li>Created fast encryption, which only encrypts used blocks on the data partition
to avoid first boot taking a long time. Only ext4 and f2fs filesystems
currently support fast encryption.
  <li>Added the <a href="../../devices/storage/config-2.html"><code translate="no" dir="ltr">forceencrypt</code>
      fstab flag</a> to encrypt on first boot.
  <li>Added support for patterns and encryption without a password.
  <li>Added hardware-backed storage of the encryption key using Trusted
    Execution Environment’s (TEE) signing capability (such as in a TrustZone).
    See <a href="#storing_the_encrypted_key">Storing the encrypted key</a> for more
    details.
</ul>

<p class="caution"><strong>Caution:</strong> Devices upgraded to Android 5.0 and then
encrypted may be returned to an unencrypted state by factory data reset. New Android 5.0
devices encrypted at first boot cannot be returned to an unencrypted state.</p>

<h2 id="how_android_encryption_works">How Android full-disk encryption works</h2>

<p>Android full-disk encryption is based on <code translate="no" dir="ltr">dm-crypt</code>, which is a kernel
feature that works at the block device layer. Because of
this, encryption works with Embedded MultiMediaCard<strong> (</strong>eMMC) and
similar flash devices that present themselves to the kernel as block
devices. Encryption is not possible with YAFFS, which talks directly to a raw
NAND flash chip. </p>

<p>The encryption algorithm is 128 Advanced Encryption Standard (AES) with
cipher-block chaining (CBC) and ESSIV:SHA256. The master key is encrypted with
128-bit AES via calls to the OpenSSL library. You must use 128 bits or more for
the key (with 256 being optional). </p>

<p class="note"><strong>Note:</strong> OEMs can use 128-bit or higher to encrypt the master key.</p>

<p>In the Android 5.0 release, there are four kinds of encryption states: </p>

<ul>
  <li>default
  <li>PIN
  <li>password
  <li>pattern
</ul>

<p>Upon first boot, the device creates a randomly generated 128-bit master key
and then hashes it with a default password and stored salt. The default password is: "default_password"
However, the resultant hash is also signed through a TEE (such as TrustZone),
which uses a hash of the signature to encrypt the master key.</p>

<p>You can find the default password defined in the Android Open Source Project <a
href="https://android.googlesource.com/platform/system/vold/+/master/cryptfs.cpp">cryptfs.cpp</a>
file.</p>

<p>When the user sets the PIN/pass or password on the device, only the 128-bit key
is re-encrypted and stored. (ie. user PIN/pass/pattern changes do NOT cause
re-encryption of userdata.) Note that
<a href="http://developer.android.google.cn/guide/topics/admin/device-admin.html">managed device</a>
may be subject to PIN, pattern, or password restrictions.</p>

<p>Encryption is managed by <code translate="no" dir="ltr">init</code> and <code translate="no" dir="ltr">vold</code>.
<code translate="no" dir="ltr">init</code> calls <code translate="no" dir="ltr">vold</code>, and vold sets properties to trigger
events in init. Other parts of the system
also look at the properties to conduct tasks such as report status, ask for a
password, or prompt to factory reset in the case of a fatal error. To invoke
encryption features in <code translate="no" dir="ltr">vold</code>, the system uses the command line tool
<code translate="no" dir="ltr">vdc</code>’s <code translate="no" dir="ltr">cryptfs</code> commands: <code translate="no" dir="ltr">checkpw</code>,
<code translate="no" dir="ltr">restart</code>, <code translate="no" dir="ltr">enablecrypto</code>, <code translate="no" dir="ltr">changepw</code>,
<code translate="no" dir="ltr">cryptocomplete</code>, <code translate="no" dir="ltr">verifypw</code>, <code translate="no" dir="ltr">setfield</code>,
<code translate="no" dir="ltr">getfield</code>, <code translate="no" dir="ltr">mountdefaultencrypted</code>, <code translate="no" dir="ltr">getpwtype</code>,
<code translate="no" dir="ltr">getpw</code>, and <code translate="no" dir="ltr">clearpw</code>.</p>

<p>In order to encrypt, decrypt or wipe <code translate="no" dir="ltr">/data</code>, <code translate="no" dir="ltr">/data</code>
must not be mounted. However, in order to show any user interface (UI), the
framework must start and the framework requires <code translate="no" dir="ltr">/data</code> to run. To
resolve this conundrum, a temporary filesystem is mounted on <code translate="no" dir="ltr">/data</code>.
This allows Android to prompt for passwords, show progress, or suggest a data
wipe as needed. It does impose the limitation that in order to switch from the
temporary filesystem to the true <code translate="no" dir="ltr">/data</code> filesystem, the system must
stop every process with open files on the temporary filesystem and restart those
processes on the real <code translate="no" dir="ltr">/data</code> filesystem. To do this, all services
must be in one of three groups: <code translate="no" dir="ltr">core</code>, <code translate="no" dir="ltr">main</code>, and
<code translate="no" dir="ltr">late_start</code>.</p>

<ul>
  <li><code translate="no" dir="ltr">core</code>: Never shut down after starting.
  <li><code translate="no" dir="ltr">main</code>: Shut down and then restart after the disk password is entered.
  <li><code translate="no" dir="ltr">late_start</code>: Does not start until after <code translate="no" dir="ltr">/data</code> has been decrypted and mounted.
</ul>

<p>To trigger these actions, the  <code translate="no" dir="ltr">vold.decrypt</code> property is set to
<a href="https://android.googlesource.com/platform/system/vold/+/master/cryptfs.c">various strings</a>.
To kill and restart services, the <code translate="no" dir="ltr">init</code> commands are:</p>

<ul>
  <li><code translate="no" dir="ltr">class_reset</code>: Stops a service but allows it to be restarted with class_start.
  <li><code translate="no" dir="ltr">class_start</code>: Restarts a service.
  <li><code translate="no" dir="ltr">class_stop</code>: Stops a service and adds a <code translate="no" dir="ltr">SVC_DISABLED</code> flag.
      Stopped services do not respond to <code translate="no" dir="ltr">class_start</code>.
</ul>

<h2 id="flows">Flows</h2>

<p>There are four flows for an encrypted device. A device is encrypted just once
and then follows a normal boot flow.  </p>

<ul>
  <li>Encrypt a previously unencrypted device:
  <ul>
    <li>Encrypt a new device with <code translate="no" dir="ltr">forceencrypt</code>: Mandatory encryption
         at first boot (starting in Android L).
    <li>Encrypt an existing device: User-initiated encryption (Android K and earlier).
  </ul>
  <li>Boot an encrypted device:
  <ul>
    <li>Starting an encrypted device with no password: Booting an encrypted device that
        has no set password (relevant for devices running Android 5.0 and later).
    <li>Starting an encrypted device with a password: Booting an encrypted device that
        has a set password.
  </ul>
</ul>

<p>In addition to these flows, the device can also fail to encrypt <code translate="no" dir="ltr">/data</code>.
Each of the flows are explained in detail below.</p>


<h3 id="encrypt_a_new_device_with_forceencrypt">Encrypt a new device with forceencrypt</h3>

<p>This is the normal first boot for an Android 5.0 device.</p>

<ol>
  <li><strong>Detect unencrypted filesystem with <code translate="no" dir="ltr">forceencrypt</code> flag</strong>

<p>
<code translate="no" dir="ltr">/data</code> is not encrypted but needs to be because <code translate="no" dir="ltr">forceencrypt</code> mandates it.
Unmount <code translate="no" dir="ltr">/data</code>.</p>

  <li><strong>Start encrypting <code translate="no" dir="ltr">/data</code></strong>

<p><code translate="no" dir="ltr">vold.decrypt = "trigger_encryption"</code> triggers <code translate="no" dir="ltr">init.rc</code>,
which will cause <code translate="no" dir="ltr">vold</code> to encrypt <code translate="no" dir="ltr">/data</code> with no password.
(None is set because this should be a new device.)</p>


  <li><strong>Mount tmpfs</strong>


<p><code translate="no" dir="ltr">vold</code> mounts a tmpfs <code translate="no" dir="ltr">/data</code> (using the tmpfs options from
<code translate="no" dir="ltr">ro.crypto.tmpfs_options</code>) and sets the property <code translate="no" dir="ltr">vold.encrypt_progress</code> to 0.
<code translate="no" dir="ltr">vold</code> prepepares the tmpfs <code translate="no" dir="ltr">/data</code> for booting an encrypted system and sets the
property <code translate="no" dir="ltr">vold.decrypt</code> to: <code translate="no" dir="ltr">trigger_restart_min_framework</code>
</p>

  <li><strong>Bring up framework to show progress</strong>


<p>Because the device has virtually no data to encrypt, the progress bar will
often not actually appear because encryption happens so quickly. See
<a href="#encrypt_an_existing_device">Encrypt an existing device</a> for more
details about the progress UI.</p>

  <li><strong>When <code translate="no" dir="ltr">/data</code> is encrypted, take down the framework</strong>

<p><code translate="no" dir="ltr">vold</code>  sets <code translate="no" dir="ltr">vold.decrypt</code> to
<code translate="no" dir="ltr">trigger_default_encryption</code> which starts the
<code translate="no" dir="ltr">defaultcrypto</code> service. (This starts the flow below for mounting a
default encrypted userdata.) <code translate="no" dir="ltr">trigger_default_encryption</code> checks the
encryption type to see if <code translate="no" dir="ltr">/data</code> is  encrypted with or without a
password. Because Android 5.0 devices are encrypted on first boot, there should
be no password set; therefore we decrypt and mount <code translate="no" dir="ltr">/data</code>.</p>

  <li><strong>Mount <code translate="no" dir="ltr">/data</code></strong>

<p><code translate="no" dir="ltr">init</code> then mounts <code translate="no" dir="ltr">/data</code> on a tmpfs RAMDisk using
parameters it picks up from <code translate="no" dir="ltr">ro.crypto.tmpfs_options</code>, which is set
in <code translate="no" dir="ltr">init.rc</code>.</p>

  <li><strong>Start framework</strong>

<p>Set <code translate="no" dir="ltr">vold</code> to <code translate="no" dir="ltr">trigger_restart_framework</code>, which
continues the usual boot process.</p>
</ol>

<h3 id="encrypt_an_existing_device">Encrypt an existing device</h3>

<p>This is what happens when you encrypt an unencrypted Android K or earlier
device that has been migrated to L.</p>

<p>This process is user-initiated and is referred to as “inplace encryption” in
the code. When a user selects to encrypt a device, the UI makes sure the
battery is fully charged and the AC adapter is plugged in so there is enough
power to finish the encryption process.</p>

<p class="warning"><strong>Warning:</strong> If the device runs out of power and shuts down before it has finished
encrypting, file data is left in a partially encrypted state. The device must
be factory reset and all data is lost.</p>

<p>To enable inplace encryption, <code translate="no" dir="ltr">vold</code> starts a loop to read each
sector of the real block device and then write it
to the crypto block device. <code translate="no" dir="ltr">vold</code> checks to see if a sector is in
use before reading and writing it, which makes
encryption much faster on a new device that has little to no data. </p>

<p><strong>State of device</strong>: Set <code translate="no" dir="ltr">ro.crypto.state = "unencrypted"</code>
and execute the <code translate="no" dir="ltr">on nonencrypted</code> <code translate="no" dir="ltr">init</code> trigger to continue booting.</p>

<ol>
  <li><strong>Check password</strong>

<p>The UI calls <code translate="no" dir="ltr">vold</code> with the command <code translate="no" dir="ltr">cryptfs enablecrypto inplace</code>
where <code translate="no" dir="ltr">passwd</code> is the user's lock screen password.</p>

  <li><strong>Take down the framework</strong>

<p><code translate="no" dir="ltr">vold</code> checks for errors, returns -1 if it can't encrypt, and
prints a reason in the log. If it can encrypt, it sets the property <code translate="no" dir="ltr">vold.decrypt</code>
to <code translate="no" dir="ltr">trigger_shutdown_framework</code>. This causes <code translate="no" dir="ltr">init.rc</code> to
stop services in the classes <code translate="no" dir="ltr">late_start</code> and <code translate="no" dir="ltr">main</code>. </p>

  <li><strong>Create a crypto footer</strong></li>
  <li><strong>Create a breadcrumb file</strong></li>
  <li><strong>Reboot</strong></li>
  <li><strong>Detect breadcrumb file</strong></li>
  <li><strong>Start encrypting <code translate="no" dir="ltr">/data</code></strong>

<p><code translate="no" dir="ltr">vold</code> then sets up the crypto mapping, which creates a virtual crypto block device
that maps onto the real block device but encrypts each sector as it is written,
and decrypts each sector as it is read. <code translate="no" dir="ltr">vold</code> then creates and writes
out the crypto metadata.</p>

  <li><strong>While it’s encrypting, mount tmpfs</strong>

<p><code translate="no" dir="ltr">vold</code> mounts a tmpfs <code translate="no" dir="ltr">/data</code> (using the tmpfs options
from <code translate="no" dir="ltr">ro.crypto.tmpfs_options</code>) and sets the property
<code translate="no" dir="ltr">vold.encrypt_progress</code> to 0. <code translate="no" dir="ltr">vold</code> prepares the tmpfs
<code translate="no" dir="ltr">/data</code> for booting an encrypted system and sets the property
<code translate="no" dir="ltr">vold.decrypt</code> to: <code translate="no" dir="ltr">trigger_restart_min_framework</code> </p>

  <li><strong>Bring up framework to show progress</strong>

<p><code translate="no" dir="ltr">trigger_restart_min_framework </code>causes <code translate="no" dir="ltr">init.rc</code> to
start the <code translate="no" dir="ltr">main</code> class of services. When the framework sees that
<code translate="no" dir="ltr">vold.encrypt_progress</code> is set to 0, it brings up the progress bar
UI, which queries that property every five seconds and updates a progress bar.
The encryption loop updates <code translate="no" dir="ltr">vold.encrypt_progress</code> every time it
encrypts another percent of the partition.</p>

  <li><strong>When <code translate="no" dir="ltr">/data</code> is encrypted, update the crypto footer</strong>

<p>When <code translate="no" dir="ltr">/data</code> is successfully encrypted, <code translate="no" dir="ltr">vold</code> clears
the flag <code translate="no" dir="ltr">ENCRYPTION_IN_PROGRESS</code> in the metadata.</p>

<p>When the device is successfully unlocked, the password is then used to
encrypt the master key and the crypto footer is updated.</p>

<p> If the reboot fails for some reason, <code translate="no" dir="ltr">vold</code> sets the property
<code translate="no" dir="ltr">vold.encrypt_progress</code> to <code translate="no" dir="ltr">error_reboot_failed</code> and
the UI should display a message asking the user to press a button to
reboot. This is not expected to ever occur.</p>
</ol>

<h3 id="starting_an_encrypted_device_with_default_encryption">
Starting an encrypted device with default encryption</h3>

<p>This is what happens when you boot up an encrypted device with no password.
Because Android 5.0 devices are encrypted on first boot, there should be no set
password and therefore this is the <em>default encryption</em> state.</p>

<ol>
  <li><strong>Detect encrypted <code translate="no" dir="ltr">/data</code> with no password</strong>

<p>Detect that the Android device is encrypted because <code translate="no" dir="ltr">/data</code>
cannot be mounted and one of the flags <code translate="no" dir="ltr">encryptable</code> or
<code translate="no" dir="ltr">forceencrypt</code> is set.</p>

<p><code translate="no" dir="ltr">vold</code> sets <code translate="no" dir="ltr">vold.decrypt</code> to
<code translate="no" dir="ltr">trigger_default_encryption</code>, which starts the
<code translate="no" dir="ltr">defaultcrypto</code> service. <code translate="no" dir="ltr">trigger_default_encryption</code>
checks the encryption type to see if <code translate="no" dir="ltr">/data</code> is encrypted with or
without a password. </p>

  <li><strong>Decrypt /data</strong>

<p>Creates the <code translate="no" dir="ltr">dm-crypt</code> device over the block device so the device
is ready for use.</p>

  <li><strong>Mount /data</strong>

<p><code translate="no" dir="ltr">vold</code> then mounts the decrypted real <code translate="no" dir="ltr">/data</code> partition
and then prepares the new partition. It sets the property
<code translate="no" dir="ltr">vold.post_fs_data_done</code> to 0 and then sets <code translate="no" dir="ltr">vold.decrypt</code>
to <code translate="no" dir="ltr">trigger_post_fs_data</code>. This causes <code translate="no" dir="ltr">init.rc</code> to run
its <code translate="no" dir="ltr">post-fs-data</code> commands. They will create any necessary directories
or links and then set <code translate="no" dir="ltr">vold.post_fs_data_done</code> to 1.</p>

<p>Once <code translate="no" dir="ltr">vold</code> sees the 1 in that property, it sets the property
<code translate="no" dir="ltr">vold.decrypt</code> to: <code translate="no" dir="ltr">trigger_restart_framework.</code> This
causes <code translate="no" dir="ltr">init.rc</code> to start services in class <code translate="no" dir="ltr">main</code>
again and also start services in class <code translate="no" dir="ltr">late_start</code> for the first
time since boot.</p>

  <li><strong>Start framework</strong>

<p>Now the framework boots all its services using the decrypted <code translate="no" dir="ltr">/data</code>,
and the system is ready for use.</p>
</ol>

<h3 id="starting_an_encrypted_device_without_default_encryption">
Starting an encrypted device without default encryption</h3>

<p>This is what happens when you boot up an encrypted device that has a set
password. The device’s password can be a pin, pattern, or password. </p>

<ol>
  <li><strong>Detect encrypted device with a password</strong>

<p>Detect that the Android device is encrypted because the flag
<code translate="no" dir="ltr">ro.crypto.state = "encrypted"</code></p>

<p><code translate="no" dir="ltr">vold</code> sets <code translate="no" dir="ltr">vold.decrypt</code> to
<code translate="no" dir="ltr">trigger_restart_min_framework</code> because <code translate="no" dir="ltr">/data</code> is
encrypted with a password.</p>

  <li><strong>Mount tmpfs</strong>

<p><code translate="no" dir="ltr">init</code> sets five properties to save the initial mount options
given for <code translate="no" dir="ltr">/data</code> with parameters passed from <code translate="no" dir="ltr">init.rc</code>.
<code translate="no" dir="ltr">vold</code> uses these properties to set up the crypto mapping:</p>

<ol>
  <li><code translate="no" dir="ltr">ro.crypto.fs_type</code>
  <li><code translate="no" dir="ltr">ro.crypto.fs_real_blkdev</code>
  <li><code translate="no" dir="ltr">ro.crypto.fs_mnt_point</code>
  <li><code translate="no" dir="ltr">ro.crypto.fs_options</code>
  <li><code translate="no" dir="ltr">ro.crypto.fs_flags </code>(ASCII 8-digit hex number preceded by 0x)
  </ol>

  <li><strong>Start framework to prompt for password</strong>

<p>The framework starts up and sees that <code translate="no" dir="ltr">vold.decrypt</code> is set to
<code translate="no" dir="ltr">trigger_restart_min_framework</code>. This tells the framework that it is
booting on a tmpfs <code translate="no" dir="ltr">/data</code> disk and it needs to get the user password.</p>

<p>First, however, it needs to make sure that the disk was properly encrypted. It
sends the command <code translate="no" dir="ltr">cryptfs cryptocomplete</code> to <code translate="no" dir="ltr">vold</code>.
<code translate="no" dir="ltr">vold</code> returns 0 if encryption was completed successfully, -1 on internal error, or
-2 if encryption was not completed successfully. <code translate="no" dir="ltr">vold</code> determines
this by looking in the crypto metadata for the <code translate="no" dir="ltr">CRYPTO_ENCRYPTION_IN_PROGRESS</code>
flag. If it's set, the encryption process was interrupted, and there is no
usable data on the device. If <code translate="no" dir="ltr">vold</code> returns an error, the UI should
display a message to the user to reboot and factory reset the device, and give
the user a button to press to do so.</p>

  <li><strong>Decrypt data with password</strong>

<p>Once <code translate="no" dir="ltr">cryptfs cryptocomplete</code> is successful, the framework
displays a UI asking for the disk password. The UI checks the password by
sending the command <code translate="no" dir="ltr">cryptfs checkpw</code> to <code translate="no" dir="ltr">vold</code>. If the
password is correct (which is determined by successfully mounting the
decrypted <code translate="no" dir="ltr">/data</code> at a temporary location, then unmounting it),
<code translate="no" dir="ltr">vold</code> saves the name of the decrypted block device in the property
<code translate="no" dir="ltr">ro.crypto.fs_crypto_blkdev</code> and returns status 0 to the UI. If the
password is incorrect, it returns -1 to the UI.</p>

  <li><strong>Stop framework</strong>

<p>The UI puts up a crypto boot graphic and then calls <code translate="no" dir="ltr">vold</code> with
the command <code translate="no" dir="ltr">cryptfs restart</code>. <code translate="no" dir="ltr">vold</code> sets the property
<code translate="no" dir="ltr">vold.decrypt</code> to <code translate="no" dir="ltr">trigger_reset_main</code>, which causes
<code translate="no" dir="ltr">init.rc</code> to do <code translate="no" dir="ltr">class_reset main</code>. This stops all services
in the main class, which allows the tmpfs <code translate="no" dir="ltr">/data</code> to be unmounted. </p>

  <li><strong>Mount <code translate="no" dir="ltr">/data</code></strong>

<p><code translate="no" dir="ltr">vold</code> then mounts the decrypted real <code translate="no" dir="ltr">/data</code> partition
and prepares the new partition (which may never have been prepared if
it was encrypted with the wipe option, which is not supported on first
release). It sets the property <code translate="no" dir="ltr">vold.post_fs_data_done</code> to 0 and then
sets <code translate="no" dir="ltr">vold.decrypt</code> to <code translate="no" dir="ltr">trigger_post_fs_data</code>. This causes
<code translate="no" dir="ltr">init.rc</code> to run its <code translate="no" dir="ltr">post-fs-data</code> commands. They will
create any necessary directories or links and then set
<code translate="no" dir="ltr">vold.post_fs_data_done</code> to 1. Once <code translate="no" dir="ltr">vold</code> sees the 1 in
that property, it sets the property <code translate="no" dir="ltr">vold.decrypt</code> to
<code translate="no" dir="ltr">trigger_restart_framework</code>. This causes <code translate="no" dir="ltr">init.rc</code> to start
services in class <code translate="no" dir="ltr">main</code> again and also start services in class
<code translate="no" dir="ltr">late_start</code> for the first time since boot.</p>

  <li><strong>Start full framework</strong>

<p>Now the framework boots all its services using the decrypted <code translate="no" dir="ltr">/data</code>
filesystem, and the system is ready for use.</p>
</ol>

<h3 id="failure">Failure</h3>

<p>A device that fails to decrypt might be awry for a few reasons. The device
starts with the normal series of steps to boot:</p>

<ol>
  <li>Detect encrypted device with a password
  <li>Mount tmpfs
  <li>Start framework to prompt for password
</ol>

<p>But after the framework opens, the device can encounter some errors:</p>

<ul>
  <li>Password matches but cannot decrypt data
  <li>User enters wrong password 30 times
</ul>

<p>If these errors are not resolved, <strong>prompt user to factory wipe</strong>:</p>

<p>If <code translate="no" dir="ltr">vold</code> detects an error during the encryption process, and if
no data has been destroyed yet and the framework is up, <code translate="no" dir="ltr">vold</code> sets
the property <code translate="no" dir="ltr">vold.encrypt_progress </code>to <code translate="no" dir="ltr">error_not_encrypted</code>.
The UI prompts the user to reboot and alerts them the encryption process
never started. If the error occurs after the framework has been torn down, but
before the progress bar UI is up, <code translate="no" dir="ltr">vold</code> will reboot the system. If
the reboot fails, it sets <code translate="no" dir="ltr">vold.encrypt_progress</code> to
<code translate="no" dir="ltr">error_shutting_down</code> and returns -1; but there will not be anything
to catch the error. This is not expected to happen.</p>

<p>If <code translate="no" dir="ltr">vold</code> detects an error during the encryption process, it sets
<code translate="no" dir="ltr">vold.encrypt_progress</code> to <code translate="no" dir="ltr">error_partially_encrypted</code>
and returns -1. The UI should then display a message saying the encryption
failed and provide a button for the user to factory reset the device. </p>

<h2 id="storing_the_encrypted_key">Storing the encrypted key</h2>

<p>The encrypted key is stored in the crypto metadata. Hardware backing is
implemented by using Trusted Execution Environment’s (TEE) signing capability.
Previously, we encrypted the master key with a key generated by applying scrypt
to the user's password and the stored salt. In order to make the key resilient
against off-box attacks, we extend this algorithm by signing the resultant key
with a stored TEE key. The resultant signature is then turned into an appropriate
length key by one more application of scrypt. This key is then used to encrypt
and decrypt the master key. To store this key:</p>

<ol>
  <li>Generate random 16-byte disk encryption key (DEK) and 16-byte salt.
  <li>Apply scrypt to the user password and the salt to produce 32-byte intermediate
key 1 (IK1).
  <li>Pad IK1 with zero bytes to the size of the hardware-bound private key (HBK).
Specifically, we pad as: 00 || IK1 || 00..00; one zero byte, 32 IK1 bytes, 223
zero bytes.
  <li>Sign padded IK1 with HBK to produce 256-byte IK2.
  <li>Apply scrypt to IK2 and salt (same salt as step 2) to produce 32-byte IK3.
  <li>Use the first 16 bytes of IK3 as KEK and the last 16 bytes as IV.
  <li>Encrypt DEK with AES_CBC, with key KEK, and initialization vector IV.
</ol>

<h2 id="changing_the_password">Changing the password</h2>

<p>When a user elects to change or remove their password in settings, the UI sends
the command <code translate="no" dir="ltr">cryptfs changepw</code>  to <code translate="no" dir="ltr">vold</code>, and
<code translate="no" dir="ltr">vold</code> re-encrypts the disk master key with the new password.</p>

<h2 id="encryption_properties">Encryption properties</h2>

<p><code translate="no" dir="ltr">vold</code> and <code translate="no" dir="ltr">init</code> communicate with each other by
setting properties. Here is a list of available properties for encryption.</p>

<h3 id="vold_properties">Vold properties</h3>

<table>
  <tr>
    <th>Property</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_encryption</code></td>
    <td>Encrypt the drive with no
    password.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_default_encryption</code></td>
    <td>Check the drive to see if it is encrypted with no password.
If it is, decrypt and mount it,
else set <code translate="no" dir="ltr">vold.decrypt</code> to trigger_restart_min_framework.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_reset_main</code></td>
    <td>Set by vold to shutdown the UI asking for the disk password.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_post_fs_data</code></td>
    <td> Set by vold to prep <code translate="no" dir="ltr">/data</code> with necessary directories, et al.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_restart_framework</code></td>
    <td>Set by vold to start the real framework and all services.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_shutdown_framework</code></td>
    <td>Set by vold to shutdown the full framework to start encryption.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.decrypt  trigger_restart_min_framework</code></td>
    <td>Set by vold to start the
progress bar UI for encryption or
prompt for password, depending on
the value of <code translate="no" dir="ltr">ro.crypto.state</code>.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.encrypt_progress</code></td>
    <td>When the framework starts up,
if this property is set, enter
the progress bar UI mode.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.encrypt_progress  0 to 100</code></td>
    <td>The progress bar UI should
display the percentage value set.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.encrypt_progress  error_partially_encrypted</code></td>
    <td>The progress bar UI should display a message that the encryption failed, and
give the user an option to
factory reset the device.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.encrypt_progress  error_reboot_failed</code></td>
    <td>The progress bar UI should display a message saying encryption
        completed, and give the user a button to reboot the device. This error
        is not expected to happen.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.encrypt_progress  error_not_encrypted</code></td>
    <td>The progress bar UI should
display a message saying an error
occurred,  no data was encrypted or
lost, and give the user a button to reboot the system.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.encrypt_progress  error_shutting_down</code></td>
    <td>The progress bar UI is not running, so it is unclear who will respond
         to this error. And it should never happen anyway.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.post_fs_data_done  0</code></td>
    <td>Set by <code translate="no" dir="ltr">vold</code> just before setting <code translate="no" dir="ltr">vold.decrypt</code>
        to <code translate="no" dir="ltr">trigger_post_fs_data</code>.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">vold.post_fs_data_done  1</code></td>
    <td>Set by <code translate="no" dir="ltr">init.rc</code> or
    <code translate="no" dir="ltr">init.rc</code> just after finishing the task <code translate="no" dir="ltr">post-fs-data</code>.</td>
  </tr>
</table>
<h3 id="init_properties">init properties</h3>

<table>
  <tr>
    <th>Property</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">ro.crypto.fs_crypto_blkdev</code></td>
    <td>Set by the <code translate="no" dir="ltr">vold</code> command <code translate="no" dir="ltr">checkpw</code> for later use
       by the <code translate="no" dir="ltr">vold</code> command <code translate="no" dir="ltr">restart</code>.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">ro.crypto.state unencrypted</code></td>
    <td>Set by <code translate="no" dir="ltr">init</code> to say this system is running with an unencrypted
    <code translate="no" dir="ltr">/data ro.crypto.state encrypted</code>. Set by <code translate="no" dir="ltr">init</code> to say
    this system is running with an encrypted <code translate="no" dir="ltr">/data</code>.</td>
  </tr>
  <tr>
    <td><p><code translate="no" dir="ltr">ro.crypto.fs_type<br>
      ro.crypto.fs_real_blkdev      <br>
      ro.crypto.fs_mnt_point<br>
      ro.crypto.fs_options<br>
      ro.crypto.fs_flags      <br>
    </code></p></td>
    <td> These five properties are set by
      <code translate="no" dir="ltr">init</code> when it tries to mount <code translate="no" dir="ltr">/data</code> with parameters passed in from
    <code translate="no" dir="ltr">init.rc</code>. <code translate="no" dir="ltr">vold</code> uses these to setup the crypto mapping.</td>
  </tr>
  <tr>
    <td><code translate="no" dir="ltr">ro.crypto.tmpfs_options</code></td>
    <td>Set by <code translate="no" dir="ltr">init.rc</code> with the options init should use when
        mounting the tmpfs <code translate="no" dir="ltr">/data</code> filesystem.</td>
  </tr>
</table>
<h2 id="init_actions">Init actions</h2>

<pre class="devsite-click-to-copy" translate="no" dir="ltr">
on post-fs-data
on nonencrypted
on property:vold.decrypt=trigger_reset_main
on property:vold.decrypt=trigger_post_fs_data
on property:vold.decrypt=trigger_restart_min_framework
on property:vold.decrypt=trigger_restart_framework
on property:vold.decrypt=trigger_shutdown_framework
on property:vold.decrypt=trigger_encryption
on property:vold.decrypt=trigger_default_encryption
</pre>

  
          </div>

    
                   <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
                   
          </article>
</article>

<devsite-content-footer class="nocontent">
  <p>Content and code samples on this page are subject to the licenses described in the <a href="../../license.html">Content License</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
</devsite-content-footer>


                      </devsite-content>
        </div>
        <devsite-footer-promos class="devsite-footer">
                      
                  </devsite-footer-promos>
        <devsite-footer-linkboxes class="devsite-footer">
                      <nav class="devsite-footer-linkboxes nocontent">
  <ul class="devsite-footer-linkboxes-list">
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Build</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.googlesource.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android repository
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/requirements.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Requirements
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/downloading.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Downloading
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/blobs-preview/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Preview binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/images/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Factory images
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/drivers/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Driver binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.github.io/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            GitHub
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Connect</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/Android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            @Android on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/AndroidDev/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            @AndroidDev on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://blog.google/products/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Android Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://security.googleblog.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Google Security Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-platform/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Platform on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-building/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Building on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-porting/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Porting on Google Groups
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Get help</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/pixelphone/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Pixel Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/nexus/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Nexus Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            www.android.com
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/gms/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Google Mobile Services
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://stackoverflow.com/questions/tagged/android-source/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Stack Overflow
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://issuetracker.google.com/issues?q=status:open%20componentid:190923"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Issue Tracker
          </a>
        </li>
              </ul>
    </li>
      </ul>
</nav>
                  </devsite-footer-linkboxes>
        <devsite-footer-utility class="devsite-footer">
                      
<div class="devsite-footer-utility">
  
  <nav class="devsite-nav">
        <ul class="devsite-footer-utility-list">
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../source/index.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer About Android link">
          About Android
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../setup/community.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Community link">
          Community
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../legal.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Legal link">
          Legal
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../license.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer License link">
          License
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://policies.google.cn/privacy"
           data-category="Site-Wide Custom Events"
           data-label="Footer Privacy link">
          Privacy
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://issuetracker.google.com/issues/new?component=191476"
           data-category="Site-Wide Custom Events"
           data-label="Footer Site feedback link">
          Site feedback
        </a>
              </li>
          </ul>
    
    <devsite-language-selector>
  <devsite-select class="devsite-language-selector-menu">
    <select class="devsite-language-selector-select"
            name="language"
            track-name="click"
            track-type="languageSelector">
                <option>Language</option>
              <option value="en"
              track-metadata-original-language="en"
              track-metadata-selected-language="en"
              track-name="changed"
              track-type="languageSelector"
            >
        English
      </option>
          <option value="zh_cn"
              track-metadata-original-language="en"
              track-metadata-selected-language="zh_cn"
              track-name="changed"
              track-type="languageSelector"
            >
        中文 – 简体
      </option>
        </select>
  </devsite-select>
</devsite-language-selector>

  </nav>
</div>
                  </devsite-footer-utility>
      </div></div>
    <devsite-sitemask></devsite-sitemask>
    <devsite-snackbar                   ></devsite-snackbar>    <devsite-tooltip blocked-link></devsite-tooltip>
    <devsite-analytics>
              <script type="application/json" analytics>[{"metrics": {"ratings_value": "metric1", "ratings_count": "metric2"}, "dimensions": {}, "gaid": "UA-45455297-4"}]</script>
<script type="application/json" gtm>[]</script>
          </devsite-analytics>
        <script>
    (function(d,e,v,s,i,t,E){d['GoogleDevelopersObject']=i;
    t=e.createElement(v);t.async=1;t.src=s;E=e.getElementsByTagName(v)[0];
    E.parentNode.insertBefore(t,E);})(window, document, 'script',
    'https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/js/app_loader.js', '[7,"en",null,"../../js/devsite_app.html","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource","https://androidsource-dot-google-developers.gonglchuangl.net/",null,null,["/_pwa/androidsource/manifest.json","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/images/video-placeholder.svg","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/favicon.png","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg","https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons"]]')
  </script>  </body>

<!-- Mirrored from source.android.google.cn/security/encryption/full-disk.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Sep 2019 15:19:41 GMT -->
</html>