<!doctype html>
<html       lang="en"      dir="ltr">
  
<!-- Mirrored from source.android.google.cn/security/keystore/tags by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Sep 2019 15:19:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta property="og:site_name" content="Android Open Source Project">
    <meta property="og:type" content="website">
    
          <meta name="theme-color" content="#78c257">
    
    <meta charset="utf-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="../../_pwa/androidsource/manifest.json"
          crossorigin="use-credentials">
    <link rel="preconnect" href="http://www.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.googleapis.com/" crossorigin>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons">
        <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/css/rebrand-app.css">
    <noscript>
      <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/css/ce_bundle.css">
    </noscript>
    <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/favicon.png">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/touchicon-180.png"><link rel="canonical" href="tags.html">      
<title>Keymaster Authorization Tags &nbsp;|&nbsp; Android Open Source Project</title>

<meta property="og:title" content="Keymaster Authorization Tags &nbsp;|&nbsp; Android Open Source Project">


  <meta property="og:url" content="tags.html">

  <meta property="og:locale" content="en">




    
    
    
  
    </head>
  <body type="article"
        theme="androidsource-theme"
        class=""
        
        layout="docs"
        block-apix        pending>
    <devsite-progress type="indeterminate" id="app-progress"></devsite-progress>
    <div class="devsite-wrapper"><devsite-header keep-tabs-visible>
      









<div class="devsite-header--inner">
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu"
          class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Navigation menu button"
          visually-hidden
          aria-label="Close menu">
        </button>
        <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.cn/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
            <span class="devsite-product-name">
            <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                              </li>
  </ul>
          </span>
        
</div>        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
                          <devsite-tabs class="upper-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../setup.html"
   class="gc-analytics-event"
   title="Set up"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Set up"
   >
  Set up
</a>

        </tab>
                        <tab >
          <a href="../../compatibility.html"
   class="gc-analytics-event"
   title="Design"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Design"
   >
  Design
</a>

        </tab>
                        <tab active>
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Secure"
   aria-label="Secure, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Secure"
   >
  Secure
</a>

        </tab>
                        <tab >
          <a href="../../devices.html"
   class="gc-analytics-event"
   title="Develop"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Develop"
   >
  Develop
</a>

        </tab>
                        <tab >
          <a href="../../devices/tech.html"
   class="gc-analytics-event"
   title="Configure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Configure"
   >
  Configure
</a>

        </tab>
                        <tab >
          <a href="../../reference.html"
   class="gc-analytics-event"
   title="Reference"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Reference"
   >
  Reference
</a>

        </tab>
            </div>
</devsite-tabs>

                       </div>
          <devsite-search
            enable-suggestions
              family-name="Android Open Source Project"    tenant-name="Android Open Source Project"            >
  <form class="devsite-search-form" action="https://source.android.google.cn/s/results" method="GET">
    <div class="devsite-search-container">
      <div class="devsite-searchbox">
                <input placeholder="Search"
          type="text"
          class="devsite-search-field devsite-search-query"
          name="q"
          value=""
          autocomplete="off"
                    aria-label="Search box">
        <div class="devsite-search-image material-icons" aria-hidden="true"></div>
      </div>
      <button type="button"
              search-open
              class="devsite-search-button devsite-header-icon-button button-flat material-icons"
              aria-label="Open search box"></button>
    </div>
  </form>
  <button type="button"
          search-close
          class="devsite-search-button devsite-header-icon-button button-flat material-icons"
          aria-label="Close search box"></button>
</devsite-search>

        </div>

        <devsite-language-selector>
  <devsite-select class="devsite-language-selector-menu">
    <select class="devsite-language-selector-select"
            name="language"
            track-name="click"
            track-type="languageSelector">
                <option>Language</option>
              <option value="en"
              track-metadata-original-language="en"
              track-metadata-selected-language="en"
              track-name="changed"
              track-type="languageSelector"
            >
        English
      </option>
          <option value="zh_cn"
              track-metadata-original-language="en"
              track-metadata-selected-language="zh_cn"
              track-name="changed"
              track-type="languageSelector"
            >
        中文 – 简体
      </option>
        </select>
  </devsite-select>
</devsite-language-selector>


                  <a class="devsite-header-link devsite-top-button button gc-analytics-event"
   href="http://android-review.googlesource.com/"
   data-category="Site-Wide Custom Events"
   data-label="Site header link">
  Go to code
</a>
        
              </div>    </div>  </div>
  <div class="devsite-collapsible-section
    ">
    <div class="devsite-header-background">
                        <div class="devsite-product-id-row">
            <div class="devsite-product-description-row">
                              <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                    <a href="../../security.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Lower Header"
              data-value="1"
          >
            Secure
      
  </a>
        </li>
  </ul>
                                        </div>
                                                                                    </div>
                                      <div class="devsite-doc-set-nav-row">
                              <devsite-tabs class="lower-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Overview"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Overview"
   >
  Overview
</a>

        </tab>
                        <tab >
          <a href="../bulletin.html"
   class="gc-analytics-event"
   title="Bulletins"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Bulletins"
   >
  Bulletins
</a>

        </tab>
                        <tab active>
          <a href="../features.html"
   class="gc-analytics-event"
   title="Features"
   aria-label="Features, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Features"
   >
  Features
</a>

        </tab>
                        <tab >
          <a href="../../devices/tech/debug/fuzz-sanitize.html"
   class="gc-analytics-event"
   title="Testing"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Testing"
   >
  Testing
</a>

        </tab>
                        <tab >
          <a href="../best-practices.html"
   class="gc-analytics-event"
   title="Best Practices"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Best Practices"
   >
  Best Practices
</a>

        </tab>
            </div>
</devsite-tabs>

        </div>
          </div>  </div></div>
  

  </devsite-header>      <devsite-book-nav scrollbars >
                  




<nav class="devsite-book-nav devsite-nav nocontent">
  <div class="devsite-mobile-header">
    <button type="button"
            id="devsite-close-nav"
            class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
            data-category="Site-Wide Custom Events"
            data-label="Close navigation"
            aria-label="Close navigation">
    </button>
    <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
        <span class="devsite-product-name">
        <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                              </li>
  </ul>
      </span>
    
</div>  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
              <ul class="devsite-nav-list">
                      <li class="devsite-nav-item">
                                <a href="../../setup.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Set up">
      <span class="devsite-nav-text" >Set up</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../compatibility.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Design">
      <span class="devsite-nav-text" >Design</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            devsite-nav-active"
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Secure">
      <span class="devsite-nav-text" >Secure</span>
        </a>
  
                                            <ul class="devsite-nav-responsive-tabs">
                                                                                                                      <li class="devsite-nav-item">
    <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Overview">
      <span class="devsite-nav-text" >Overview</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../bulletin.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Bulletins">
      <span class="devsite-nav-text" >Bulletins</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../features.html"
     id="devsite-nav-forward"     class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Features">
      <span class="devsite-nav-text" menu="_book">Features</span>
        <span class="devsite-nav-icon material-icons" data-icon="forward" aria-hidden="true"
          menu="_book">
    </span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../../devices/tech/debug/fuzz-sanitize.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Testing">
      <span class="devsite-nav-text" >Testing</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../best-practices.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Best Practices">
      <span class="devsite-nav-text" >Best Practices</span>
        </a>
  </li>

                                  </ul>
                          </li>
                      <li class="devsite-nav-item">
                                <a href="../../devices.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Develop">
      <span class="devsite-nav-text" >Develop</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../devices/tech.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Configure">
      <span class="devsite-nav-text" >Configure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../reference.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Reference">
      <span class="devsite-nav-text" >Reference</span>
        </a>
  
                                        </li>
                                <li class="devsite-nav-item">
    <a href="http://android-review.googlesource.com/"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Go to code">
      <span class="devsite-nav-text" >Go to code</span>
        </a>
  </li>

                  </ul>
          </div>
          <div class="devsite-mobile-nav-bottom">
                            <ul class="devsite-nav-list" menu="_book">
            <li class="devsite-nav-item"><a href="../features.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li>
  <li class="devsite-nav-item"><a href="../app-sandbox.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Application Sandbox">Application Sandbox</span></a></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Application Signing">Application Signing</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../apksigning.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../apksigning/v2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="APK Signature Scheme v2">APK Signature Scheme v2</span></a></li><li class="devsite-nav-item"><a href="../apksigning/v3.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="APK Signature Scheme v3">APK Signature Scheme v3</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Authentication">Authentication</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../authentication.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../authentication/gatekeeper.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Gatekeeper">Gatekeeper</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Biometrics">Biometrics</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../biometric.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../biometric/measure.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Measuring Biometric Security">Measuring Biometric Security</span></a></li><li class="devsite-nav-item"><a href="../authentication/fingerprint-hal.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Fingerprint HIDL">Fingerprint HIDL</span></a></li><li class="devsite-nav-item"><a href="../biometric/face-authentication.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Face Authentication HIDL">Face Authentication HIDL</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Protected Confirmation">Protected Confirmation</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../protected-confirmation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/implementation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementation">Implementation</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/design.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Design Guidelines">Design Guidelines</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/accessibility.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Accessibility">Accessibility</span></a></li></ul></devsite-expandable-nav></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Encryption">Encryption</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../encryption.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../encryption/file-based.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="File-Based Encryption">File-Based Encryption</span></a></li><li class="devsite-nav-item"><a href="../encryption/full-disk.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Full-Disk Encryption">Full-Disk Encryption</span></a></li><li class="devsite-nav-item"><a href="../encryption/metadata.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Metadata Encryption">Metadata Encryption</span></a></li><li class="devsite-nav-item"><a href="../encryption/adiantum.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Enabling Adiantum">Enabling Adiantum</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Keystore">Keystore</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../keystore.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="features.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Features">Features</span></a></li><li class="devsite-nav-item"><a href="attestation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Key Attestation">Key Attestation</span></a></li><li class="devsite-nav-item"><a href="version-binding.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Version Binding">Version Binding</span></a></li><li class="devsite-nav-item"><a href="tags.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Authorization Tags">Authorization Tags</span></a></li><li class="devsite-nav-item"><a href="implementer-ref.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Functions">Functions</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="SELinux">SELinux</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../selinux.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../selinux/concepts.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Concepts">Concepts</span></a></li><li class="devsite-nav-item"><a href="../selinux/implement.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementation">Implementation</span></a></li><li class="devsite-nav-item"><a href="../selinux/customize.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Customization">Customization</span></a></li><li class="devsite-nav-item"><a href="../selinux/build.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Building sepolicy">Building sepolicy</span></a></li><li class="devsite-nav-item"><a href="../selinux/compatibility.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Compatibility">Compatibility</span></a></li><li class="devsite-nav-item"><a href="../selinux/validate.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Validation">Validation</span></a></li><li class="devsite-nav-item"><a href="../selinux/device-policy.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Writing Policy">Writing Policy</span></a></li><li class="devsite-nav-item"><a href="../selinux/vendor-init.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Vendor init">Vendor init</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Trusty TEE">Trusty TEE</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../trusty.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../trusty/download-and-build.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Download and Build">Download and Build</span></a></li><li class="devsite-nav-item"><a href="../trusty/trusty-ref.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Trusty API Reference">Trusty API Reference</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Verified Boot">Verified Boot</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../verifiedboot.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/device-state.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Device State">Device State</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/verified-boot.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Verifying Boot">Verifying Boot</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/boot-flow.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Boot Flow">Boot Flow</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/dm-verity.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementing dm-verity">Implementing dm-verity</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/avb.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Reference Implementation">Reference Implementation</span></a></li></ul></devsite-expandable-nav></li>
          </ul>
                                                                                                                                                                            </div>
      </div>
</nav>
              </devsite-book-nav>
      <div id="gc-wrapper">
        <div class="devsite-main-content"
            has-book-nav            has-toc>
          <devsite-toc class="devsite-nav"
            ></devsite-toc>
          <devsite-content>
                          

<article class="devsite-article">
  <article class="devsite-article-inner">        
    <div class="devsite-article-meta">
      <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                    <a href="../../index.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="1"
          >
            AOSP
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item
             ">
                <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
                    <a href="../../security.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="2"
          >
            Secure
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item
             ">
                <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
                    <a href="../features.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="3"
          >
            Features
      
  </a>
        </li>
  </ul>
               <devsite-page-rating position="header" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
          </div>

              <h1 class="devsite-page-title">Keymaster Authorization Tags</h1>
    
    <devsite-toc class="devsite-nav" devsite-toc-embedded >
    </devsite-toc>

    <div class="devsite-article-body clearfix
      ">

              
  <!--
      Copyright 2017 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          http://www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->

<p>This page provides details to assist implementers of Keymaster HALs.
It covers each tag in the HAL, which Keymaster version that tag is available
in, and whether the tag is repeatable. Except as noted in the tag descriptions,
all of the tags below are used during key generation to specify key
characteristics.</p>
<p>For Keymaster 4, tags are defined in
<code translate="no" dir="ltr">platform/hardware/interfaces/keymaster/<var>keymaster-version</var>/types.hal</code>,
such as
<a href="https://android.googlesource.com/platform/hardware/interfaces/+/master/keymaster/3.0/types.hal" class="external">
3.0/types.hal</a> for Keymaster 3 and
<a href="https://android.googlesource.com/platform/hardware/interfaces/+/master/keymaster/4.0/types.hal" class="external">
4.0/types.hal</a> for Keymaster 4. For Keymaster 2 and below, tags are defined in
<code translate="no" dir="ltr"><a href="https://android.googlesource.com/platform/hardware/libhardware/+/master/include/hardware" class="external">
platform/hardware/libhardware/include/hardware/keymaster_defs.h</a></code>.</p>

<p>For functions, see the
<a href="implementer-ref.html">Keymaster Functions</a> page.</p>

<aside class="note"><b>Note:</b> To support Keymaster 3's transition from the
old-style C-structure HAL to the C++ HAL interface generated from a definition
in the new Hardware Interface Definition Language (HIDL), tag names have changed
in Android 8.0. Tags, like all other keymaster enums, are now defined as C++
scoped enums. For example, tags, formerly prefixed with <code translate="no" dir="ltr">KM_TAG_</code>,
are now prefixed with <code translate="no" dir="ltr">Tag::</code>.</aside>

<h2 id="active_datetime">Tag::ACTIVE_DATETIME</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the date and time at which the key becomes active. Prior to this
time, any attempt to use the key fails with
<code translate="no" dir="ltr">ErrorCode::KEY_NOT_YET_VALID</code>.</p>

<p>The value is a 64-bit integer representing milliseconds since January 1,
1970.</p>


<h2 id="algorithm">Tag::ALGORITHM</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the cryptographic algorithm with which the key is used.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class Algorithm : uint32_t {
    RSA = 1,
    EC = 3,
    AES = 32,
    HMAC = 128,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_ALGORITHM_RSA = 1,
    KM_ALGORITHM_EC = 3,
    KM_ALGORITHM_AES = 32,
    KM_ALGORITHM_HMAC = 128,
} keymaster_algorithm_t;
</pre>


<h2 id="all_applications">Tag::ALL_APPLICATIONS</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Reserved for future use.</p>


<h2 id="allow_while_on_body">Tag::ALLOW_WHILE_ON_BODY</h2>

<p><strong>Version</strong>: 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>This tag is applicable only for Android Wear devices with on-body sensors. At
this point, it's not expected that any TEE will be able to provide secure access
to an on-body sensor, or that on-body sensors are very secure, so this is
expected to be a purely software-enforced feature.</p>

<h2 id="all_users">Tag::ALL_USERS</h2>

<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Reserved for future use.</p>

<h2 id="application_data">Tag::APPLICATION_DATA</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>When provided to
<a href="implementer-ref.html#generate_key">generateKey</a>
or <a href="implementer-ref.html#import_key">importKey</a>,
this tag specifies data that is necessary during all uses of the key. In
particular, calls to
<a href="implementer-ref.html#export_key">exportKey</a> and
<a href="implementer-ref.html#get_key_characteristics">getKeyCharacteristics</a>
need to provide the same value to the <code translate="no" dir="ltr">clientId</code> parameter, and calls
to <a href="implementer-ref.html#begin">begin</a> need to provide
this tag and the same associated data as part of the <code translate="no" dir="ltr">inParams</code>
set. If the correct data is not provided, the function returns
<code translate="no" dir="ltr">ErrorCode::INVALID_KEY_BLOB</code>.</p>

<p>The content of this tag is bound to the key <em>cryptographically</em>,
meaning it must not be possible for an adversary who has access to all of the
secure world secrets but does not have access to the tag content to decrypt the
key without brute-forcing the tag content, which applications can prevent by
specifying sufficiently high-entropy content.</p>

<p>The value is a blob, an arbitrary-length array of bytes.</p>


<h2 id="application_id">Tag::APPLICATION_ID</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>When provided to
<a href="implementer-ref.html#generate_key">generateKey</a>
or <a href="implementer-ref.html#import_key">importKey</a>,
this tag specifies data that is necessary during all uses of the key. In
particular, calls to
<a href="implementer-ref.html#export_key">exportKey</a> and
<a href="implementer-ref.html#get_key_characteristics">getKeyCharacteristics</a>
need to provide the same value in the <code translate="no" dir="ltr">clientId</code> parameter, and
calls to <a href="implementer-ref.html#begin">begin</a> need to
provide this tag and the same associated data as part of the
<code translate="no" dir="ltr">inParams</code> set. If the correct data is not provided, the function
returns <code translate="no" dir="ltr">ErrorCode::INVALID_KEY_BLOB</code>.</p>

<p>The content of this tag is bound to the key <em>cryptographically</em>,
meaning it an adversary who can access all of the secure world secrets—but
does not have access to the tag content—can't decrypt the
key (without brute-forcing the tag content).</p>

<p>The value is a blob, an arbitrary-length array of bytes.</p>


<h2 id="associated_data">Tag::ASSOCIATED_DATA</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides "associated data" for AES-GCM encryption or decryption. This tag is
provided to <a href="implementer-ref.html#update">update</a> and
specifies data that is not encrypted/decrypted, but is used in computing
the GCM tag.</p>

<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_application_id">Tag::ATTESTATION_APPLICATION_ID</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

 <p>Used to identify the set of possible applications of which one
 has initiated a key attestation.</p>

<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_challenge">Tag::ATTESTATION_CHALLENGE</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Used to provide challenge in attestation.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_brand">Tag::ATTESTATION_ID_BRAND</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the device's brand name, as returned by <code translate="no" dir="ltr">Build.BRAND</code>
in Android. This field is set only when requesting attestation of the
device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_device">Tag::ATTESTATION_ID_DEVICE</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the device's device name, as returned by <code translate="no" dir="ltr">Build.DEVICE</code>
in Android. This field is set only when requesting attestation of the
device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_imei">Tag::ATTESTATION_ID_IMEI</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? Yes</p>

<p>Provides the IMEIs for all radios on the device. This field is set only
when requesting attestation of the device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_manufacturer">Tag::ATTESTATION_ID_MANUFACTURER</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the device's manufacturer name, as returned by
<code translate="no" dir="ltr">Build.MANUFACTURER</code> in Android. This field is set only when
requesting attestation of the device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_meid">Tag::ATTESTATION_ID_MEID</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? Yes</p>

<p>Provides the MEIDs for all radios on the device. This field will only be set
when requesting attestation of the device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_model">Tag::ATTESTATION_ID_MODEL</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the device's model name, as returned by
<code translate="no" dir="ltr">Build.MODEL</code> in Android. This field is set only when
requesting attestation of the device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>

<p>The value is a blob, an arbitrary-length array of bytes.</p>


<h2 id="attestation_id_product">Tag::ATTESTATION_ID_PRODUCT</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the device's product name, as returned by
<code translate="no" dir="ltr">Build.PRODUCT</code> in Android. This field is set only when
requesting attestation of the device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="attestation_id_serial">Tag::ATTESTATION_ID_SERIAL</h2>
<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the device's serial number. This field is set only when
requesting attestation of the device's identifiers.</p>
<p>If the device does not support ID attestation (or
<code translate="no" dir="ltr">destroyAttestationIds()</code> was previously called and the device can
no longer attest its IDs), any key attestation request that includes
this tag fails with <code translate="no" dir="ltr">ErrorCode::CANNOT_ATTEST_IDS</code>.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>

<h2 id="auth_timeout">Tag::AUTH_TIMEOUT</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the time in seconds for which the key is authorized for use, after
authentication. If <a href="#user_secure_id">Tag::USER_SECURE_ID</a>
is present and this tag is not, then the key needs authentication for every
usage (see <a href="implementer-ref.html#begin">begin</a> for the
details of the authentication-per-operation flow).</p>

<p>The value is a 32-bit integer specifying the time in seconds after a
successful authentication of the user specified by <a
href="#user_secure_id">Tag::USER_SECURE_ID</a> with the authentication method
specified by <a href="#mac_length">Tag::USER_AUTH_TYPE</a> that the key can be
used.</p>


<h2 id="auth_token">Tag::AUTH_TOKEN</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides an
<a href="../authentication/index-2.html#authtoken_format">authentication
token</a> to <a href="implementer-ref.html#begin">begin</a>,
<a href="implementer-ref.html#update">update</a> or
<a href="implementer-ref.html#finish">finish</a>,
to prove user authentication for a key operation that requires
it (key has <a href="#user_secure_id">Tag::USER_SECURE_ID</a>).</p>

<p>The value is a blob which contains a <code translate="no" dir="ltr">hw_auth_token_t</code> structure.
</p>


<h2 id="blob_usage_requirements">Tag::BLOB_USAGE_REQUIREMENTS</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the necessary system environment conditions for the generated
key to be used.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class KeyBlobUsageRequirements : uint32_t {
    STANDALONE = 0,
    REQUIRES_FILE_SYSTEM = 1,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_BLOB_STANDALONE = 0,
    KM_BLOB_REQUIRES_FILE_SYSTEM = 1,
} keymaster_key_blob_usage_requirements_t;
</pre>

<p>This tag can be specified during key generation to require that the key is
usable in the specified condition. It needs to be returned with the key
characteristics from
<a href="implementer-ref.html#generate_key">generateKey</a> and
<a href="implementer-ref.html#get_key_characteristics">getKeyCharacteristics</a>.
If the caller specifies <code translate="no" dir="ltr">Tag::BLOB_USAGE_REQUIREMENTS</code> with
value <code translate="no" dir="ltr">KeyBlobUsageRequirements::STANDALONE</code> the trustlet returns a key blob
that can be used without file system support. This is critical for devices
with encrypted disks, where the file system may not be available until
after a Keymaster key is used to decrypt the disk.</p>


<h2 id="block_mode">Tag::BLOCK_MODE</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? Yes</p>

<p>Specifies the block cipher mode(s) with which the key may be used.
This tag is only relevant to AES keys.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class BlockMode : uint32_t {
    ECB = 1,
    CBC = 2,
    CTR = 3,
    GCM = 32,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_MODE_ECB = 1,
    KM_MODE_CBC = 2,
    KM_MODE_CTR = 3,
    KM_MODE_GCM = 32,
} keymaster_block_mode_t;
</pre>

<p>This tag is repeatable, and for AES key operations specify a mode in
the <code translate="no" dir="ltr">additionalParams</code> argument of
<a href="implementer-ref.html#begin">begin</a>.
If the specifiedmode is not in the modes associated with the key, the
operation fails with <code translate="no" dir="ltr">ErrorCode::INCOMPATIBLE_BLOCK_MODE</code>.</p>

<h2 id="boot_patchlevel">Tag::BOOT_PATCHLEVEL</h2>
<p><strong>Version</strong>: 4</p>
<p>Tag::BOOT_PATCHLEVEL specifies the boot image (kernel) security patch level
with which the key may be used. This tag is never sent to the keymaster TA, but
is added to the hardware-enforced authorization list by the TA. Any attempt to
use a key with a <code translate="no" dir="ltr">Tag::BOOT_PATCHLEVEL</code> value different from the
currently running system patchlevel causes <code translate="no" dir="ltr">begin()</code>,
<code translate="no" dir="ltr">getKeyCharacteristics()</code> or <code translate="no" dir="ltr">exportKey()</code> to return
<code translate="no" dir="ltr">ErrorCode::KEY_REQUIRES_UPGRADE</code>. See <code translate="no" dir="ltr">upgradeKey()</code>
for details.
</p>
<p>
The value of the tag is an integer of the form YYYYMMDD, where YYYY is the
four-digit year of the last update, MM is the two-digit month and DD is the
two-digit day of the last update. For example, for a key generated on an
Android device last updated on June 5, 2018, the value would be 20180605.
If the day is not known, 00 may be substituted.
</p>
<p>
During each boot, the bootloader must provide the patch level of the boot image
to the secure envirionment (mechanism is implementation-defined).
</p>
<p>
Must be hardware-enforced.
</p>

<h2 id="bootloader_only">Tag::BOOTLOADER_ONLY</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies only the bootloader can use the key.</p>

<p>This tag is boolean, so the possible values are true (if the tag is present)
and false (if the tag is not present).</p>

<p>Any attempt to use a key with <code translate="no" dir="ltr">Tag::BOOTLOADER_ONLY</code> from the
Android system fails with <code translate="no" dir="ltr">ErrorCode::INVALID_KEY_BLOB</code>.</p>


<h2 id="caller_nonce">Tag::CALLER_NONCE</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies that the caller can provide a nonce for nonce-requiring operations.
</p>

<p>This tag is boolean, so the possible values are true (if the tag is present)
and false (if the tag is not present).</p>

<p>This tag is used only for AES keys, and is only relevant for CBC, CTR and GCM
block modes. If the tag is not present, implementations should reject any
operation that provides <a href="#nonce">Tag::NONCE</a> to
<a href="implementer-ref.html#begin">begin</a>
with <code translate="no" dir="ltr">ErrorCode::CALLER_NONCE_PROHIBITED</code>.</p>


<h2 id="creation_datetime">Tag::CREATION_DATETIME</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the date and time the key was created, in milliseconds since
January 1, 1970. This tag is optional and informational only.</p>


<h2 id="digest">Tag::DIGEST</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? Yes</p>

<p>Specifies the digest algorithms that may be used with the key to perform
signing and verification operations. This tag is relevant to RSA, ECDSA and
HMAC keys.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class Digest : uint32_t {
    NONE = 0,
    MD5 = 1,
    SHA1 = 2,
    SHA_2_224 = 3,
    SHA_2_256 = 4,
    SHA_2_384 = 5,
    SHA_2_512 = 6,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_DIGEST_NONE = 0,
    KM_DIGEST_MD5 = 1,
    KM_DIGEST_SHA1 = 2,
    KM_DIGEST_SHA_2_224 = 3,
    KM_DIGEST_SHA_2_256 = 4,
    KM_DIGEST_SHA_2_384 = 5,
    KM_DIGEST_SHA_2_512 = 6,
}
keymaster_digest_t;
</pre>

<p>This tag is repeatable. For signing and verification operations, specify
a digest in the <code translate="no" dir="ltr">additionalParams</code> argument of
<a href="implementer-ref.html#begin">begin</a>.
If the specified digest is not in the digests associated with the key, the
operation fails with <code translate="no" dir="ltr">ErrorCode::INCOMPATIBLE_DIGEST</code>.</p>

<h2 id="ec_curve">Tag::EC_CURVE</h2>

<p><strong>Version</strong>: 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>In Keymaster 1, the curve used for EC keys was guessed from the specified key
size. To improve flexibility moving forward, Keymaster 2 introduced an explicit
way to specify curves. EC key generation requests may have
<code translate="no" dir="ltr">Tag::EC_CURVE</code>, <code translate="no" dir="ltr">Tag::KEY_SIZE</code>, or both.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class EcCurve : uint32_t {
    P_224 = 0,
    P_256 = 1,
    P_384 = 2,
    P_521 = 3,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class EcCurve : uint32_t {
    P_224 = 0,
    P_256 = 1,
    P_384 = 2,
P_521 = 3,
};
</pre>

<p>If a generation request only contains <code translate="no" dir="ltr">Tag::KEY_SIZE</code>,
fall back to the Keymaster 1 logic, choosing the appropriate NIST curve.</p>

<p>If the request only contains <code translate="no" dir="ltr">Tag::EC_CURVE</code>, use the
specified curve. For Keymaster 3 and later, curves are defined in
<code translate="no" dir="ltr">EcCurve</code>. For Keymaster 2 and earlier, curves are defined
in <code translate="no" dir="ltr">keymaster_ec_curve_t</code>.</p>

<p>If the request contains both, use the curve specified by
<code translate="no" dir="ltr">Tag::EC_CURVE</code>, and validate that the specified key size is
appropriate for that curve. If not, return
<code translate="no" dir="ltr">ErrorCode::INVALID_ARGUMENT</code>.</p>


<h2 id="include_unique_id">Tag::INCLUDE_UNIQUE_ID</h2>

<p><strong>Version</strong>: 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>This tag is specified during key generation to indicate that an attestation
certificate for the generated key should contain an application-scoped and
time-bounded device-unique ID, as specified by
<a href="#unique_id">Tag::UNIQUE_ID</a>.</p>

<p>This tag is boolean, so the possible values are true (if the tag is present)
and false (if the tag is not present).</p>

<h2 id="key_size">Tag::KEY_SIZE</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the size, in bits, of the key, measuring in the normal way for the
key's algorithm. For example, for RSA keys, <code translate="no" dir="ltr">Tag::KEY_SIZE</code> specifies
the size of the public modulus. For AES keys it specifies the length
of the secret key material.</p>
<aside class="note"><b>Note: </b>In Keymaster 2 and later, <code translate="no" dir="ltr">Tag::KEY_SIZE</code> is no longer the
preferred mechanism for selecting ECC (elliptic curve cryptography) curves.
While it is unchanged for other key types, ECC curves are selected using the
tag <a href="#ec_curve"><code translate="no" dir="ltr">Tag::EC_CURVE</code></a>.</aside>


<h2 id="mac_length">Tag::MAC_LENGTH</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides the requested length of a MAC or GCM authentication tag, in bits.</p>

<p>The value is the MAC length in bits. It is a multiple of 8 and at
least as large as the value of <a href="#min_mac_length">Tag::MIN_MAC_LENGTH</a>
associated with the key.</p>


<h2 id="max_uses_per_boot">Tag::MAX_USES_PER_BOOT</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the maximum number of times that a key may be used between system
reboots. This is another mechanism to rate-limit key use.</p>

<p>The value is a 32-bit integer representing uses per boot.</p>

<p>When a key with this tag is used in an operation, a key-associated counter
should be incremented during the
<a href="implementer-ref.html#begin">begin</a> call. After the key
counter has exceeded this value, all subsequent attempts to use the key fail
with <code translate="no" dir="ltr">ErrorCode::MAX_OPS_EXCEEDED</code>, until the device is restarted.
This implies that a trustlet keeps a table of use counters for keys with this
tag. Because Keymaster memory is often limited, this table can have a fixed
maximum size and Keymaster can fail operations that attempt to use keys with
this tag when the table is full. The table needs to acommodate at least 16 keys.
If an operation fails because the table is full, Keymaster returns
<code translate="no" dir="ltr">ErrorCode::TOO_MANY_OPERATIONS</code>.</p>


<h2 id="min_mac_length">Tag::MIN_MAC_LENGTH</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>This tag specifies the minimum length of MAC that can be requested or
 verified with this key for HMAC keys and AES keys that support GCM mode.</p>

<p>This value is the minimum MAC length, in bits. It is a multiple of 8. For
HMAC keys, the value is at least 64. For GCM keys, the value is at least 96
and no more than 128.</p>


<h2 id="min_seconds_between_ops">Tag::MIN_SECONDS_BETWEEN_OPS</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the minimum amount of time that elapses between allowed
operations using a key. This can be used to rate-limit uses of keys in contexts
where unlimited use may enable brute force attacks.</p>

<p>The value is a 32-bit integer representing seconds between allowed
operations.</p>

<p>When a key with this tag is used in an operation, start a timer
during the <a href="implementer-ref.html#finish">finish</a> or
<a href="implementer-ref.html#abort">abort</a> call. Any
call to <a href="implementer-ref.html#begin">begin</a> that is
received before the timer indicates that the interval specified by
<code translate="no" dir="ltr">Tag::MIN_SECONDS_BETWEEN_OPS</code> has elapsed fails with
<code translate="no" dir="ltr">ErrorCode::KEY_RATE_LIMIT_EXCEEDED</code>. This
implies that a trustlet keeps a table of use counters for keys with this tag.
Because Keymaster memory is often limited, this table can have a fixed maximum
size and Keymaster can fail operations that attempt to use keys with this tag
when the table is full. The table needs to acommodate at least 32 in-use
keys and aggressively reuse table slots when key minimum-usage intervals expire.
If an operation fails because the table is full, Keymaster returns
<code translate="no" dir="ltr">ErrorCode::TOO_MANY_OPERATIONS</code>.</p>


<h2 id="no_auth_required">Tag::NO_AUTH_REQUIRED</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies that no authentication is required to use this key. This tag is
mutually exclusive with <a href="#user_secure_id">Tag::USER_SECURE_ID</a>.</p>

<p>This tag is boolean, so the possible values are true (if the tag is present)
and false (if the tag is not present).</p>


<h2 id="nonce">Tag::NONCE</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Provides or returns a nonce or Initialization Vector (IV) for AES GCM, CBC,
or CTR encryption or decryption. This tag is provided to
<a href="implementer-ref.html#begin">begin</a>
during encryption and decryption operations. It is only provided to
<a href="implementer-ref.html#begin">begin</a>
if the key has <a href="#caller_nonce">Tag::CALLER_NONCE</a>. If not provided,
an appropriate nonce or IV will be randomly generated by
Keymaster and returned from begin.</p>

<p>The value is a blob, an arbitrary-length array of bytes. Allowed lengths
depend on the mode: GCM nonces are 12 bytes in length; CBC and CTR IVs are 16
bytes in length.</p>


<h2 id="origin">Tag::ORIGIN</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies where the key was created, if known. This tag may not be specified
during key generation or import, and must be added to the key characteristics
by the trustlet.</p>

<strong>Keymaster 3</strong>
<p>The possible values are defined in
<code translate="no" dir="ltr">android::hardware::keymaster::v3_0::KeyOrigin</code>:</p>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class KeyOrigin : uint32_t {
    GENERATED = 0,
    DERIVED = 1,
    IMPORTED = 2,
    UNKNOWN = 3,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<p>The possible values are defined in <code translate="no" dir="ltr">keymaster_origin_t</code>:</p>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_ORIGIN_GENERATED = 0,
    KM_ORIGIN_IMPORTED = 2,
    KM_ORIGIN_UNKNOWN = 3,
} keymaster_key_origin_t
</pre>

<p>The full meaning of the value depends not only on the value but on whether
it's found in the hardware-enforced or software-enforced characteristics list.
</p>

<p><code translate="no" dir="ltr">GENERATED</code> indicates that Keymaster generated the key.
If in the hardware-enforced list,
the key was generated in secure hardware and is permanently hardware bound. If
in the software-enforced list, the key was generated in SoftKeymaster and is
not hardware bound.</p>

<p><code translate="no" dir="ltr">DERIVED</code> indicates that the key was derived inside Keymaster.
Likely exists off-device.</p>

<p><code translate="no" dir="ltr">IMPORTED</code> indicates that the key was generated outside
of Keymaster and imported into
Keymaster. If in the hardware-enforced list, it is permanently hardware bound,
although copies outside of secure hardware may exist. If in the
software-enforces list, the key was imported into SoftKeymaster and is not
hardware bound.</p>

<p><code translate="no" dir="ltr">UNKNOWN</code> should only appear in the hardware-enforced list.
It indicates that the key is
hardware bound, but it is not known whether the key was originally generated in
secure hardware or was imported. This only occurs when keymaster0 hardware is
being used to emulate keymaster1 services.</p>


<h2 id="origination_expire_datetime">Tag::ORIGINATION_EXPIRE_DATETIME</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the date and time at which the key expires for signing and
encryption purposes. After this time, any attempt to use a key with
<a href="#purpose">KeyPurpose::SIGN</a> or
<a href="#purpose">KeyPurpose::ENCRYPT</a> provided
to <a href="implementer-ref.html#begin">begin</a> fails
with <code translate="no" dir="ltr">ErrorCode::KEY_EXPIRED</code>.</p>

<p>The value is a 64-bit integer representing milliseconds since
January 1, 1970.</p>


<h2 id="os_patchlevel">Tag::OS_PATCHLEVEL</h2>

<p><strong>Version</strong>: 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>This tag is never sent to the keymaster TA, but is added to the
hardware-enforced authorization list by the TA.</p>

<p>The value of the tag is an integer of the form YYYYMM, where YYYY is the
four-digit year of the last update and MM is the two-digit month of the last
update. For example, for a key generated on an Android device last updated in
December 2015, the value would be 201512.</p>

<p>Keys that have a patch level different than the current patch level are not
usable. An attempt to use such a key causes
<a href="implementer-ref.html#begin">begin</a>,
<a href="implementer-ref.html#get_key_characteristics">getKeyCharacteristics</a>,
or <a href="implementer-ref.html#export_key">exportKey</a>
to return <code translate="no" dir="ltr">ErrorCode::KEY_REQUIRES_UPGRADE</code>. See
<a href="version-binding.html">Version Binding</a> for more
details.</p>


<h2 id="os_version">Tag::OS_VERSION</h2>

<p><strong>Version</strong>: 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>This tag is never sent to the keymaster TA, but is added to the
hardware-enforced authorization list by the TA.</p>

<p>The value of the tag is an integer of the form MMmmss, where MM is the major
version number, mm is the minor version number, and ss is the sub-minor version
number. For example, for a key generated on Android version 4.0.3, the value
would be 040003.</p>


<h2 id="padding">Tag::PADDING</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? Yes</p>

<p>Specifies the padding modes that may be used with the key. This tag is
relevant to RSA and AES keys.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class PaddingMode : uint32_t {
    NONE = 1,
    RSA_OAEP = 2,
    RSA_PSS = 3,
    RSA_PKCS1_1_5_ENCRYPT = 4,
    RSA_PKCS1_1_5_SIGN = 5,
    PKCS7 = 64,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_PAD_NONE = 1,
    KM_PAD_RSA_OAEP = 2,
    KM_PAD_RSA_PSS = 3,
    KM_PAD_RSA_PKCS1_1_5_ENCRYPT = 4,
    KM_PAD_RSA_PKCS1_1_5_SIGN = 5,
    KM_PAD_PKCS7 = 64,
} keymaster_padding_t;
</pre>

<p><code translate="no" dir="ltr">PaddingMode::RSA_OAEP</code> and
<code translate="no" dir="ltr">PaddingMode::RSA_PKCS1_1_5_ENCRYPT</code> are used
only for RSA encryption/decryption keys and specify RSA PKCS#1v2 OAEP
padding and RSA PKCS#1 v1.5 randomized padding, respectively.
<code translate="no" dir="ltr">PaddingMode::RSA_PSS</code> and
<code translate="no" dir="ltr">PaddingMode::RSA_PKCS1_1_5_SIGN</code> are used only for RSA
signing/verification keys and specify RSA PKCS#1v2 PSS
padding and RSA PKCS#1 v1.5 deterministic padding, respectively.</p>

<aside class="note"><strong>Note</strong>: The RSA PSS padding mode is
incompatible with <a href="#digest">Digest::NONE</a>.</aside>

<p><code translate="no" dir="ltr">PaddingMode::NONE</code> may be used with either RSA or
AES keys. For AES keys, if <code translate="no" dir="ltr">PaddingMode::NONE</code> is used
with block mode ECB or CBC and the data to be encrypted or decrypted
is not a multiple of the AES block size in length, the call to finish
fails with <code translate="no" dir="ltr">ErrorCode::INVALID_INPUT_LENGTH</code>.</p>

<p><code translate="no" dir="ltr">PaddingMode::PKCS7</code> may only be used with AES keys, and
only with ECB and CBC modes.</p>

<p>This tag is repeatable. A padding mode must be specified in the call to
<a href="implementer-ref.html#begin">begin</a>.
If the specified mode is not authorized for the key, the operation fails
with <code translate="no" dir="ltr">ErrorCode::INCOMPATIBLE_BLOCK_MODE</code>.</p>


<h2 id="purpose">Tag::PURPOSE</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? Yes</p>

<p>Specifies the set of purposes for which the key may be used.</p>

<p>Possible values are defined by the following enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class KeyPurpose : uint32_t {
    ENCRYPT = 0,
    DECRYPT = 1,
    SIGN = 2,
    VERIFY = 3,
    DERIVE_KEY = 4,  // since 3.0
    WRAP_KEY = 5,    // since 3.0
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    KM_PURPOSE_ENCRYPT = 0,
    KM_PURPOSE_DECRYPT = 1,
    KM_PURPOSE_SIGN = 2,
    KM_PURPOSE_VERIFY = 3,
} keymaster_purpose_t;
</pre>

<p>This tag is repeatable; keys may be generated with multiple values,
although an operation has a single purpose. When the
<a href="implementer-ref.html#begin">begin</a> function is called
to start an operation, the purpose of the operation is specified.
If the purpose specified to the operation is not authorized by the
key, the operation fails with <code translate="no" dir="ltr">ErrorCode::INCOMPATIBLE_PURPOSE</code>.</p>


<h2 id="reset_since_id_rotation">Tag::RESET_SINCE_ID_ROTATION</h2>

<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>
<p>Specifies whether the device has been factory reset
since the last unique ID rotation. Used for key attestation.</p>

<p>This tag is boolean, so the possible values are true (if the tag is present)
and false (if the tag is not present).</p>


<h2 id="rollback_resistant">Tag::ROLLBACK_RESISTANT</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Indicates that the key is rollback-resistant, meaning that when deleted
by <a href="implementer-ref.html#delete_key">deleteKey</a> or
<a href="implementer-ref.html#delete_all_keys">deleteAllKeys</a>,
the key is guaranteed to be permanently deleted and unusable. It's possible
that keys without this tag could be deleted and then restored from backup.</p>

<p>This tag is boolean, so the possible values are true (if the tag is present)
and false (if the tag is not present).</p>


<h2 id="root_of_trust">Tag::ROOT_OF_TRUST</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>


<p>Specifies the <em>root of trust</em>, the key used by verified boot to
validate the operating system booted (if any). This tag is never provided
to or returned from Keymaster in the key characteristics.</p>

<h2 id="rsa_public_exponent">Tag::RSA_PUBLIC_EXPONENT</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the value of the public exponent for an RSA key pair. This tag is
relevant only to RSA keys, and necessary for all RSA keys.</p>

<p>The value is a 64-bit unsigned integer that satisfies the requirements of an
RSA public exponent. This value has to be a prime number. Trustlets support the
value 2^16+1 and may support other reasonable values, in particular the value 3.
If no exponent is specified or if the specified exponent is not supported,
key generation fails with <code translate="no" dir="ltr">ErrorCode::INVALID_ARGUMENT</code>.</p>


<h2 id="unique_id">Tag::UNIQUE_ID</h2>

<p><strong>Version</strong>: 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Used to provide unique ID in attestation.</p>
<p>The value is a blob, an arbitrary-length array of bytes.</p>


<h2 id="usage_expire_datetime">Tag::USAGE_EXPIRE_DATETIME</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the date and time at which the key expires for verification and
decryption purposes. After this time, any attempt to use a key with
<a href="#purpose">KeyPurpose::VERIFY</a> or
<a href="#purpose">KeyPurpose::DECRYPT</a> provided to
<a href="implementer-ref.html#begin">begin</a> fails
with <code translate="no" dir="ltr">ErrorCode::KEY_EXPIRED</code>.</p>

<p>The value is a 64-bit integer representing milliseconds since
January 1, 1970.</p>


<h2 id="user_auth_type">Tag::USER_AUTH_TYPE</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies the types of user authenticators that may be used to authorize this
key. When Keymaster is requested to perform an operation with a key with this
tag, it receives an authentication token, and the token's
<code translate="no" dir="ltr">authenticator_type</code> field needs to match the value in the tag.
For example, <code translate="no" dir="ltr">(ntoh(token.authenticator_type) &
auth_type_tag_value) != 0</code>, where <code translate="no" dir="ltr">ntoh</code> is a function that
converts network-ordered integers to host-ordered integers and
<code translate="no" dir="ltr">auth_type_tag_value</code> is the value of this tag.</p>

<p>The value is a 32-bit integer bitmask of values from the enumeration:</p>

<strong>Keymaster 3</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
enum class HardwareAuthenticatorType : uint32_t {
    NONE = 0u, // 0
    PASSWORD = 1 &lt;&lt; 0,
    FINGERPRINT = 1 &lt;&lt; 1,
    ANY = UINT32_MAX,
};
</pre>

<strong>Keymaster 2 and earlier</strong>
<pre class="devsite-click-to-copy" translate="no" dir="ltr">
typedef enum {
    HW_AUTH_NONE = 0,
    HW_AUTH_PASSWORD = 1 &lt;&lt; 0,
    HW_AUTH_FINGERPRINT = 1 &lt;&lt; 1,
    // Additional entries should be powers of 2.
    HW_AUTH_ANY = UINT32_MAX,
} hw_authenticator_type_t;
</pre>


<h2 id="user_secure_id">Tag::USER_SECURE_ID</h2>

<p><strong>Version</strong>: 1, 2, 3, 4</p>
<p><strong>Repeatable</strong>? No</p>

<p>Specifies that a key may only be used under a particular secure user
authentication state. This tag is mutually exclusive
with <a href="#no_auth_required">Tag::NO_AUTH_REQUIRED</a>.</p>

<p>The value is a 64-bit integer specifying the authentication policy state
value which needs to be present in an authentication token (provided to
<a href="implementer-ref.html#begin">begin</a> with
the <a href="#auth_token">Tag::AUTH_TOKEN</a>) to authorize use of the key. Any
call to <a href="implementer-ref.html#begin">begin</a>
with a key with this tag that does not provide an
authentication token, or provides an
authentication token without a matching policy state value, fails.</p>

<p>This tag is repeatable. If any of the provided values matches any policy
state value in the authentication token, the key is authorized for use.
Otherwise the operation fails with
<code translate="no" dir="ltr">ErrorCode::KEY_USER_NOT_AUTHENTICATED</code>.</p>

<h2 id="vendor_patchlevel">Tag::VENDOR_PATCHLEVEL</h2>
<p><strong>Version</strong>: 4</p>
<p>This tag specifies the vendor image security patch level with which the key
may be used. This tag is never sent to the keymaster TA, but is added to the
hardware-enforced authorization list by the TA. Any attempt to use a key with a
<code translate="no" dir="ltr">Tag::VENDOR_PATCHLEVEL</code> value different from the currently running
system patchlevel must cause <code translate="no" dir="ltr">begin()</code>,
<code translate="no" dir="ltr">getKeyCharacteristics()</code> or <code translate="no" dir="ltr">exportKey()</code> to return
<code translate="no" dir="ltr">ErrorCode::KEY_REQUIRES_UPGRADE</code>. See <code translate="no" dir="ltr">upgradeKey()</code>
for details.
</p>
<p>
The value of the tag is an integer of the form YYYYMMDD, where YYYY is the
four-digit year of the last update, MM is the two-digit month and DD is the
two-digit day of the last update. For example, for a key generated on an
Android device last updated on June 5, 2018, the value would be 20180605.</p>
<p>
The IKeymasterDevice HAL must read the current vendor patchlevel from the system
property <code translate="no" dir="ltr">ro.vendor.build.security_patch</code> and deliver it to the
secure environment when the HAL is first loaded (mechanism is
implementation-defined). The secure environment must not accept another
patchlevel until after the next boot.
</p>
<p>
Must be hardware-enforced.
</p>


          </div>

    
                   <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
                   
          </article>
</article>

<devsite-content-footer class="nocontent">
  <p>Content and code samples on this page are subject to the licenses described in the <a href="../../license.html">Content License</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
</devsite-content-footer>


                      </devsite-content>
        </div>
        <devsite-footer-promos class="devsite-footer">
                      
                  </devsite-footer-promos>
        <devsite-footer-linkboxes class="devsite-footer">
                      <nav class="devsite-footer-linkboxes nocontent">
  <ul class="devsite-footer-linkboxes-list">
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Build</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.googlesource.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android repository
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/requirements.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Requirements
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/downloading.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Downloading
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/blobs-preview/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Preview binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/images/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Factory images
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/drivers/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Driver binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.github.io/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            GitHub
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Connect</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/Android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            @Android on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/AndroidDev/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            @AndroidDev on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://blog.google/products/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Android Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://security.googleblog.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Google Security Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-platform/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Platform on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-building/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Building on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-porting/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Porting on Google Groups
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Get help</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/pixelphone/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Pixel Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/nexus/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Nexus Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            www.android.com
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/gms/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Google Mobile Services
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://stackoverflow.com/questions/tagged/android-source/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Stack Overflow
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://issuetracker.google.com/issues?q=status:open%20componentid:190923"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Issue Tracker
          </a>
        </li>
              </ul>
    </li>
      </ul>
</nav>
                  </devsite-footer-linkboxes>
        <devsite-footer-utility class="devsite-footer">
                      
<div class="devsite-footer-utility">
  
  <nav class="devsite-nav">
        <ul class="devsite-footer-utility-list">
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../source/index.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer About Android link">
          About Android
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../setup/community.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Community link">
          Community
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../legal.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Legal link">
          Legal
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../license.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer License link">
          License
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://policies.google.cn/privacy"
           data-category="Site-Wide Custom Events"
           data-label="Footer Privacy link">
          Privacy
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://issuetracker.google.com/issues/new?component=191476"
           data-category="Site-Wide Custom Events"
           data-label="Footer Site feedback link">
          Site feedback
        </a>
              </li>
          </ul>
    
    <devsite-language-selector>
  <devsite-select class="devsite-language-selector-menu">
    <select class="devsite-language-selector-select"
            name="language"
            track-name="click"
            track-type="languageSelector">
                <option>Language</option>
              <option value="en"
              track-metadata-original-language="en"
              track-metadata-selected-language="en"
              track-name="changed"
              track-type="languageSelector"
            >
        English
      </option>
          <option value="zh_cn"
              track-metadata-original-language="en"
              track-metadata-selected-language="zh_cn"
              track-name="changed"
              track-type="languageSelector"
            >
        中文 – 简体
      </option>
        </select>
  </devsite-select>
</devsite-language-selector>

  </nav>
</div>
                  </devsite-footer-utility>
      </div></div>
    <devsite-sitemask></devsite-sitemask>
    <devsite-snackbar                   ></devsite-snackbar>    <devsite-tooltip blocked-link></devsite-tooltip>
    <devsite-analytics>
              <script type="application/json" analytics>[{"metrics": {"ratings_value": "metric1", "ratings_count": "metric2"}, "dimensions": {}, "gaid": "UA-45455297-4"}]</script>
<script type="application/json" gtm>[]</script>
          </devsite-analytics>
        <script>
    (function(d,e,v,s,i,t,E){d['GoogleDevelopersObject']=i;
    t=e.createElement(v);t.async=1;t.src=s;E=e.getElementsByTagName(v)[0];
    E.parentNode.insertBefore(t,E);})(window, document, 'script',
    'https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/js/app_loader.js', '[7,"en",null,"../../js/devsite_app.html","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource","https://androidsource-dot-google-developers.gonglchuangl.net/",null,null,["/_pwa/androidsource/manifest.json","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/images/video-placeholder.svg","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/favicon.png","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg","https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons"]]')
  </script>  </body>

<!-- Mirrored from source.android.google.cn/security/keystore/tags by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Sep 2019 15:19:15 GMT -->
</html>