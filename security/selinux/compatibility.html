<!doctype html>
<html       lang="en"      dir="ltr">
  
<!-- Mirrored from source.android.google.cn/security/selinux/compatibility by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Sep 2019 15:01:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta property="og:site_name" content="Android Open Source Project">
    <meta property="og:type" content="website">
    
          <meta name="theme-color" content="#78c257">
    
    <meta charset="utf-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="../../_pwa/androidsource/manifest.json"
          crossorigin="use-credentials">
    <link rel="preconnect" href="http://www.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.gstatic.com/" crossorigin>
    <link rel="preconnect" href="http://fonts.googleapis.com/" crossorigin>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons">
        <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/css/rebrand-app.css">
    <noscript>
      <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/css/ce_bundle.css">
    </noscript>
    <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/favicon.png">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/touchicon-180.png"><link rel="canonical" href="compatibility.html">      
<title>Policy Compatibility &nbsp;|&nbsp; Android Open Source Project</title>

<meta property="og:title" content="Policy Compatibility &nbsp;|&nbsp; Android Open Source Project">


  <meta property="og:url" content="compatibility.html">

  <meta property="og:locale" content="en">




    
    
    
  
    </head>
  <body type="article"
        theme="androidsource-theme"
        class=""
        
        layout="docs"
        block-apix        pending>
    <devsite-progress type="indeterminate" id="app-progress"></devsite-progress>
    <div class="devsite-wrapper"><devsite-header keep-tabs-visible>
      









<div class="devsite-header--inner">
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu"
          class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Navigation menu button"
          visually-hidden
          aria-label="Close menu">
        </button>
        <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.cn/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
            <span class="devsite-product-name">
            <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                              </li>
  </ul>
          </span>
        
</div>        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
                          <devsite-tabs class="upper-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../setup.html"
   class="gc-analytics-event"
   title="Set up"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Set up"
   >
  Set up
</a>

        </tab>
                        <tab >
          <a href="../../compatibility.html"
   class="gc-analytics-event"
   title="Design"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Design"
   >
  Design
</a>

        </tab>
                        <tab active>
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Secure"
   aria-label="Secure, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Secure"
   >
  Secure
</a>

        </tab>
                        <tab >
          <a href="../../devices.html"
   class="gc-analytics-event"
   title="Develop"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Develop"
   >
  Develop
</a>

        </tab>
                        <tab >
          <a href="../../devices/tech.html"
   class="gc-analytics-event"
   title="Configure"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Configure"
   >
  Configure
</a>

        </tab>
                        <tab >
          <a href="../../reference.html"
   class="gc-analytics-event"
   title="Reference"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Reference"
   >
  Reference
</a>

        </tab>
            </div>
</devsite-tabs>

                       </div>
          <devsite-search
            enable-suggestions
              family-name="Android Open Source Project"    tenant-name="Android Open Source Project"            >
  <form class="devsite-search-form" action="https://source.android.google.cn/s/results" method="GET">
    <div class="devsite-search-container">
      <div class="devsite-searchbox">
                <input placeholder="Search"
          type="text"
          class="devsite-search-field devsite-search-query"
          name="q"
          value=""
          autocomplete="off"
                    aria-label="Search box">
        <div class="devsite-search-image material-icons" aria-hidden="true"></div>
      </div>
      <button type="button"
              search-open
              class="devsite-search-button devsite-header-icon-button button-flat material-icons"
              aria-label="Open search box"></button>
    </div>
  </form>
  <button type="button"
          search-close
          class="devsite-search-button devsite-header-icon-button button-flat material-icons"
          aria-label="Close search box"></button>
</devsite-search>

        </div>

        <devsite-language-selector>
  <devsite-select class="devsite-language-selector-menu">
    <select class="devsite-language-selector-select"
            name="language"
            track-name="click"
            track-type="languageSelector">
                <option>Language</option>
              <option value="en"
              track-metadata-original-language="en"
              track-metadata-selected-language="en"
              track-name="changed"
              track-type="languageSelector"
            >
        English
      </option>
          <option value="zh_cn"
              track-metadata-original-language="en"
              track-metadata-selected-language="zh_cn"
              track-name="changed"
              track-type="languageSelector"
            >
        中文 – 简体
      </option>
        </select>
  </devsite-select>
</devsite-language-selector>


                  <a class="devsite-header-link devsite-top-button button gc-analytics-event"
   href="http://android-review.googlesource.com/"
   data-category="Site-Wide Custom Events"
   data-label="Site header link">
  Go to code
</a>
        
              </div>    </div>  </div>
  <div class="devsite-collapsible-section
    ">
    <div class="devsite-header-background">
                        <div class="devsite-product-id-row">
            <div class="devsite-product-description-row">
                              <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                    <a href="../../security.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Lower Header"
              data-value="1"
          >
            Secure
      
  </a>
        </li>
  </ul>
                                        </div>
                                                                                    </div>
                                      <div class="devsite-doc-set-nav-row">
                              <devsite-tabs class="lower-tabs">
  <div class="devsite-tabs-wrapper">
                  <tab >
          <a href="../../security.html"
   class="gc-analytics-event"
   title="Overview"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Overview"
   >
  Overview
</a>

        </tab>
                        <tab >
          <a href="../bulletin.html"
   class="gc-analytics-event"
   title="Bulletins"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Bulletins"
   >
  Bulletins
</a>

        </tab>
                        <tab active>
          <a href="../features.html"
   class="gc-analytics-event"
   title="Features"
   aria-label="Features, selected"         data-category="Site-Wide Custom Events"
        data-label="Tab: Features"
   >
  Features
</a>

        </tab>
                        <tab >
          <a href="../../devices/tech/debug/fuzz-sanitize.html"
   class="gc-analytics-event"
   title="Testing"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Testing"
   >
  Testing
</a>

        </tab>
                        <tab >
          <a href="../best-practices.html"
   class="gc-analytics-event"
   title="Best Practices"
           data-category="Site-Wide Custom Events"
        data-label="Tab: Best Practices"
   >
  Best Practices
</a>

        </tab>
            </div>
</devsite-tabs>

        </div>
          </div>  </div></div>
  

  </devsite-header>      <devsite-book-nav scrollbars >
                  




<nav class="devsite-book-nav devsite-nav nocontent">
  <div class="devsite-mobile-header">
    <button type="button"
            id="devsite-close-nav"
            class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
            data-category="Site-Wide Custom Events"
            data-label="Close navigation"
            aria-label="Close navigation">
    </button>
    <div class="devsite-product-name-wrapper">
  <a href="../../index.html" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo">
  <img src="https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg" class="devsite-site-logo" alt="Android Open Source Project">
</a>
        <span class="devsite-product-name">
        <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                              </li>
  </ul>
      </span>
    
</div>  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
              <ul class="devsite-nav-list">
                      <li class="devsite-nav-item">
                                <a href="../../setup.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Set up">
      <span class="devsite-nav-text" >Set up</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../compatibility.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Design">
      <span class="devsite-nav-text" >Design</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            devsite-nav-active"
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Secure">
      <span class="devsite-nav-text" >Secure</span>
        </a>
  
                                            <ul class="devsite-nav-responsive-tabs">
                                                                                                                      <li class="devsite-nav-item">
    <a href="../../security.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Overview">
      <span class="devsite-nav-text" >Overview</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../bulletin.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Bulletins">
      <span class="devsite-nav-text" >Bulletins</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../features.html"
     id="devsite-nav-forward"     class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Features">
      <span class="devsite-nav-text" menu="_book">Features</span>
        <span class="devsite-nav-icon material-icons" data-icon="forward" aria-hidden="true"
          menu="_book">
    </span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../../devices/tech/debug/fuzz-sanitize.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Testing">
      <span class="devsite-nav-text" >Testing</span>
        </a>
  </li>

                                                                                                                      <li class="devsite-nav-item">
    <a href="../best-practices.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Best Practices">
      <span class="devsite-nav-text" >Best Practices</span>
        </a>
  </li>

                                  </ul>
                          </li>
                      <li class="devsite-nav-item">
                                <a href="../../devices.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Develop">
      <span class="devsite-nav-text" >Develop</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../devices/tech.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Configure">
      <span class="devsite-nav-text" >Configure</span>
        </a>
  
                                        </li>
                      <li class="devsite-nav-item">
                                <a href="../../reference.html"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Reference">
      <span class="devsite-nav-text" >Reference</span>
        </a>
  
                                        </li>
                                <li class="devsite-nav-item">
    <a href="http://android-review.googlesource.com/"
          class="devsite-nav-title gc-analytics-event
            "
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Go to code">
      <span class="devsite-nav-text" >Go to code</span>
        </a>
  </li>

                  </ul>
          </div>
          <div class="devsite-mobile-nav-bottom">
                            <ul class="devsite-nav-list" menu="_book">
            <li class="devsite-nav-item"><a href="../features.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li>
  <li class="devsite-nav-item"><a href="../app-sandbox.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Application Sandbox">Application Sandbox</span></a></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Application Signing">Application Signing</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../apksigning.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../apksigning/v2.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="APK Signature Scheme v2">APK Signature Scheme v2</span></a></li><li class="devsite-nav-item"><a href="../apksigning/v3.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="APK Signature Scheme v3">APK Signature Scheme v3</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Authentication">Authentication</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../authentication.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../authentication/gatekeeper.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Gatekeeper">Gatekeeper</span></a></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Biometrics">Biometrics</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../biometric.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../biometric/measure.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Measuring Biometric Security">Measuring Biometric Security</span></a></li><li class="devsite-nav-item"><a href="../authentication/fingerprint-hal.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Fingerprint HIDL">Fingerprint HIDL</span></a></li><li class="devsite-nav-item"><a href="../biometric/face-authentication.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Face Authentication HIDL">Face Authentication HIDL</span></a></li></ul></devsite-expandable-nav></li><li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Protected Confirmation">Protected Confirmation</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../protected-confirmation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/implementation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementation">Implementation</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/design.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Design Guidelines">Design Guidelines</span></a></li><li class="devsite-nav-item"><a href="../protected-confirmation/accessibility.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Accessibility">Accessibility</span></a></li></ul></devsite-expandable-nav></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Encryption">Encryption</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../encryption.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../encryption/file-based.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="File-Based Encryption">File-Based Encryption</span></a></li><li class="devsite-nav-item"><a href="../encryption/full-disk.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Full-Disk Encryption">Full-Disk Encryption</span></a></li><li class="devsite-nav-item"><a href="../encryption/metadata.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Metadata Encryption">Metadata Encryption</span></a></li><li class="devsite-nav-item"><a href="../encryption/adiantum.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Enabling Adiantum">Enabling Adiantum</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Keystore">Keystore</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../keystore.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../keystore/features.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Features">Features</span></a></li><li class="devsite-nav-item"><a href="../keystore/attestation.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Key Attestation">Key Attestation</span></a></li><li class="devsite-nav-item"><a href="../keystore/version-binding.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Version Binding">Version Binding</span></a></li><li class="devsite-nav-item"><a href="../keystore/tags.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Authorization Tags">Authorization Tags</span></a></li><li class="devsite-nav-item"><a href="../keystore/implementer-ref.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Functions">Functions</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="SELinux">SELinux</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../selinux.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="concepts.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Concepts">Concepts</span></a></li><li class="devsite-nav-item"><a href="implement.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementation">Implementation</span></a></li><li class="devsite-nav-item"><a href="customize.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Customization">Customization</span></a></li><li class="devsite-nav-item"><a href="build.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Building sepolicy">Building sepolicy</span></a></li><li class="devsite-nav-item"><a href="compatibility.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Compatibility">Compatibility</span></a></li><li class="devsite-nav-item"><a href="validate.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Validation">Validation</span></a></li><li class="devsite-nav-item"><a href="device-policy.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Writing Policy">Writing Policy</span></a></li><li class="devsite-nav-item"><a href="vendor-init.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Vendor init">Vendor init</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Trusty TEE">Trusty TEE</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../trusty.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../trusty/download-and-build.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Download and Build">Download and Build</span></a></li><li class="devsite-nav-item"><a href="../trusty/trusty-ref.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Trusty API Reference">Trusty API Reference</span></a></li></ul></devsite-expandable-nav></li>
  <li class="devsite-nav-item           devsite-nav-expandable"><devsite-expandable-nav collapsed>
    <a class="devsite-nav-toggle" aria-hidden="true"></a><div class="devsite-nav-title devsite-nav-title-no-path" tabindex="0"><span class="devsite-nav-text" title="Verified Boot">Verified Boot</span></div><ul class="devsite-nav-section"><li class="devsite-nav-item"><a href="../verifiedboot.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Overview">Overview</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/device-state.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Device State">Device State</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/verified-boot.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Verifying Boot">Verifying Boot</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/boot-flow.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Boot Flow">Boot Flow</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/dm-verity.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Implementing dm-verity">Implementing dm-verity</span></a></li><li class="devsite-nav-item"><a href="../verifiedboot/avb.html"
     class="devsite-nav-title"
   ><span class="devsite-nav-text" title="Reference Implementation">Reference Implementation</span></a></li></ul></devsite-expandable-nav></li>
          </ul>
                                                                                                                                                                            </div>
      </div>
</nav>
              </devsite-book-nav>
      <div id="gc-wrapper">
        <div class="devsite-main-content"
            has-book-nav            has-toc>
          <devsite-toc class="devsite-nav"
            ></devsite-toc>
          <devsite-content>
                          

<article class="devsite-article">
  <article class="devsite-article-inner">        
    <div class="devsite-article-meta">
      <ul class="devsite-breadcrumb-list">
    <li class="devsite-breadcrumb-item
             ">
                    <a href="../../index.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="1"
          >
            AOSP
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item
             ">
                <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
                    <a href="../../security.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="2"
          >
            Secure
      
  </a>
        </li>
    <li class="devsite-breadcrumb-item
             ">
                <div class="devsite-breadcrumb-guillemet material-icons" aria-hidden="true"></div>
                    <a href="../features.html"              class="devsite-breadcrumb-link gc-analytics-event"
              data-category="Site-Wide Custom Events"
              data-label="Breadcrumbs"
              data-value="3"
          >
            Features
      
  </a>
        </li>
  </ul>
               <devsite-page-rating position="header" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
          </div>

              <h1 class="devsite-page-title">Policy Compatibility</h1>
    
    <devsite-toc class="devsite-nav" devsite-toc-embedded >
    </devsite-toc>

    <div class="devsite-article-body clearfix
      ">

              
  <!--
      Copyright 2018 The Android Open Source Project

      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at

          //www.apache.org/licenses/LICENSE-2.0

      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
  -->

<p>
This article describes how Android handles the policy compatibility issues
with platform OTAs, where new platform SELinux settings may differ from old vendor
SELinux settings.
</p>
<p>
Treble-based SELinux policy design considers a binary distinction
between <em>platform</em> and <em>vendor</em> policy; the scheme becomes
more complicated if vendor partitions generate dependencies, such as
<code translate="no" dir="ltr">platform</code> &lt; <code translate="no" dir="ltr">vendor</code> &lt; <code translate="no" dir="ltr">oem</code>.
</p>
<p>
In Android 8.0 and higher, SELinux global policy is divided into private and
public components. Public components consist of the policy and associated
infrastructure, which are guaranteed to be available for a platform version.
This policy will be exposed to vendor policy writers to enable vendors to build
a vendor policy file, which when combined with the platform-provided policy,
results in a fully-functional policy for a device.
</p>

<ul>
  <li>For versioning, the exported platform-public policy will be written as
    <em>attributes</em>.</li>
  <li>For ease of policy writing, exported types will be transformed into
    <em>versioned attributes</em> as part of the policy build process. Public
    types may also be used directly in labeling decisions provided by vendor
    contexts files.</li>
</ul>

<p>
<strong>Android maintains a mapping between exported concrete types in platform
policy and the corresponding versioned attributes for each platform
version</strong>. This ensures that when objects are labeled with a type, it
does not break behavior guaranteed by the platform-public policy in a previous
version. This mapping is maintained by keeping a mapping file up-to-date for
<a href="https://android.googlesource.com/platform/system/sepolicy/+/master/prebuilts/api" class="external">
each platform version</a>, which keeps attribute membership information for each
type exported in public policy.
</p>

<h2 id="object-ownership-and-labeling">Object ownership and labeling</h2>
<p>
When customizing policy in Android 8.0 and higher, ownership must be clearly defined
for each object to keep platform and vendor policy separate. For example, if
the vendor labels <code translate="no" dir="ltr">/dev/foo</code> and the platform then labels
<code translate="no" dir="ltr">/dev/foo</code> in a subsequent OTA, there will be undefined behavior. For
SELinux, this manifests as a labeling collision. The device node can have only a
single label which resolves to whichever label is applied last. As a result:
</p>

<ul>
  <li>Processes that <em>need access</em> to the unsuccessfully applied label will
  lose access to the resource.</li>
  <li>Processes that <em>gain access</em> to the file may break because the wrong
  device node was created.</li>
</ul>

<p>
System properties also have potential for naming collisions that could result in
undefined behavior on the system (as well as for SELinux labeling). Collisions
between platform and vendor labels can occur for any object that has an SELinux
label, including properties, services, processes, files, and sockets. To avoid
these issues, clearly define ownership of these objects.
</p>
<p>
In addition to label collisions, SELinux type/attribute names may also collide.
A type/attribute name collision will always result in a policy compiler error.
</p>

<h3 id="type-attribute-namespacing">Type/attribute namespacing</h3>
<p>
SELinux does not allow multiple declarations of the same type/attribute. Policy
with duplicate declarations will fail to compilation. To avoid type and
attribute name collisions, all vendor declarations should be namespaced
starting with <code translate="no" dir="ltr">np_</code>.
</p>


<pre
class="prettyprint" translate="no" dir="ltr">type foo, domain; → type np_foo, domain;</pre>

<h3 id="system-property-and-ownership">System property and
process labeling ownership</h3>
<p>
Avoiding labeling collisions is best solved using property namespaces. To
easily identify platform properties and avoid name conflicts when renaming or
adding exported-platform properties, ensure all vendor properties have their
own prefixes:
</p>
<table>
  <tr>
   <th>Property type</th>
   <th>Acceptable prefixes</th>
  </tr>
  <tr>
   <td>read-writable</td>
   <td><code translate="no" dir="ltr">vendor.</code></td>
  </tr>
  <tr>
   <td>read-only</td>
   <td><code translate="no" dir="ltr">ro.vendor.</code><br>
       <code translate="no" dir="ltr">ro.boot.</code><br>
       <code translate="no" dir="ltr">ro.hardware.</code>
   </td>
  </tr>
  <tr>
   <td>persistent</td>
   <td><code translate="no" dir="ltr">persist.vendor.</code></td>
  </tr>
</table>
<p>
Vendors can continue to use <code translate="no" dir="ltr">ro.boot.*</code> (which comes from the kernel
cmdline) and <code translate="no" dir="ltr">ro.hardware.*</code> (an obvious hardware-related property).
</p>
<p>
All the vendor services in init rc files should have <code translate="no" dir="ltr">vendor.</code>
for  services in init rc files of non-system partitions. Similar rules are
applied to the SELinux labels for the vendor properties (<code translate="no" dir="ltr">vendor_</code>
for the vendor properties).
</p>

<h3 id="file-ownership">File ownership</h3>
<p>
Preventing collisions for files is challenging because platform and vendor
policy both commonly provide labels for all filesystems. Unlike type naming,
namespacing of files is not practical since many of them are created by the
kernel. To prevent these collisions, follow the naming guidance for filesystems
in this section. For Android 8.0, these are recommendations without technical
enforcement. In the future, these recommendations will be enforced by the
<a href="../../compatibility/vts/index.html">Vendor Test Suite</a> (VTS).
</p>
<h4 id="system">System (/system)</h4>
<p>
Only the system image must provide labels for <code translate="no" dir="ltr">/system</code> components
through <code translate="no" dir="ltr">file_contexts</code>, <code translate="no" dir="ltr">service_contexts</code>, etc. If labels
for <code translate="no" dir="ltr">/system</code> components are added in <code translate="no" dir="ltr">/vendor</code> policy, a
framework-only OTA update may not be possible.
</p>
<h4 id="vendor">Vendor (/vendor)</h4>
<p>
The AOSP SELinux policy already labels parts of <code translate="no" dir="ltr">vendor</code> partition
the platform interacts with, which enables writing SELinux rules for platform
processes to be able to talk and/or access parts of <code translate="no" dir="ltr">vendor</code>
partition. Examples:
</p>

<table>
  <tr>
    <th><code translate="no" dir="ltr">/vendor</code> path</th>
   <th>Platform-provided label</th>
   <th>Platform processes depending on the label</th>
  </tr>
  <tr>
   <td><code translate="no" dir="ltr">/vendor(/.<strong>*</strong>)?</code>
   </td>
   <td><code translate="no" dir="ltr">vendor_file</code>
   </td>
   <td>All HAL clients in framework, <code translate="no" dir="ltr">ueventd</code>, etc.
   </td>
  </tr>
  <tr>
   <td><code translate="no" dir="ltr">/vendor/framework(/.<strong>*</strong>)?</code>
   </td>
   <td><code translate="no" dir="ltr">vendor_framework_file</code>
   </td>
   <td><code translate="no" dir="ltr">dex2oat</code>, <code translate="no" dir="ltr">appdomain</code>, etc.
   </td>
  </tr>
  <tr>
   <td><code translate="no" dir="ltr">/vendor/app(/.<strong>*</strong>)?</code>
   </td>
   <td><code translate="no" dir="ltr">vendor_app_file</code>
   </td>
   <td><code translate="no" dir="ltr">dex2oat</code>, <code translate="no" dir="ltr">installd</code>, <code translate="no" dir="ltr">idmap</code>, etc.
   </td>
  </tr>
  <tr>
   <td><code translate="no" dir="ltr">/vendor/overlay(/.<strong>*</strong>)</code>
   </td>
   <td><code translate="no" dir="ltr">vendor_overlay_file</code>
   </td>
   <td><code translate="no" dir="ltr">system_server</code>, <code translate="no" dir="ltr">zygote</code>, <code translate="no" dir="ltr">idmap</code>, etc.
   </td>
  </tr>
</table>

<aside class="note">
  <strong>*</strong> For more examples, see
<a href="https://android.googlesource.com/platform/system/sepolicy/+/master/private/file_contexts" class="external">
  <code translate="no" dir="ltr">system/sepolicy/private/file_contexts</code></a>.</aside>

<p>
As a result, specific rules must be followed (enforced through
<code translate="no" dir="ltr">neverallows</code>) when labelling additional files in <code translate="no" dir="ltr">vendor</code>
partition:
</p>

<ul>
  <li><code translate="no" dir="ltr">vendor_file </code>must be the default label for all files in
    <code translate="no" dir="ltr">vendor</code> partition. The platform policy requires this to access
    passthrough HAL implementations.</li>
  <li>All new <code translate="no" dir="ltr">exec_types</code> added in <code translate="no" dir="ltr">vendor</code> partition
    through vendor SEPolicy must have <code translate="no" dir="ltr">vendor_file_type</code> attribute. This
    is enforced through neverallows.</li>
  <li>To avoid conflicts with future platform/framework updates, avoid labelling
    files other than <code translate="no" dir="ltr">exec_types</code> in <code translate="no" dir="ltr">vendor</code> partition.</li>
  <li>All library dependencies for AOSP-identified same process HALs must be
    labelled as <code translate="no" dir="ltr">same_process_hal_file.</code></li>
</ul>

<h4 id="procfs">Procfs (/proc)</h4>
<p>
Files in <code translate="no" dir="ltr">/proc</code> may be labeled using only the <code translate="no" dir="ltr">genfscon</code>
label. In Android 7.0, both the
<a href="https://android.googlesource.com/platform/system/sepolicy/+/nougat-dr1-release/genfs_contexts" class="external">platform</a>
and <a
href="https://android.googlesource.com/device/google/marlin/+/nougat-dr1-release/sepolicy/genfs_contexts" class="external">vendor</a>
policy used <code translate="no" dir="ltr">genfscon</code> to label files in <code translate="no" dir="ltr">procfs</code>.
</p>
<p>
<strong>Recommendation:</strong> Only platform policy labels <code translate="no" dir="ltr">/proc</code>.
If <code translate="no" dir="ltr">vendor</code> processes need access to files in <code translate="no" dir="ltr">/proc</code> that
are currently labeled with the default label (<code translate="no" dir="ltr">proc</code>), vendor policy
should not explicitly label them and should instead use the generic
<code translate="no" dir="ltr">proc</code> type to add rules for vendor domains. This allows the platform
updates to accommodate future kernel interfaces exposed through
<code translate="no" dir="ltr">procfs</code> and label them explicitly as needed.
</p>

<h4 id="debugfs">Debugfs (/sys/kernel/debug)</h4>
<p>
<code translate="no" dir="ltr">Debugfs</code> can be labeled in both <code translate="no" dir="ltr">file_contexts</code> and
<code translate="no" dir="ltr">genfscon</code>. In Android 7.0, both platform and vendor label
<code translate="no" dir="ltr">debugfs</code>.
</p>
<p>
<strong>Recommendation:</strong> In the short term, only vendor policy may label
<code translate="no" dir="ltr">debugfs</code>. In the long term, remove <code translate="no" dir="ltr">debugfs</code>.
</p>
<h4 id="tracefs">Tracefs
(/sys/kernel/debug/tracing)</h4>
<p>
<code translate="no" dir="ltr">Tracefs</code> can be labeled in both <code translate="no" dir="ltr">file_contexts</code> and
<code translate="no" dir="ltr">genfscon</code>. In Android 7.0, only the platform labels
<code translate="no" dir="ltr">tracefs</code>.
</p>
<p>
<strong>Recommendation:</strong> Only platform may label <code translate="no" dir="ltr">tracefs</code>.
</p>

<h4 id="sysfs">Sysfs (/sys)</h4>
<p>
Files in <code translate="no" dir="ltr">/sys</code> may be labeled using both <code translate="no" dir="ltr">file_contexts</code>
and <code translate="no" dir="ltr">genfscon</code>. In Android 7.0, both platform and vendor use
<code translate="no" dir="ltr">file_contexts</code> and <code translate="no" dir="ltr">genfscon</code> to label files in
<code translate="no" dir="ltr">sysfs</code>.
</p>
<p>
<strong>Recommendation:</strong> The platform may label <code translate="no" dir="ltr">sysfs</code>
nodes that are not device-specific. Otherwise, only vendor may label files.
</p>

<h4 id="tmpfs">tmpfs (/dev)</h4>
<p>
Files in <code translate="no" dir="ltr">/dev</code> may be labeled in <code translate="no" dir="ltr">file_contexts</code>. In
Android 7.0, both platform and vendor label files here.
</p>
<p>
<strong>Recommendation:</strong> Vendor may label only files in
<code translate="no" dir="ltr">/dev/vendor</code> (e.g., <code translate="no" dir="ltr">/dev/vendor/foo</code>,
<code translate="no" dir="ltr">/dev/vendor/socket/bar</code>).
</p>

<h4 id="rootfs">Rootfs (/)</h4>
<p>
Files in <code translate="no" dir="ltr">/</code> may be labeled in <code translate="no" dir="ltr">file_contexts</code>. In Android
7.0, both platform and vendor label files here.
</p>
<p>
<strong>Recommendation:</strong> Only system may label files in <code translate="no" dir="ltr">/</code>.
</p>

<h4 id="data-data">Data (/data)</h4>
<p>
Data is labeled through a combination of <code translate="no" dir="ltr">file_contexts</code> and
<code translate="no" dir="ltr">seapp_contexts</code>.
</p>
<p>
<strong>Recommendation:</strong> Disallow vendor labeling outside
<code translate="no" dir="ltr">/data/vendor</code>. Only platform may label other parts of
<code translate="no" dir="ltr">/data</code>.
</p>

<h2 id="compatibility-attributes">Compatibility attributes</h2>
<p>
SELinux policy is an interaction between source and target types for specific
object classes and permissions. Every object (processes, files, etc.) affected
by SELinux policy may have only one type, but that type may have multiple
attributes.
</p>
<p>
Policy is written mostly in terms of existing types:
</p>


<pre
class="prettyprint" translate="no" dir="ltr">allow source_type target_type:target_class permission(s);</pre>
<p>
This works because the policy was written with knowledge of all types. However,
if the vendor policy and platform policy use specific types, and the label of a
specific object changes in only one of those policies, the other may contain
policy that gained or lost access previously relied upon. For example:
</p>


<pre class="prettyprint" translate="no" dir="ltr">File_contexts:
/sys/A   u:object_r:sysfs:s0
Platform: allow p_domain sysfs:class perm;
Vendor: allow v_domain sysfs:class perm;</pre>
<p>
Could be changed to:
</p>


<pre class="prettyprint" translate="no" dir="ltr">File_contexts:
/sys/A   u:object_r:sysfs_A:s0</pre>
<p>
Although the vendor policy would remain the same, the <code translate="no" dir="ltr">v_domain</code>
would lose access due to the lack of policy for the new <code translate="no" dir="ltr">sysfs_A</code>
type.
</p>
<p>
By defining a policy in terms of attributes, we can give the underlying object a
type that has an attribute corresponding to policy for both the platform and
vendor code. This can be done for all types to effectively create an
<em>attribute-policy</em> wherein concrete types are never used. In practice,
this is required only for the portions of policy that overlap between platform
and vendor, which are defined and provided as <em>platform public policy</em>
that gets built as part of the vendor policy.
</p>
<p>
Defining public policy as versioned attributes satisfies two policy
compatibility goals:
</p>

<ul>
  <li><strong>Ensure vendor code continues to work after platform update</strong>.
    Achieved by adding attributes to concrete types for objects corresponding to
    those on which vendor code relied, preserving access.</li>
  <li><strong>Ability to deprecate policy</strong>. Achieved by clearly
    delineating policy sets into attributes that can be removed as soon as the
    version to which they correspond no longer is supported. Development can
    continue in the platform, knowing the old policy is still present in the
    vendor policy and will be automatically removed when/if it upgrades.</li>
</ul>

<h3 id="policy-writability">Policy writability</h3>
<p>
To meet the goal of not requiring knowledge of specific version changes for
policy development, Android 8.0 includes a mapping between platform-public
policy types and their attributes. Type <code translate="no" dir="ltr">foo</code> is mapped
to attribute <code translate="no" dir="ltr">foo_v<em>N</em></code>, where <code translate="no" dir="ltr"><em>N</em></code> is the
version targeted. <code translate="no" dir="ltr">vN</code> corresponds to the
<code translate="no" dir="ltr">PLATFORM_SEPOLICY_VERSION</code> build variable and is of the form
<code translate="no" dir="ltr">MM.NN</code>, where <code translate="no" dir="ltr">MM</code> corresponds to the platform SDK number
and <code translate="no" dir="ltr">NN</code> is a platform sepolicy specific version.
</p>
<p>
Attributes in public policy are not versioned, but rather exist as an API on
which platform and vendor policy can build to keep the interface between the two
partitions stable. Both platform and vendor policy writers can continue to write
policy as it is written today.
</p>
<p>
Platform-public policy exported as <code translate="no" dir="ltr">allow source_foo target_bar:<em>class
perm</em>;</code>is included as part of the vendor policy. During
<a href="build.html">compilation</a> (which includes the
corresponding version) it is transformed into the policy that will go to the
vendor portion of the device (shown in the transformed Common Intermediate
Language (CIL)):
</p>

<pre
class="prettyprint" translate="no" dir="ltr"> (allow source_foo_vN target_bar_vN (class (perm)))</pre>
<p>
As vendor policy is never ahead of the platform, it should not be concerned with
prior versions. However, platform policy will need to know how far back vendor
policy is, include attributes to its types, and set policy corresponding to
versioned attributes.
</p>

<h3 id="policy-diffs">Policy diffs</h3>
<p>
Automatically creating attributes by adding <code translate="no" dir="ltr">_v<em>N</em></code> to the end
of each type does nothing without mapping of attributes to types across version
diffs. Android  maintains a mapping between versions for attributes and a
mapping of types to those attributes. This is done in the aforementioned mapping
files with statements, such as (CIL):
</p>

<pre class="prettyprint" translate="no" dir="ltr">(typeattributeset foo_vN (foo))</pre>

<h4 id="platform-upgrades">Platform upgrades</h4>
<p>
The following section details scenarios for platform upgrades.
</p>

<h5 id="same-types">Same types</h5>
<p>
This scenario occurs when an object does not change labels in policy versions.
This is the same for source and target types and can be seen with
<code translate="no" dir="ltr">/dev/binder</code>, which is labeled <code translate="no" dir="ltr">binder_device</code> across all
releases. It is represented in transformed policy as:
</p>


<pre class="prettyprint" translate="no" dir="ltr">binder_device_v1 … binder_device_vN</pre>
<p>
When upgrading from <code translate="no" dir="ltr">v1</code> → <code translate="no" dir="ltr">v2</code>, the platform policy must
contain:
</p>


<pre
class="prettyprint" translate="no" dir="ltr">type binder_device; -&gt; (type binder_device) (in CIL)</pre>
<p>
In the v1 mapping file (CIL):
</p>


<pre
class="prettyprint" translate="no" dir="ltr">(typeattributeset binder_device_v1 (binder_device))</pre>
<p>
In the v2 mapping file (CIL):
</p>


<pre
class="prettyprint" translate="no" dir="ltr">(typeattributeset binder_device_v2 (binder_device))</pre>
<p>
In the v1 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute binder_device_v1)
(allow binder_device_v1 …)</pre>
<p>
In the v2 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute binder_device_v2)
(allow binder_device_v2 …)</pre>
<h5 id="new-types">New types</h5>
<p>
This scenario occurs when the platform has added a new type, which can happen
when adding new features or during policy hardening.
</p>

<ul>
  <li><strong>New feature</strong>. When the type is labeling an object that was
    previously non-existent (such as a new service process), the vendor code did not
    previously interact with it directly so no corresponding policy exists. The new
    attribute corresponding to the type does not have an attribute in the previous
    version, and so would not need an entry in the mapping file targeting that
    version.</li>
  <li><strong>Policy hardening</strong>. When the type represents policy
    hardening, the new type attribute must link back to a chain of attributes
    corresponding to the previous one (similar to the previous example changing
    <code translate="no" dir="ltr">/sys/A</code> from <code translate="no" dir="ltr">sysfs</code> to <code translate="no" dir="ltr">sysfs_A</code>). Vendor
    code relies on a rule enabling access to <code translate="no" dir="ltr">sysfs</code>, and needs
    to include that rule as an attribute of the new type.</li>
</ul>

<p>
When upgrading from <code translate="no" dir="ltr">v1</code> → <code translate="no" dir="ltr">v2</code>, the platform policy must
contain:
</p>


<pre
class="prettyprint" translate="no" dir="ltr">type sysfs_A; -&gt; (type sysfs_A) (in CIL)
type sysfs; (type sysfs) (in CIL)</pre>
<p>
In the v1 mapping file (CIL):
</p>


<pre
class="prettyprint" translate="no" dir="ltr">(typeattributeset sysfs_v1 (sysfs sysfs_A))</pre>
<p>
In the v2 mapping file (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattributeset sysfs_v2 (sysfs))
(typeattributeset sysfs_A_v2 (sysfs_A))</pre>
<p>
In the v1 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute sysfs_v1)
(allow … sysfs_v1 …)</pre>
<p>
In the v2 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute sysfs_A_v2)
(allow … sysfs_A_v2 …)
(typeattribute sysfs_v2)
(allow … sysfs_v2 …)</pre>

<h5 id="removed-types">Removed types</h5>
<p>
This (rare) scenario occurs when a type is removed, which can happen when the
underlying object:
</p>

<ul>
  <li>Remains but gets a different label.</li>
  <li>Is removed by the platform.</li>
</ul>

<p>
During policy loosening, a type is removed and the object labeled with that type
is given a different, already-existing label. This represents a merging of
attribute mappings: The vendor code must still be able to access the underlying
object by the attribute it used to possess, but the rest of the system must now
be able to access it with its new attribute.
</p>
<p>
If the attribute to which it has been switched is new, then relabeling is the
same as in the new type case, except that when an existing label is used, the
addition of the old attribute new type would cause other objects also labeled
with this type to be newly accessible. This is essentially what is done by the
platform and is deemed to be an acceptable tradeoff to maintain
compatibility.
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute sysfs_v1)
(allow … sysfs_v1 …)</pre>
<p>
<strong>Example Version 1: Collapsing types (removing sysfs_A)</strong>
</p>
<p>
When upgrading from <code translate="no" dir="ltr">v1</code> → <code translate="no" dir="ltr">v2</code>, the platform policy must
contain:
</p>


<pre
class="prettyprint" translate="no" dir="ltr">type sysfs; (type sysfs) (in CIL)</pre>
<p>
In the v1 mapping file (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattributeset sysfs_v1 (sysfs))
(type sysfs_A) # in case vendors used the sysfs_A label on objects
(typeattributeset sysfs_A_v1 (sysfs sysfs_A))</pre>
<p>
In the v2 mapping file (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattributeset sysfs_v2 (sysfs))</pre>
<p>
In the v1 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute sysfs_A_v1)
(allow … sysfs_A_v1 …)
(typeattribute sysfs_v1)
(allow … sysfs_v1 …)</pre>
<p>
In the v2 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute sysfs_v2)
(allow … sysfs_v2 …)</pre>
<p>
<strong>Example Version 2: Removing completely (foo type)</strong>
</p>
<p>
When upgrading from <code translate="no" dir="ltr">v1</code> → <code translate="no" dir="ltr">v2</code>, the platform policy must
contain:
</p>


<pre
class="prettyprint" translate="no" dir="ltr"># nothing - we got rid of the type</pre>
<p>
In the v1 mapping file (CIL):
</p>


<pre
class="prettyprint" translate="no" dir="ltr">(type foo) #needed in case vendors used the foo label on objects
(typeattributeset foo_v1 (foo))</pre>
<p>
In the v2 mapping file (CIL):
</p>


<pre
class="prettyprint" translate="no" dir="ltr"># nothing - get rid of it</pre>
<p>
In the v1 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute foo_v1)
(allow foo …)
(typeattribute sysfs_v1)
(allow sysfs_v1 …)</pre>
<p>
In the v2 vendor policy (CIL):
</p>


<pre class="prettyprint" translate="no" dir="ltr">(typeattribute sysfs_v2)
(allow sysfs_v2 …)</pre>

<h5 id="new-class-permissions">New class/permissions</h5>
<p>
This scenario occurs when a platform upgrade introduces new policy components
that do not exist in previous versions. For example, when Android added the
<code translate="no" dir="ltr">servicemanager</code> object manager that created the add, find, and list
permissions, vendor daemons wanting to register with the
<code translate="no" dir="ltr">servicemanager</code> needed permissions that were not
available. In Android 8.0, only the platform policy may add new classes and
permissions.
</p>
<p>
To allow all domains that could have been created or extended by vendor policy
to use the new class without obstruction, the platform policy needs to include a
rule similar to:
</p>


<pre
class="prettyprint" translate="no" dir="ltr">allow {domain -coredomain} *:new_class perm;</pre>
<p>
This may even require policy allowing access for all interface (public policy)
types, to be sure vendor image gains access. If this results in unacceptable
security policy (as it may have with the servicemanager changes), a vendor
upgrade could potentially be forced.
</p>
<h5 id="removed-class-permissions">Removed class/permissions</h5>
<p>
This scenario occurs when an object manager is removed (such as the
<code translate="no" dir="ltr">ZygoteConnection</code> object manager) and should not cause issues. The
object manager class and permissions could remain defined in policy until the
vendor version no longer uses it. This is done by adding the definitions
to the corresponding mapping file.
</p>

<h4 id="vendor-customization">Vendor customization for
new/relabeled types</h4>
<p>
New vendor types are at the core of vendor policy development as they are needed
to describe new processes, binaries, devices, subsystems, and stored data. As
such, it is imperative to allow the creation of vendor-defined types.
</p>
<p>
As vendor policy is always the oldest on the device, there is no need to
automatically convert all vendor types to attributes in policy. The platform
does not rely on anything labeled in vendor policy because the platform has no
knowledge of it; however, the platform will provide the attributes and public
types it uses to interact with objects labeled with these types (such as
<code translate="no" dir="ltr">domain</code>, <code translate="no" dir="ltr">sysfs_type</code>, etc.). For the platform to
continue to interact correctly with these objects, the attributes and types
must be appropriately applied and specific rules may need to be added to the
customizable domains (such as <code translate="no" dir="ltr">init</code>).
</p>

<h2 id="attributes-p">Attribute changes for Android 9</h2>
<p>
Devices upgrading to Android 9 can use the following attributes, but devices
launching with Android 9 must not.
</p>

<h3 id="violator-attributes">Violator attributes</h3>
<p>
Android 9 includes these domain-related attributes:
</p>

<ul>
  <li><strong><code translate="no" dir="ltr">data_between_core_and_vendor_violators</code></strong>.
    Attribute for all domains that violate the requirement of not sharing files by
    path between <code translate="no" dir="ltr">vendor</code> and <code translate="no" dir="ltr">coredomains</code>. Platform and
    vendor processes shouldn't use on-disk files to communicate (unstable ABI).
    Recommendation:
  <ul>
    <li>Vendor code should use <code translate="no" dir="ltr">/data/vendor</code>.</li>
    <li>System should not use <code translate="no" dir="ltr">/data/vendor</code>.</li>
  </ul>
  </li>
  <li><strong><code translate="no" dir="ltr">system_executes_vendor_violators</code></strong>. Attribute
    for all system domains (except <code translate="no" dir="ltr">init</code> and <code translate="no" dir="ltr">shell domains</code>)
    that violate the requirement of not executing vendor binaries. Execution of
    vendor binaries has unstable API. Platform shouldn't execute vendor binaries
    directly. Recommendation:
  <ul>
    <li>Such platform dependencies on vendor binaries must be behind HIDL HALs.
      <p><strong><em>OR</em></strong></p></li>
      <li><code translate="no" dir="ltr">coredomains</code> that need access to vendor binaries should be
        moved to the vendor partition and thus, stop being <code translate="no" dir="ltr">coredomain</code>.</li>
  </ul>
  </li>
</ul>

<h3 id="untrusted-attributes">Untrusted attributes</h3>
<p>
Untrusted apps that host arbitrary code shouldn't have access to HwBinder
services, except those considered sufficiently safe for access from such apps
(see safe services below). The two main reasons for this are:
</p>

<ol>
  <li>HwBinder servers do not perform client authentication because HIDL currently
    does not expose caller UID information. Even if HIDL did expose such data, many
    HwBinder services either operate at a level below that of apps (such as, HALs) or
    must not rely on app identity for authorization. Thus, to be safe, the default
    assumption is that every HwBinder service treats all its clients as equally
    authorized to perform operations offered by the service.</li>
  <li>HAL servers (a subset of HwBinder services) contain code with higher
    incidence rate of security issues than <code translate="no" dir="ltr">system/core</code> components and
    have access to the lower layers of the stack (all the way down to hardware) thus
    increasing opportunities for bypassing the Android security model.</li>
</ol>

<h4 id="safe-services">Safe services</h4>
<p>
Safe services include:
</p>

<ul>
<li><code translate="no" dir="ltr">same_process_hwservice</code>. These services (by definition) run in
the process of the client and thus have the same access as the client domain in
which the process runs.</li>
<li><code translate="no" dir="ltr">coredomain_hwservice</code>. These services do not pose risks
  associated with reason #2.</li>
<li><code translate="no" dir="ltr">hal_configstore_ISurfaceFlingerConfigs</code>. This service is
  specifically designed for use by any domain.</li>
<li><code translate="no" dir="ltr">hal_graphics_allocator_hwservice</code>. These operations are also
offered by <code translate="no" dir="ltr">surfaceflinger</code> Binder service, which apps are permitted
to access.</li>
<li><code translate="no" dir="ltr">hal_omx_hwservice</code>. This is a HwBinder version of the
  <code translate="no" dir="ltr">mediacodec</code> Binder service, which apps are permitted to access.</li>
<li><code translate="no" dir="ltr">hal_codec2_hwservice</code>. This is a newer version of
<code translate="no" dir="ltr">hal_omx_hwservice</code>.</li>
</ul>

<h4 id="useable-attributes">Useable attributes</h4>
<p>
All <code translate="no" dir="ltr">hwservices</code> not considered safe have the attribute
<code translate="no" dir="ltr">untrusted_app_visible_hwservice</code>. The corresponding HAL servers have
the attribute <code translate="no" dir="ltr">untrusted_app_visible_halserver</code>. Devices launching
with Android P MUST NOT use either <code translate="no" dir="ltr">untrusted</code> attribute.
</p>
<p>
Recommendation:
</p>

<ul>
<li>Untrusted apps should instead talk to a system service that talks to the
vendor HIDL HAL. For example, apps can talk to <code translate="no" dir="ltr"><a
href="https://android.googlesource.com/platform/system/sepolicy/+/master/public/app.te#209"
class="external">binderservicedomain</a></code>, then <code translate="no" dir="ltr">mediaserver</code>
(which is a <code translate="no" dir="ltr">binderservicedomain</code>) in turn talks to the <code translate="no" dir="ltr"><a
href="https://android.googlesource.com/platform/system/sepolicy/+/master/private/mediaserver.te#6"
class="external">hal_graphics_allocator</a></code>.

<p><strong><em>OR</em></strong></p></li>
<li>Apps that need direct access to <code translate="no" dir="ltr">vendor</code> HALs should have their
own vendor-defined sepolicy domain.</li>
</ul>

<h3 id="file-attribute-tests">File attribute tests</h3>
<p>
Android 9 includes <a
href="https://android.googlesource.com/platform/system/sepolicy/+/master/tests/sepolicy_tests.py"
class="external">build time tests</a> that ensure all files in specific
locations have the appropriate attributes (such as, all files in
<code translate="no" dir="ltr">sysfs</code> have the required <code translate="no" dir="ltr">sysfs_type</code> attribute).
</p>


<h2 id="platform-public-policy">Platform-public policy</h2>
<p>
The platform-public policy is the core of conforming to the Android 8.0
architecture model without simply maintaining the union of platform policies
from v1 and v2. Vendors are exposed to a subset of platform policy that
contains useable types and attributes and rules on those types and attributes
which then becomes part of vendor policy (i.e.
<code translate="no" dir="ltr">vendor_sepolicy.cil</code>).
</p>
<p>
Types and rules are automatically translated in the vendor-generated policy
into <code translate="no" dir="ltr">attribute_v<em>N</em></code> such that all platform-provided types
are versioned attributes (however attributes are not versioned). The platform is
responsible for mapping the concrete types it provides into the appropriate
attributes to ensure that vendor policy continues to function and that the rules
provided for a particular version are included. The combination of
platform-public policy and vendor policy satisfies the Android 8.0 architecture
model goal of allowing independent platform and vendor builds.
</p>

<h3 id="mapping-to-attribute-chains">Mapping to attribute chains</h3>
<p>
When using attributes to map to policy versions, a type maps to an attribute or
multiple attributes, ensuring objects labeled with the type are accessible via
attributes corresponding to their previous types.
</p>
<p>
Maintaining a goal to hide version information from the policy writer means
automatically generating the versioned attributes and assigning them to the
appropriate types. In the common case of static types, this is straightforward:
<code translate="no" dir="ltr">type_foo</code> maps to <code translate="no" dir="ltr">type_foo_v1</code>.
</p>
<p>
For an object label change such as <code translate="no" dir="ltr">sysfs</code> → <code translate="no" dir="ltr">sysfs_A</code> or
<code translate="no" dir="ltr">mediaserver</code> → <code translate="no" dir="ltr">audioserver</code>, creating this mapping is
non-trivial (and is described in the examples above). Platform policy maintainers
must determine how to create the mapping at transition points for objects, which
requires understanding the relationship between objects and their assigned
labels and determining when this occurs. For backwards compatibility, this
complexity needs to be managed on the platform side, which is the only partition
that may uprev.
</p>
<h3 id="version-uprevs">Version uprevs</h3>
<p>
For simplicity, the Android platform releases an sepolicy version when a new
release branch is cut. As described above, the version number is contained in
<code translate="no" dir="ltr">PLATFORM_SEPOLICY_VERSION</code> and is of the form <code translate="no" dir="ltr">MM.nn</code>,
where <code translate="no" dir="ltr">MM</code> corresponds to the SDK value and <code translate="no" dir="ltr">nn</code> is a
private value maintained in<code translate="no" dir="ltr"> /platform/system/sepolicy.</code>  For
example, <code translate="no" dir="ltr">19.0</code> for Kitkat, <code translate="no" dir="ltr">21.0</code> for Lollipop,
<code translate="no" dir="ltr">22.0</code> for Lollipop-MR1 <code translate="no" dir="ltr">23.0</code> for Marshmallow,
<code translate="no" dir="ltr">24.0</code> for Nougat, <code translate="no" dir="ltr">25.0</code> for Nougat-MR1,
<code translate="no" dir="ltr">26.0</code> for Oreo, <code translate="no" dir="ltr">27.0</code> for Oreo-MR1, and
<code translate="no" dir="ltr">28.0</code> for Android P. Uprevs aren't always whole numbers. For
example, if an MR bump to a versions necessitates an incompatible change in
<code translate="no" dir="ltr">system/sepolicy/public</code> but not an API bump, then that sepolicy
version could be: <code translate="no" dir="ltr">vN.1</code>. The version present in a development
branch is a never-to-be-used-in-shipping-devices <code translate="no" dir="ltr">10000.0</code>.
</p>
<p>
Android may deprecate oldest version when upreving. For input on when to
deprecate a version, Android may collect the number of devices with vendor
policies running that Android version and still receiving major platform
updates. If the number is less than a certain threshold, that version is
deprecated.
</p>

<h3 id="performance-impact-of-multiple-attributes">Performance impact of
multiple attributes</h3>
<p>
As described in <a
href="https://github.com/SELinuxProject/cil/issues/9" class="external">https://github.com/SELinuxProject/cil/issues/9</a>,
a large number of attributes assigned to a type result in performance issues in
the event of a policy cache miss.
</p>
<p>
This was confirmed to be an issue in Android, so <a
href="http://marc.info/?l=selinux&amp;m=149202161421482&amp;w=2" class="external">changes
were made</a> to Android 8.0 to remove attributes added to the policy by the
policy compiler, as well as to remove unused attributes. These changes resolved
performance regressions.
</p>


<h2 id="selinux-contexts-labeling">SELinux contexts labeling</h2>
<p>To support the distinction between platform and vendor sepolicy,
the system builds SELinux context files differently to keep them separate.
</p>

<h3 id="file-contexts">File contexts</h3>
<p>
Android 8.0 introduced the following changes for <code translate="no" dir="ltr">file_contexts</code>:
</p>

<ul>
  <li>To avoid additional compilation overhead on device during boot,
  <code translate="no" dir="ltr">file_contexts</code> cease to exist in the binary form. Instead, they
  are readable, regular expression text file such as <code translate="no" dir="ltr">{property,
  service}_contexts</code> (as they were pre-7.0).</li>
  <li>The <code translate="no" dir="ltr">file_contexts</code> are split between two files:
    <ul>
      <li><code translate="no" dir="ltr">plat_file_contexts</code>
        <ul>
          <li>Android platform <code translate="no" dir="ltr">file_context</code> that has no
            device-specific labels, except for labeling parts of
            <code translate="no" dir="ltr">/vendor</code> partition that must be labeled precisely to
            ensure proper functioning of the sepolicy files.</li>
          <li>Must reside in <code translate="no" dir="ltr">system</code> partition at
            <code translate="no" dir="ltr">/system/etc/selinux/plat_file_contexts</code> on device and
            be loaded by <code translate="no" dir="ltr">init</code> at the start along with the
            vendor <code translate="no" dir="ltr">file_context</code>.</li>
        </ul>
      </li>
      <li><code translate="no" dir="ltr">vendor_file_contexts</code>
        <ul>
          <li>Device-specific <code translate="no" dir="ltr">file_context</code> built by combining
            <code translate="no" dir="ltr">file_contexts</code> found in the directories pointed to by
            <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in the device's
            <code translate="no" dir="ltr">Boardconfig.mk</code> files.</li>
          <li>Must be installed at
            <code translate="no" dir="ltr">/vendor/etc/selinux/vendor_file_contexts</code> in
            <code translate="no" dir="ltr">vendor</code> partition and be loaded by <code translate="no" dir="ltr">init</code> at
            the start along with the platform <code translate="no" dir="ltr">file_context</code>.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="property-contexts">Property contexts</h3>
<p>
In Android 8.0, the <code translate="no" dir="ltr">property_contexts</code> is split between two files:
</p>

<ul>
  <li><code translate="no" dir="ltr">plat_property_contexts</code>
    <ul>
      <li>Android platform <code translate="no" dir="ltr">property_context</code> that has no
        device-specific labels.</li>
      <li>Must reside in <code translate="no" dir="ltr">system</code> partition at
        <code translate="no" dir="ltr">/system/etc/selinux/plat_property_contexts</code> and be loaded
        by <code translate="no" dir="ltr">init</code> at the start along with the vendor
        <code translate="no" dir="ltr">property_contexts</code>.</li>
    </ul>
  </li>
  <li><code translate="no" dir="ltr">vendor_property_contexts</code>
    <ul>
      <li>Device-specific <code translate="no" dir="ltr">property_context</code> built by combining
        <code translate="no" dir="ltr">property_contexts</code> found in the directories pointed to by
        <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in device's
        <code translate="no" dir="ltr">Boardconfig.mk</code> files.</li>
      <li>Must reside in <code translate="no" dir="ltr">vendor</code> partition at
        <code translate="no" dir="ltr">/vendor/etc/selinux/vendor_property_contexts</code> and be
        loaded by <code translate="no" dir="ltr">init</code> at the start along with the platform
        <code translate="no" dir="ltr">property_context</code></li>
    </ul>
  </li>
</ul>

<h3 id="service-contexts">Service contexts</h3>
<p>
In Android 8.0, the <code translate="no" dir="ltr">service_contexts</code> is split between the following
files:
</p>

<ul>
  <li><code translate="no" dir="ltr">plat_service_contexts</code>
    <ul>
      <li>Android platform-specific <code translate="no" dir="ltr">service_context</code> for the
        <code translate="no" dir="ltr">servicemanager</code>. The <code translate="no" dir="ltr">service_context</code> has no
        device-specific labels.</li>
      <li>Must reside in <code translate="no" dir="ltr">system</code> partition at
        <code translate="no" dir="ltr">/system/etc/selinux/plat_service_contexts</code> and be loaded by
        <code translate="no" dir="ltr">servicemanager</code> at the start along with the vendor
        <code translate="no" dir="ltr">service_contexts</code>.</li>
    </ul>
  </li>
  <li><code translate="no" dir="ltr">vendor_service_contexts</code>
    <ul>
      <li>Device-specific <code translate="no" dir="ltr">service_context</code> built by combining
        <code translate="no" dir="ltr">service_contexts</code> found in the directories pointed to by
        <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in the device's
        <code translate="no" dir="ltr">Boardconfig.mk</code> files.</li>
      <li>Must reside in <code translate="no" dir="ltr">vendor</code> partition at
        <code translate="no" dir="ltr">/vendor/etc/selinux/vendor_service_contexts</code> and be loaded
        by <code translate="no" dir="ltr">servicemanager</code> at the start along with the platform
        <code translate="no" dir="ltr">service_contexts</code>.</li>
      <li>Although <code translate="no" dir="ltr">servicemanager</code> looks for this file at boot time,
        for a fully compliant <code translate="no" dir="ltr">TREBLE</code> device, the
        <code translate="no" dir="ltr">vendor_service_contexts</code> MUST NOT exist. This is because
        all interaction between <code translate="no" dir="ltr">vendor</code> and <code translate="no" dir="ltr">system</code>
        processes MUST go through
        <code translate="no" dir="ltr">hwservicemanager</code>/<code translate="no" dir="ltr">hwbinder</code>.</li>
    </ul>
  </li>
  <li><code translate="no" dir="ltr">plat_hwservice_contexts</code>
    <ul>
      <li>Android platform <code translate="no" dir="ltr">hwservice_context</code> for
        <code translate="no" dir="ltr">hwservicemanager</code> that has no device-specific labels.</li>
      <li>Must reside in <code translate="no" dir="ltr">system</code> partition at
        <code translate="no" dir="ltr">/system/etc/selinux/plat_hwservice_contexts</code> and be loaded by
        <code translate="no" dir="ltr">hwservicemanager</code> at the start along with the
        <code translate="no" dir="ltr">vendor_hwservice_contexts</code>.</li>
    </ul>
  </li>
  <li><code translate="no" dir="ltr">vendor_hwservice_contexts</code>
    <ul>
      <li>Device-specific <code translate="no" dir="ltr">hwservice_context</code> built by combining
        <code translate="no" dir="ltr">hwservice_contexts</code> found in the directories pointed to by
        <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in the device's
        <code translate="no" dir="ltr">Boardconfig.mk</code> files.</li>
      <li>Must reside in <code translate="no" dir="ltr">vendor</code> partition at
        <code translate="no" dir="ltr">/vendor/etc/selinux/vendor_hwservice_contexts</code> and be
        loaded by <code translate="no" dir="ltr">hwservicemanager</code> at the start along with the
        <code translate="no" dir="ltr">plat_service_contexts</code>.</li>
    </ul>
  </li>
  <li><code translate="no" dir="ltr">vndservice_contexts</code>
    <ul>
      <li>Device-specific <code translate="no" dir="ltr">service_context</code> for the
        <code translate="no" dir="ltr">vndservicemanager</code> built by combining
        <code translate="no" dir="ltr">vndservice_contexts</code> found in the directories pointed to by
        <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in the device's
        <code translate="no" dir="ltr">Boardconfig.mk</code>.</li>
      <li>This file must reside in <code translate="no" dir="ltr">vendor</code> partition at
        <code translate="no" dir="ltr">/vendor/etc/selinux/vndservice_contexts</code> and be loaded by
        <code translate="no" dir="ltr">vndservicemanager</code> at the start.</li>
    </ul>
  </li>
</ul>

<h3 id="seapp-contexts">Seapp contexts</h3>
<p>
In Android 8.0, the <code translate="no" dir="ltr">seapp_contexts</code> is split between two files:
</p>

<ul>
  <li><code translate="no" dir="ltr">plat_seapp_contexts</code>
    <ul>
      <li>Android platform <code translate="no" dir="ltr">seapp_context</code> that has no device-specific
        changes.</li>
      <li>Must reside in <code translate="no" dir="ltr">system</code> partition at
        <code translate="no" dir="ltr">/system/etc/selinux/plat_seapp_contexts.</code></li>
    </ul>
  </li>
  <li><code translate="no" dir="ltr">vendor_seapp_contexts</code>
    <ul>
      <li>Device-specific extension to platform <code translate="no" dir="ltr">seapp_context</code> built
        by combining <code translate="no" dir="ltr">seapp_contexts</code> found in the directories
        pointed to by <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in the device's
        <code translate="no" dir="ltr">Boardconfig.mk</code> files.</li>
      <li>Must reside in <code translate="no" dir="ltr">vendor</code> partition at
        <code translate="no" dir="ltr">/vendor/etc/selinux/vendor_seapp_contexts</code>.</li>
    </ul>
  </li>
</ul>

<h3 id="mac-permissions">MAC permissions</h3>
<p>
In Android 8.0, the <code translate="no" dir="ltr">mac_permissions.xml</code> is split between two files:
</p>

<ul>
  <li>Platform <code translate="no" dir="ltr">mac_permissions.xml</code>
    <ul>
      <li>Android platform <code translate="no" dir="ltr">mac_permissions.xml</code> that has no
        device-specific changes.</li>
      <li>Must reside in <code translate="no" dir="ltr">system</code> partition at
        <code translate="no" dir="ltr">/system/etc/selinux/.</code></li>
    </ul>
  </li>
  <li>Non-Platform <code translate="no" dir="ltr">mac_permissions.xml</code>
    <ul>
      <li>Device-specific extension to platform
        <code translate="no" dir="ltr">mac_permissions.xml</code> built from
        <code translate="no" dir="ltr">mac_permissions.xml</code> found in the directories pointed to by
        <code translate="no" dir="ltr">BOARD_SEPOLICY_DIRS</code> in the device's
        <code translate="no" dir="ltr">Boardconfig.mk</code> files.</li>
      <li>Must reside in <code translate="no" dir="ltr">vendor</code> partition at
        <code translate="no" dir="ltr">/vendor/etc/selinux/.</code></li>
    </ul>
  </li>
</ul>


  
          </div>

    
                   <devsite-page-rating position="footer" selected-rating="0" hover-rating-star="0">
         </devsite-page-rating>
                   
          </article>
</article>

<devsite-content-footer class="nocontent">
  <p>Content and code samples on this page are subject to the licenses described in the <a href="../../license.html">Content License</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
</devsite-content-footer>


                      </devsite-content>
        </div>
        <devsite-footer-promos class="devsite-footer">
                      
                  </devsite-footer-promos>
        <devsite-footer-linkboxes class="devsite-footer">
                      <nav class="devsite-footer-linkboxes nocontent">
  <ul class="devsite-footer-linkboxes-list">
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Build</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.googlesource.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android repository
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/requirements.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Requirements
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="../../setup/build/downloading.html"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Downloading
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/blobs-preview/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Preview binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/images/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Factory images
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://developers.google.com/android/drivers/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Driver binaries
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://android.github.io/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            GitHub
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Connect</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/Android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            @Android on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://twitter.com/AndroidDev/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            @AndroidDev on Twitter
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://blog.google/products/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Android Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://security.googleblog.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            Google Security Blog
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-platform/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Platform on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-building/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Building on Google Groups
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://groups.google.com/forum/?fromgroups#!forum/android-porting/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Porting on Google Groups
          </a>
        </li>
              </ul>
    </li>
        <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading">Get help</h3>      <ul class="devsite-footer-linkbox-list">
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/android/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 1)"           >
            Android Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/pixelphone/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 2)"           >
            Pixel Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://support.google.com/nexus/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 3)"           >
            Nexus Help Center
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 4)"           >
            www.android.com
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://www.android.com/gms/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 5)"           >
            Google Mobile Services
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://stackoverflow.com/questions/tagged/android-source/"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 6)"           >
            Stack Overflow
          </a>
        </li>
                <li class="devsite-footer-linkbox-item">
          <a href="http://issuetracker.google.com/issues?q=status:open%20componentid:190923"
             class="devsite-footer-linkbox-link
                    gc-analytics-event"
             data-category="Site-Wide Custom Events"
                        data-label="Footer Link (index 7)"           >
            Issue Tracker
          </a>
        </li>
              </ul>
    </li>
      </ul>
</nav>
                  </devsite-footer-linkboxes>
        <devsite-footer-utility class="devsite-footer">
                      
<div class="devsite-footer-utility">
  
  <nav class="devsite-nav">
        <ul class="devsite-footer-utility-list">
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../source/index.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer About Android link">
          About Android
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../setup/community.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Community link">
          Community
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../legal.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer Legal link">
          Legal
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="../../license.html"
           data-category="Site-Wide Custom Events"
           data-label="Footer License link">
          License
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://policies.google.cn/privacy"
           data-category="Site-Wide Custom Events"
           data-label="Footer Privacy link">
          Privacy
        </a>
              </li>
            <li class="devsite-footer-utility-item
                 ">
                        <a class="devsite-footer-utility-link
                  gc-analytics-event"
           href="http://issuetracker.google.com/issues/new?component=191476"
           data-category="Site-Wide Custom Events"
           data-label="Footer Site feedback link">
          Site feedback
        </a>
              </li>
          </ul>
    
    <devsite-language-selector>
  <devsite-select class="devsite-language-selector-menu">
    <select class="devsite-language-selector-select"
            name="language"
            track-name="click"
            track-type="languageSelector">
                <option>Language</option>
              <option value="en"
              track-metadata-original-language="en"
              track-metadata-selected-language="en"
              track-name="changed"
              track-type="languageSelector"
            >
        English
      </option>
          <option value="zh_cn"
              track-metadata-original-language="en"
              track-metadata-selected-language="zh_cn"
              track-name="changed"
              track-type="languageSelector"
            >
        中文 – 简体
      </option>
        </select>
  </devsite-select>
</devsite-language-selector>

  </nav>
</div>
                  </devsite-footer-utility>
      </div></div>
    <devsite-sitemask></devsite-sitemask>
    <devsite-snackbar                   ></devsite-snackbar>    <devsite-tooltip blocked-link></devsite-tooltip>
    <devsite-analytics>
              <script type="application/json" analytics>[{"metrics": {"ratings_value": "metric1", "ratings_count": "metric2"}, "dimensions": {}, "gaid": "UA-45455297-4"}]</script>
<script type="application/json" gtm>[]</script>
          </devsite-analytics>
        <script>
    (function(d,e,v,s,i,t,E){d['GoogleDevelopersObject']=i;
    t=e.createElement(v);t.async=1;t.src=s;E=e.getElementsByTagName(v)[0];
    E.parentNode.insertBefore(t,E);})(window, document, 'script',
    'https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/js/app_loader.js', '[7,"en",null,"../../js/devsite_app.html","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource","https://androidsource-dot-google-developers.gonglchuangl.net/",null,null,["/_pwa/androidsource/manifest.json","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/images/video-placeholder.svg","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/favicon.png","https://www.gstatic.com/devrel-devsite/vbb62cc5a3e8f17e37bae4792b437f28f787df3f9cf9732cbfcc99b4f4ff41a54/androidsource/images/rebrand/lockup.svg","https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,500,700|Material+Icons"]]')
  </script>  </body>

<!-- Mirrored from source.android.google.cn/security/selinux/compatibility by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Sep 2019 15:01:26 GMT -->
</html>